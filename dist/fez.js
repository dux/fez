(()=>{function P(r,e={},t){if(typeof e=="string"&&([e,t]=[t,e],e||={}),e instanceof Node&&(t=e,e={}),Array.isArray(r)&&(t=r,r="div"),(typeof e!="object"||Array.isArray(e))&&(t=e,e={}),r.includes(".")){let l=r.split(".");r=l.shift()||"div";let a=l.join(" ");e.class?e.class+=` ${a}`:e.class=a}let s=document.createElement(r);for(let[l,a]of Object.entries(e))if(typeof a=="function")s[l]=a.bind(this);else{let f=String(a).replaceAll("$$.",this.fezHtmlRoot);s.setAttribute(l,f)}if(t)if(Array.isArray(t))for(let l of t)s.appendChild(l);else t instanceof Node?s.appendChild(t):s.innerHTML=String(t);return s}function me(r,e){if(r=r.replaceAll("#raw","@html").replaceAll("#html","@html"),r.startsWith("#if")||r.startsWith("if"))return e.push(!1),r=r.replace(/^#?if/,""),`\${ ${r} ? \``;if(r.startsWith("#unless")||r.startsWith("unless"))return e.push(!1),r=r.replace(/^#?unless/,""),`\${ !(${r}) ? \``;if(r.startsWith("#block")||r.startsWith("block")){let t=r.split("block ",2),s=r.split("block:",2);return t[1]?"${(this.fezBlocks."+t[1]+" = `":"${ this.fezBlocks."+s[1]+" }"}else{if(r=="/block")return"`) && ''}";if(r.startsWith("#for")||r.startsWith("for")){r=r.replace(/^#?for/,"");let t=r.split(" in ",2);return"${"+t[1]+".map(("+t[0]+")=>`"}else if(r.startsWith("#each")||r.startsWith("each")){r=r.replace(/^#?each/,"");let t=r.split(" as ",2);return"${"+t[0]+".map(("+t[1]+")=>`"}else{if(r==":else"||r=="else")return e[e.length-1]=!0,"` : `";if(r=="/if"||r=="/unless")return e.pop()?"`}":"` : ``}";if(r=="/for"||r=="/each")return'`).join("")}';{let t="@html ";return r.startsWith(t)?r=r.replace(t,""):r=`Fez.htmlEscape(${r})`,"${"+r+"}"}}}}function R(r,e={}){let t=[];r=r.replaceAll("[[","{{").replaceAll("]]","}}"),r=r.replace(/:(\w+)="([\w\.\[\]]+)"/,(a,f,p)=>`:${f}="{{ JSON.stringify(${p}) }}"`);let s=r.replace(/{{(.*?)}}/g,(a,f)=>(f=f.replaceAll("&#x60;","`"),f=f.replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),me(f,t)));s="`"+s.trim()+"`";let l=`
    const fez = this;

    // Use with statement to make all properties available as variables
    with (this) {
      return ${s}
    }
  `;try{let a=new Function(l);return p=>{try{return a.bind(p)()}catch(d){d.message=`FEZ template runtime error: ${d.message}

Template source: ${r}`,console.error(d)}}}catch(a){a.message=`FEZ template compile error: ${a.message}Template source:
${r.trim()}

Compile result (produced invalid JS):
new Function(${s})
`,console.error(a)}}var L=class{static __objects=[];static getProps(e,t){let s={};for(let l of e.attributes)s[l.name]=l.value;if(s["data-props"]){let l=s["data-props"];l[0]!="{"&&(l=decodeURIComponent(l));try{s=JSON.parse(l)}catch(a){console.error(`Fez: Invalid JSON in data-props for ${e.tagName}: ${a.message}`)}}if(s["data-json-template"]){let l=t.previousSibling?.textContent;if(l)try{s=JSON.parse(l),t.previousSibling.remove()}catch(a){console.error(`Fez: Invalid JSON in template for ${e.tagName}: ${a.message}`)}}for(let[l,a]of Object.entries(s))if([":"].includes(l[0])){delete s[l];try{let f=new Function(`return (${a})`).bind(t)();s[l.replace(/[\:_]/,"")]=f}catch(f){console.error(`Fez: Error evaluating attribute ${l}="${a}" for ${e.tagName}: ${f.message}`)}}return s}static formData(e){let t=e.closest("form")||e.querySelector("form");if(!t)return Fez.log("No form found for formData()"),{};let s=new FormData(t),l={};return s.forEach((a,f)=>{l[f]=a}),l}static fastBind(){return!1}static nodeName="div";constructor(){}n=P;get fezHtmlRoot(){return this.props.id?`Fez.find("#${this.props.id}").`:`Fez.find(this, "${this.fezName}").`}get isConnected(){return this.root?.isConnected?!0:(this._setIntervalCache||={},Object.keys(this._setIntervalCache).forEach(e=>{clearInterval(this._setIntervalCache[e])}),this.onDestroy(),this.onDestroy=()=>{},this.root&&(this.root.fez=void 0),this.root=void 0,!1)}prop(e){let t=this.oldRoot[e]||this.props[e];return typeof t=="function"&&(t=t.bind(this.root)),t}copy(){for(let e of Array.from(arguments)){let t=this.props[e];if(t!==void 0){if(e=="class"){let s=this.root.getAttribute(e,t);s&&(t=[s,t].join(" "))}(e=="style"||!this.root[e])&&(typeof t=="string"?this.root.setAttribute(e,t):this.root[e]=t)}}}onResize(e,t){let s,l=0;e();let a=()=>{if(!this.isConnected){window.removeEventListener("resize",f);return}e.call(this)},f=()=>{if(!this.isConnected){window.removeEventListener("resize",f);return}if(t){let p=Date.now();p-l>=t&&(a(),l=p)}else clearTimeout(s),s=setTimeout(a,200)};window.addEventListener("resize",f)}slot(e,t){t||=document.createElement("template");let s=t.nodeName=="SLOT";for(;e.firstChild;)s?t.parentNode.insertBefore(e.lastChild,t.nextSibling):t.appendChild(e.firstChild);return s?t.parentNode.removeChild(t):e.innerHTML="",t}style(e,t){this.root.style.setProperty(e,t)}connect(){}onMount(){}beforeRender(){}afterRender(){}onDestroy(){}publish=Fez.publish;fezBlocks={};parseHtml(e){let t=this.fezHtmlRoot.replaceAll('"',"&quot;");return e=e.replace(/([^\w\.])fez\./g,`$1${t}`).replace(/>\s+</g,"><"),e.trim()}nextTick(e,t){t?(this._nextTicks||={},this._nextTicks[t]||=window.requestAnimationFrame(()=>{e.bind(this)(),this._nextTicks[t]=null},t)):window.requestAnimationFrame(e.bind(this))}render(e){if(e||=this?.class?.fezHtmlFunc,!e)return;this.beforeRender();let t=document.createElement(this.class.nodeName||"div"),s;Array.isArray(e)?e[0]instanceof Node?e.forEach(f=>t.appendChild(f)):s=e.join(""):typeof e=="string"?s=R(e)(this):typeof e=="function"&&(s=e(this)),s&&(s=s.replace(/\s\w+="undefined"/g,""),t.innerHTML=this.parseHtml(s));let l=t.querySelector("slot");l&&(this.slot(this.root,l.parentNode),l.parentNode.removeChild(l));let a=this.find(".fez-slot");if(a){let f=t.querySelector(".fez-slot");f&&f.parentNode.replaceChild(a,f)}Fez.morphdom(this.root,t),this.renderFezPostProcess(),this.afterRender()}renderFezPostProcess(){let e=(t,s)=>{this.root.querySelectorAll(`*[${t}]`).forEach(l=>{let a=l.getAttribute(t);l.removeAttribute(t),a&&s.bind(this)(a,l)})};e("fez-this",(t,s)=>{new Function("n",`this.${t} = n`).bind(this)(s)}),e("fez-use",(t,s)=>{let l=this[t];typeof l=="function"?l(s):console.error(`Fez error: "${t}" is not a function in ${this.fezName}`)}),e("fez-class",t=>{let s=t.split(/\s+/),l=s.pop();s.forEach(a=>n.classList.add(a)),l&&setTimeout(()=>{n.classList.add(l)},300)}),e("fez-bind",(t,s)=>{if(["INPUT","SELECT","TEXTAREA"].includes(s.nodeName)){let l=new Function(`return this.${t}`).bind(this)(),a=s.type.toLowerCase()=="checkbox",f=["SELECT"].includes(s.nodeName)||a?"onchange":"onkeyup";s.setAttribute(f,`${this.fezHtmlRoot}${t} = this.${a?"checked":"value"}`),this.val(s,l)}else console.error(`Cant fez-bind="${t}" to ${s.nodeName} (needs INPUT, SELECT or TEXTAREA. Want to use fez-this?).`)})}refresh(e){if(alert("NEEDS FIX and remove htmlTemplate"),e){let t=document.createElement("div");t.innerHTML=this.class.htmlTemplate;let s=t.querySelector(e).innerHTML;this.render(e,s)}else this.render()}setInterval(e,t,s){return typeof e=="number"&&([t,e]=[e,t]),s||=Fez.fnv1(String(e)),this._setIntervalCache||={},clearInterval(this._setIntervalCache[s]),this._setIntervalCache[s]=setInterval(()=>{this.isConnected&&e()},t),this._setIntervalCache[s]}find(e){return typeof e=="string"?this.root.querySelector(e):e}val(e,t){let s=this.find(e);if(s)if(["INPUT","TEXTAREA","SELECT"].includes(s.nodeName))if(typeof t<"u")s.type=="checkbox"?s.checked=!!t:s.value=t;else return s.value;else if(typeof t<"u")s.innerHTML=t;else return s.innerHTML}formData(e){return this.class.formData(e||this.root)}attr(e,t){return typeof t>"u"?this.root.getAttribute(e):(this.root.setAttribute(e,t),t)}childNodes(e){let t=document.createElement("div");t.style.display="none",document.body.appendChild(t);let s=Array.from(this.root.children);if(e===!1)return s;s.forEach(a=>t.appendChild(a));let l=Array.from(t.children);return e&&(l=l.map(e)),document.body.removeChild(t),l}subscribe(e,t){Fez._subs||={},Fez._subs[e]||=[],Fez._subs[e]=Fez._subs[e].filter(s=>s[0].isConnected),Fez._subs[e].push([this,t])}nodeId(){return this._id||(this._id=Fez.id(),this.root.id=this._id),this._id}fezRegister(){this.css&&(this.css=Fez.globalCss(this.css,{name:this.fezName,wrap:!0})),this.class.css&&(this.class.css=Fez.globalCss(this.class.css,{name:this.fezName})),this.state||=this.reactiveStore(),this.fezRegisterBindMethods()}fezRegisterBindMethods(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).filter(t=>t!=="constructor"&&typeof this[t]=="function").forEach(t=>this[t]=this[t].bind(this))}fezHide(){let e=this.root,t=this.root.parentNode,s=document.createDocumentFragment();for(;e.firstChild;)s.appendChild(e.firstChild);return e.parentNode.replaceChild(s,e),this.root=t,Array.from(this.root.children)}reactiveStore(e,t){e||={},t||=(l,a,f)=>{this.nextTick(this.render,"render")},t.bind(this);function s(l,a){return typeof l!="object"||l===null?l:new Proxy(l,{set(f,p,d,b){if(Reflect.get(f,p,b)!==d){typeof d=="object"&&d!==null&&(d=s(d,a));let E=Reflect.set(f,p,d,b);return a(f,p,d),E}return!0},get(f,p,d){let b=Reflect.get(f,p,d);return typeof b=="object"&&b!==null?s(b,a):b}})}return s(e,t)}};var be={data:""},G=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||be,ye=r=>{let e=G(r),t=e.data;return e.data="",t},ge=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ve=/\/\*[^]*?\*\/|  +/g,Z=/\n+/g,w=(r,e)=>{let t="",s="",l="";for(let a in r){let f=r[a];a[0]=="@"?a[1]=="i"?t=a+" "+f+";":s+=a[1]=="f"?w(f,a):a+"{"+w(f,a[1]=="k"?"":e)+"}":typeof f=="object"?s+=w(f,e?e.replace(/([^,])+/g,p=>a.replace(/(^:.*)|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,p):p?p+" "+d:d)):a):f!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),l+=w.p?w.p(a,f):a+":"+f+";")}return t+(e&&l?e+"{"+l+"}":l)+s},C={},K=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+K(r[t]);return e}return r},ze=(r,e,t,s,l)=>{let a=K(r),f=C[a]||(C[a]=(d=>{let b=0,v=11;for(;b<d.length;)v=101*v+d.charCodeAt(b++)>>>0;return"go"+v})(a));if(!C[f]){let d=a!==r?r:(b=>{let v,E,F=[{}];for(;v=ge.exec(b.replace(ve,""));)v[4]?F.shift():v[3]?(E=v[3].replace(Z," ").trim(),F.unshift(F[0][E]=F[0][E]||{})):F[0][v[1]]=v[2].replace(Z," ").trim();return F[0]})(r);C[f]=w(l?{["@keyframes "+f]:d}:d,t?"":"."+f)}let p=t&&C.g?C.g:null;return t&&(C.g=C[f]),((d,b,v,E)=>{E?b.data=b.data.replace(E,d):b.data.indexOf(d)===-1&&(b.data=v?d+b.data:b.data+d)})(C[f],e,s,p),f},Ae=(r,e,t)=>r.reduce((s,l,a)=>{let f=e[a];if(f&&f.call){let p=f(t),d=p&&p.props&&p.props.className||/^go/.test(p)&&p;f=d?"."+d:p&&typeof p=="object"?p.props?"":w(p,""):p===!1?"":p}return s+l+(f??"")},"");function O(r){let e=this||{},t=r.call?r(e.p):r;return ze(t.unshift?t.raw?Ae(t,[].slice.call(arguments,1),e.p):t.reduce((s,l)=>Object.assign(s,l&&l.call?l(e.p):l),{}):t,G(e.target),e.g,e.o,e.k)}var Y,B,D,Se=O.bind({g:1}),Ee=O.bind({k:1});function $e(r,e,t,s){w.p=e,Y=r,B=t,D=s}function Fe(r,e){let t=this||{};return function(){let s=arguments;function l(a,f){let p=Object.assign({},a),d=p.className||l.className;t.p=Object.assign({theme:B&&B()},p),t.o=/ *go\d+/.test(d),p.className=O.apply(t,s)+(d?" "+d:""),e&&(p.ref=f);let b=r;return r[0]&&(b=p.as||r,delete p.as),D&&b[0]&&D(p),Y(b,p)}return e?e(l):l}}var Q={css:O,extractCss:ye,glob:Se,keyframes:Ee,setup:$e,styled:Fe};var x=function(){"use strict";let r=new Set,e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:S,afterNodeAdded:S,beforeNodeMorphed:S,afterNodeMorphed:S,beforeNodeRemoved:S,afterNodeRemoved:S,beforeAttributeUpdated:S},head:{style:"merge",shouldPreserve:function(i){return i.getAttribute("im-preserve")==="true"},shouldReAppend:function(i){return i.getAttribute("im-re-append")==="true"},shouldRemove:S,afterHeadMorphed:S}};function t(i,o,c={}){i instanceof Document&&(i=i.documentElement),typeof o=="string"&&(o=oe(o));let u=le(o),h=ne(i,u,c);return s(i,u,h)}function s(i,o,c){if(c.head.block){let u=i.querySelector("head"),h=o.querySelector("head");if(u&&h){let m=E(h,u,c);Promise.all(m).then(function(){s(i,o,Object.assign(c,{head:{block:!1,ignore:!0}}))});return}}if(c.morphStyle==="innerHTML")return f(o,i,c),i.children;if(c.morphStyle==="outerHTML"||c.morphStyle==null){let u=fe(o,i,c),h=u?.previousSibling,m=u?.nextSibling,y=a(i,u,c);return u?ce(h,y,m):[]}else throw"Do not understand how to morph style "+c.morphStyle}function l(i,o){return o.ignoreActiveValue&&i===document.activeElement&&i!==document.body}function a(i,o,c){if(!(c.ignoreActive&&i===document.activeElement))return o==null?c.callbacks.beforeNodeRemoved(i)===!1?i:(i.remove(),c.callbacks.afterNodeRemoved(i),null):H(i,o)?(c.callbacks.beforeNodeMorphed(i,o)===!1||(i instanceof HTMLHeadElement&&c.head.ignore||(i instanceof HTMLHeadElement&&c.head.style!=="morph"?E(o,i,c):(d(o,i,c),l(i,c)||f(o,i,c))),c.callbacks.afterNodeMorphed(i,o)),i):c.callbacks.beforeNodeRemoved(i)===!1||c.callbacks.beforeNodeAdded(o)===!1?i:(i.parentElement.replaceChild(o,i),c.callbacks.afterNodeAdded(o),c.callbacks.afterNodeRemoved(i),o)}function f(i,o,c){let u=i.firstChild,h=o.firstChild,m;for(;u;){if(m=u,u=m.nextSibling,h==null){if(c.callbacks.beforeNodeAdded(m)===!1)return;o.appendChild(m),c.callbacks.afterNodeAdded(m),M(c,m);continue}if(V(m,h,c)){a(h,m,c),h=h.nextSibling,M(c,m);continue}let y=se(i,o,m,h,c);if(y){h=W(h,y,c),a(y,m,c),M(c,m);continue}let z=ie(i,o,m,h,c);if(z){h=W(h,z,c),a(z,m,c),M(c,m);continue}if(c.callbacks.beforeNodeAdded(m)===!1)return;o.insertBefore(m,h),c.callbacks.afterNodeAdded(m),M(c,m)}for(;h!==null;){let y=h;h=h.nextSibling,U(y,c)}}function p(i,o,c,u){return i==="value"&&u.ignoreActiveValue&&o===document.activeElement?!0:u.callbacks.beforeAttributeUpdated(i,o,c)===!1}function d(i,o,c){let u=i.nodeType;if(u===1){let h=i.attributes,m=o.attributes;for(let y of h)if(!p(y.name,o,"update",c))try{o.getAttribute(y.name)!==y.value&&o.setAttribute(y.name,y.value)}catch(z){console.error("Error setting attribute:",{badNode:o,badAttribute:y,error:z.message})}for(let y=m.length-1;0<=y;y--){let z=m[y];p(z.name,o,"remove",c)||i.hasAttribute(z.name)||o.removeAttribute(z.name)}}(u===8||u===3)&&o.nodeValue!==i.nodeValue&&(o.nodeValue=i.nodeValue),l(o,c)||v(i,o,c)}function b(i,o,c,u){if(i[c]!==o[c]){let h=p(c,o,"update",u);h||(o[c]=i[c]),i[c]?h||o.setAttribute(c,i[c]):p(c,o,"remove",u)||o.removeAttribute(c)}}function v(i,o,c){if(i instanceof HTMLInputElement&&o instanceof HTMLInputElement&&i.type!=="file"){let u=i.value,h=o.value;b(i,o,"checked",c),b(i,o,"disabled",c),i.hasAttribute("value")?u!==h&&(p("value",o,"update",c)||(o.setAttribute("value",u),o.value=u)):p("value",o,"remove",c)||(o.value="",o.removeAttribute("value"))}else if(i instanceof HTMLOptionElement)b(i,o,"selected",c);else if(i instanceof HTMLTextAreaElement&&o instanceof HTMLTextAreaElement){let u=i.value,h=o.value;if(p("value",o,"update",c))return;u!==h&&(o.value=u),o.firstChild&&o.firstChild.nodeValue!==u&&(o.firstChild.nodeValue=u)}}function E(i,o,c){let u=[],h=[],m=[],y=[],z=c.head.style,N=new Map;for(let A of i.children)N.set(A.outerHTML,A);for(let A of o.children){let T=N.has(A.outerHTML),I=c.head.shouldReAppend(A),k=c.head.shouldPreserve(A);T||k?I?h.push(A):(N.delete(A.outerHTML),m.push(A)):z==="append"?I&&(h.push(A),y.push(A)):c.head.shouldRemove(A)!==!1&&h.push(A)}y.push(...N.values());let X=[];for(let A of y){let T=document.createRange().createContextualFragment(A.outerHTML).firstChild;if(c.callbacks.beforeNodeAdded(T)!==!1){if(T.href||T.src){let I=null,k=new Promise(function(pe){I=pe});T.addEventListener("load",function(){I()}),X.push(k)}o.appendChild(T),c.callbacks.afterNodeAdded(T),u.push(T)}}for(let A of h)c.callbacks.beforeNodeRemoved(A)!==!1&&(o.removeChild(A),c.callbacks.afterNodeRemoved(A));return c.head.afterHeadMorphed(o,{added:u,kept:m,removed:h}),X}function F(){}function S(){}function j(i){let o={};return Object.assign(o,e),Object.assign(o,i),o.callbacks={},Object.assign(o.callbacks,e.callbacks),Object.assign(o.callbacks,i.callbacks),o.head={},Object.assign(o.head,e.head),Object.assign(o.head,i.head),o}function ne(i,o,c){return c=j(c),{target:i,newContent:o,config:c,morphStyle:c.morphStyle,ignoreActive:c.ignoreActive,ignoreActiveValue:c.ignoreActiveValue,idMap:he(i,o),deadIds:new Set,callbacks:c.callbacks,head:c.head}}function V(i,o,c){return i==null||o==null?!1:i.nodeType===o.nodeType&&i.tagName===o.tagName?i.id!==""&&i.id===o.id?!0:_(c,i,o)>0:!1}function H(i,o){return i==null||o==null?!1:i.nodeType===o.nodeType&&i.tagName===o.tagName}function W(i,o,c){for(;i!==o;){let u=i;i=i.nextSibling,U(u,c)}return M(c,o),o.nextSibling}function se(i,o,c,u,h){let m=_(h,c,o),y=null;if(m>0){let z=u,N=0;for(;z!=null;){if(V(c,z,h))return z;if(N+=_(h,z,i),N>m)return null;z=z.nextSibling}}return y}function ie(i,o,c,u,h){let m=u,y=c.nextSibling,z=0;for(;m!=null;){if(_(h,m,i)>0)return null;if(H(c,m))return m;if(H(y,m)&&(z++,y=y.nextSibling,z>=2))return null;m=m.nextSibling}return m}function oe(i){let o=new DOMParser,c=i.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(c.match(/<\/html>/)||c.match(/<\/head>/)||c.match(/<\/body>/)){let u=o.parseFromString(i,"text/html");if(c.match(/<\/html>/))return u.generatedByIdiomorph=!0,u;{let h=u.firstChild;return h?(h.generatedByIdiomorph=!0,h):null}}else{let h=o.parseFromString("<body><template>"+i+"</template></body>","text/html").body.querySelector("template").content;return h.generatedByIdiomorph=!0,h}}function le(i){if(i==null)return document.createElement("div");if(i.generatedByIdiomorph)return i;if(i instanceof Node){let o=document.createElement("div");return o.append(i),o}else{let o=document.createElement("div");for(let c of[...i])o.append(c);return o}}function ce(i,o,c){let u=[],h=[];for(;i!=null;)u.push(i),i=i.previousSibling;for(;u.length>0;){let m=u.pop();h.push(m),o.parentElement.insertBefore(m,o)}for(h.push(o);c!=null;)u.push(c),h.push(c),c=c.nextSibling;for(;u.length>0;)o.parentElement.insertBefore(u.pop(),o.nextSibling);return h}function fe(i,o,c){let u;u=i.firstChild;let h=u,m=0;for(;u;){let y=ae(u,o,c);y>m&&(h=u,m=y),u=u.nextSibling}return h}function ae(i,o,c){return H(i,o)?.5+_(c,i,o):0}function U(i,o){M(o,i),o.callbacks.beforeNodeRemoved(i)!==!1&&(i.remove(),o.callbacks.afterNodeRemoved(i))}function ue(i,o){return!i.deadIds.has(o)}function de(i,o,c){return(i.idMap.get(c)||r).has(o)}function M(i,o){let c=i.idMap.get(o)||r;for(let u of c)i.deadIds.add(u)}function _(i,o,c){let u=i.idMap.get(o)||r,h=0;for(let m of u)ue(i,m)&&de(i,m,c)&&++h;return h}function J(i,o){let c=i.parentElement,u=i.querySelectorAll("[id]");for(let h of u){let m=h;for(;m!==c&&m!=null;){let y=o.get(m);y==null&&(y=new Set,o.set(m,y)),y.add(h.id),m=m.parentElement}}}function he(i,o){let c=new Map;return J(i,c),J(o,c),c}return{morph:t,defaults:e}}();function te(r,e){if(r.includes("-")||console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),!e.__objects){let t=new e,s=class extends FezBase{};Object.getOwnPropertyNames(t).concat(Object.getOwnPropertyNames(e.prototype)).filter(f=>!["constructor","prototype"].includes(f)).forEach(f=>s.prototype[f]=t[f]),Fez.fastBindInfo||={fast:[],slow:[]},t.CSS&&(s.css=t.CSS),t.HTML&&(s.html=t.HTML),t.NAME&&(s.nodeName=t.NAME),t.FAST?(s.fastBind=t.FAST,Fez.fastBindInfo.fast.push(typeof t.FAST=="function"?`${r} (func)`:r)):Fez.fastBindInfo.slow.push(r),e=s;let a=`${r} compiled`;t.FAST&&(a+=" (fast bind)"),Fez.log(a)}e.html&&(e.html=Te(e.html),e.html=e.html.replace(/<slot\s*\/>|<slot\s*>\s*<\/slot>/g,()=>{let t=e.slotNodeName||"div";return`<${t} class="fez-slot"></${t}>`}),e.fezHtmlFunc=R(e.html)),e.css&&(e.css=Fez.globalCss(e.css,{name:r})),Fez._classCache[r]=e,customElements.get(r)||customElements.define(r,class extends HTMLElement{connectedCallback(){let t=Ce(this,e)||this.getAttribute("fez-fast");this.getAttribute("fez-fast")=="false"&&(t=!1),t?ee(r,this,Fez._classCache[r]):window.requestAnimationFrame(()=>{this.parentNode&&ee(r,this,Fez._classCache[r])})}})}function Te(r){let e=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]);return r.replace(/<([a-z-]+)\b([^>]*)\/>/g,(t,s,l)=>e.has(s)?t:`<${s}${l}></${s}>`)}function ee(r,e,t){let s=e.parentNode;if(e.isConnected){let l=typeof t.nodeName=="function"?t.nodeName(e):t.nodeName,a=document.createElement(l||"div");a.classList.add("fez"),a.classList.add(`fez-${r}`),s.replaceChild(a,e);let f=new t;f.oldRoot=e,f.fezName=r,f.root=a,f.props=t.getProps(e,a),f.class=t,f.slot(e,a),a.fez=f,window.$&&(f.$root=$(a)),f.props.id&&a.setAttribute("id",f.props.id),f.fezRegister(),(f.created||f.connect).bind(f)(f.props),t.__objects.push(f);let p=f.root.cloneNode(!0);f.class.fezHtmlFunc&&f.render();let d=f.root.querySelector(".fez-slot");if(d&&(f.props.html?d.innerHTML=f.props.html:f.slot(p,d)),f.onSubmit){let b=f.root.nodeName=="FORM"?f.root:f.find("form");b.onsubmit=v=>{v.preventDefault(),f.onSubmit(f.formData())}}if((f.connected||f.onMount).bind(f)(),f.onPropsChange){we.observe(a,{attributes:!0});for(let[b,v]of Object.entries(f.props))f.onPropsChange(b,v)}}}function Ce(r,e){return typeof e.fastBind=="function"?e.fastBind(r):e.fastBind}var we=new MutationObserver((r,e)=>{for(let t of r)if(t.type==="attributes"){let s=t.target.fez,l=t.attributeName,a=t.target.getAttribute(l);s&&(s.props[l]=a,s.onPropsChange(l,a))}});var Me=r=>{let e={script:"",style:"",html:"",head:""},t=r.split(`
`),s=[],l="";for(var a of t)a=a.trim(),a.startsWith("<script")&&!e.script&&l!="head"?l="script":a.startsWith("<head")&&!e.script?l="head":a.startsWith("<style")?l="style":a.endsWith("<\/script>")&&l==="script"&&!e.script?(e.script=s.join(`
`),s=[],l=null):a.endsWith("</style>")&&l==="style"?(e.style=s.join(`
`),s=[],l=null):(a.endsWith("</head>")||a.endsWith("</header>"))&&l==="head"?(e.head=s.join(`
`),s=[],l=null):l?s.push(a):e.html+=a+`
`;if(e.head){let p=document.createElement("div");p.innerHTML=e.head,Array.from(p.children).forEach(d=>{if(d.tagName==="SCRIPT"){let b=document.createElement("script");Array.from(d.attributes).forEach(v=>{b.setAttribute(v.name,v.value)}),b.type||="text/javascript",d.src?document.head.appendChild(b):b.type.includes("javascript")&&(b.textContent=d.textContent,document.head.appendChild(b))}else document.head.appendChild(d.cloneNode(!0))})}let f=e.script;return/class\s+\{/.test(f)||(f=`class {
${f}
}`),String(e.style).includes(":")&&(e.style=e.style.includes(":fez")||/(?:^|\s)body\s*\{/.test(e.style)?e.style:`:fez {
${e.style}
}`,f=f.replace(/\}\s*$/,`
  CSS = \`${e.style}\`
}`)),/\w/.test(String(e.html))&&(e.html=e.html.replaceAll("`","&#x60;"),e.html=e.html.replaceAll("$","\\$"),f=f.replace(/\}\s*$/,`
  HTML = \`${e.html}\`
}`)),f};function re(r,e){if(r instanceof Node){let l=r;l.remove();let a=l.getAttribute("fez");if(a&&(a.includes(".")||a.includes("/"))){let f=a;Fez.log(`Loading from ${f}`);let p=d=>d.split("/").pop().replace(/\.(fez\.)?html$/,"");fetch(f).then(d=>{if(!d.ok)throw new Error(`Failed to load ${f}: ${d.status}`);return d.text()}).then(d=>{let E=new DOMParser().parseFromString(d,"text/html").querySelectorAll("template[fez], xmp[fez]");if(E.length>0)E.forEach(F=>{let S=F.getAttribute("fez");S&&!S.includes("-")&&!S.includes(".")&&!S.includes("/")&&console.error(`Fez: Invalid custom element name "${S}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let j=F.innerHTML;Fez.compile(S,j)});else{let F=p(f);Fez.compile(F,d)}}).catch(d=>{console.error(`FEZ template load error for "${a}": ${d.message}`)});return}else a&&!a.includes("-")&&console.error(`Fez: Invalid custom element name "${a}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),e=l.innerHTML,r=a}else if(typeof e!="string"){document.body.querySelectorAll("template[fez], xmp[fez]").forEach(l=>Fez.compile(l));return}r&&!r.includes("-")&&!r.includes(".")&&!r.includes("/")&&console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let t=Me(e),s=t.split(/class\s+\{/,2);t=`${s[0]};

window.Fez('${r}', class {
${s[1]})`;try{new Function(t)()}catch(l){console.error(`FEZ template "${r}" compile error: ${l.message}`),console.log(t)}}var g=(r,e)=>{if(r)if(e)if(typeof e=="function"&&!/^class\s/.test(e.toString())&&!/\b(this|new)\b/.test(e.toString())){let s=Array.from(document.querySelectorAll(`.fez.fez-${r}`)).filter(l=>l.fez);return s.forEach(l=>e(l.fez)),s}else return typeof e!="function"?g.find(r,e):te(r,e);else{let t=r.nodeName?r.closest(".fez"):document.querySelector(r.includes("#")?r:`.fez.fez-${r}`);if(t){if(t.fez)return t.fez;g.error(`node "${r}" has no Fez attached.`)}else g.error(`node "${r}" not found.`)}else return FezBase};g._classCache={};g.id=()=>{g._id_count||=0,g._id_count+=1;let r=Math.random().toString(36).substring(2,6);return`fez_${g._id_count}${r}`};g.find=(r,e)=>{let t=r;typeof t=="string"&&(t=document.body.querySelector(t)),typeof t.val=="function"&&(t=t[0]);let s=e?`.fez.fez-${e}`:".fez",l=t.closest(s);if(l&&l.fez)return l.fez;console.error("Fez node connector not found",r,t)};g.cssClass=r=>Q.css(r);g.globalCss=(r,e={})=>{if(typeof r=="function"&&(r=r()),r.includes(":")){let t=r.split(`
`).filter(s=>!/^\s*\/\//.test(s)).join(`
`);e.wrap&&(t=`:fez { ${t} }`),t=t.replace(/\:fez|\:host/,`.fez.fez-${e.name}`),r=g.cssClass(t)}return document.body?document.body.parentElement.classList.add(r):document.addEventListener("DOMContentLoaded",()=>{document.body.parentElement.classList.add(r)}),r};g.info=()=>{console.log(JSON.stringify(g.fastBindInfo,null,2))};g.morphdom=(r,e,t={})=>{Array.from(r.attributes).forEach(l=>{e.setAttribute(l.name,l.value)}),x.morph(r,e,{morphStyle:"outerHTML"});let s=r.nextSibling;s?.nodeType===Node.TEXT_NODE&&s.textContent.trim()===""&&s.remove()};g.htmlEscape=r=>(typeof r=="string"&&(r=r.replace(/font-family\s*:\s*(?:&[^;]+;|[^;])*?;/gi,"").replaceAll("'","&apos;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;")),r);g.publish=(r,...e)=>{g._subs||={},g._subs[r]||=[],g._subs[r].forEach(t=>{t[1].bind(t[0])(...e)})};g.fnv1=r=>{var e,t,s,l,a,f;for(e=2166136261,t=16777619,s=e,l=a=0,f=r.length-1;0<=f?a<=f:a>=f;l=0<=f?++a:--a)s^=r.charCodeAt(l),s*=t;return s.toString(36).replaceAll("-","")};g.tag=(r,e={},t="")=>{let s=encodeURIComponent(JSON.stringify(e));return`<${r} data-props="${s}">${t}</${r}>`};g.error=r=>{console.error(`Fez ERROR: ${r}`)};g.log=r=>{(window.DEV===!0||g.LOG===!0)&&console.log(`Fez: ${r}`)};document.addEventListener("DOMContentLoaded",()=>{g.log("window.DEV === true || Fez.LOG === true, logging enabled.")});g.head=(r,e)=>{if(r.includes("<")){let t=document.createElement("div");t.innerHTML=r,Array.from(t.childNodes).forEach(s=>{if(s.tagName==="SCRIPT"){let l=document.createElement("script");Array.from(s.attributes).forEach(a=>{l.setAttribute(a.name,a.value)}),s.textContent&&(l.textContent=s.textContent),document.head.appendChild(l)}else document.head.appendChild(s)})}else if(e||=r.includes("css")?"css":"js",e=="css"){let t=document.createElement("link");t.rel="stylesheet",t.href=r,document.head.appendChild(t)}else{let t=document.createElement("script");t.src=r,document.head.appendChild(t)}};g.untilTrue=(r,e)=>{r()||setTimeout(r,e||200)};g.getScript=(r,e,t)=>{let s={},l=null;typeof e=="function"?l=e:typeof e=="object"&&(s=e,l=t);let a=s.rel==="stylesheet",f=a?"link":"script",p=document.querySelector(`${f}[src="${r}"], ${f}[href="${r}"]`);if(p)return l&&l(),p;let d=document.createElement(f);a?d.href=r:d.src=r;for(let[b,v]of Object.entries(s))(b!=="type"||v!=="css")&&d.setAttribute(b,v);return l&&(d.onload=l),document.head.appendChild(d),d};g.compile=re;var q=g;window.FezBase=L;window.Fez=q;setInterval(()=>{L.__objects=L.__objects.filter(r=>r.isConnected)},5e3);var Ne=new MutationObserver(r=>{for(let{addedNodes:e}of r)e.forEach(t=>{t.nodeType===1&&t.matches("template[fez], xmp[fez]")&&window.requestAnimationFrame(()=>{q.compile(t),t.remove()})})});Ne.observe(document.documentElement,{childList:!0,subtree:!0});})();
//# sourceMappingURL=fez.js.map
