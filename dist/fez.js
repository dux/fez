(()=>{function _(t,e={},r){if(typeof e=="string"&&([e,r]=[r,e],e||={}),e instanceof Node&&(r=e,e={}),Array.isArray(t)&&(r=t,t="div"),(typeof e!="object"||Array.isArray(e))&&(r=e,e={}),t.includes(".")){let s=t.split(".");t=s.shift()||"div";let f=s.join(" ");e.class?e.class+=` ${f}`:e.class=f}let n=document.createElement(t);for(let[s,f]of Object.entries(e))if(typeof f=="function")n[s]=f.bind(this);else{let o=String(f).replaceAll("fez.",this.fezHtmlRoot);n.setAttribute(s,o)}if(r)if(Array.isArray(r))for(let s of r)n.appendChild(s);else r instanceof Node?n.appendChild(r):n.innerHTML=String(r);return n}function he(t,e){if(t=t.replace(/^#?raw/,"@html").replace(/^#?html/,"@html"),t.startsWith("#if")||t.startsWith("if"))return e.push(!1),t=t.replace(/^#?if/,""),`\${ ${t} ? \``;if(t.startsWith("#unless")||t.startsWith("unless"))return e.push(!1),t=t.replace(/^#?unless/,""),`\${ !(${t}) ? \``;if(t=="/block")return"`) && ''}";if(t.startsWith("#for")||t.startsWith("for")){t=t.replace(/^#?for/,"");let r=t.split(" in ",2);return"${"+r[1]+".map(("+r[0]+")=>`"}else if(t.startsWith("#each")||t.startsWith("each")){t=t.replace(/^#?each/,"");let r=t.split(" as ",2);return"${"+r[0]+".map(("+r[1]+")=>`"}else{if(t==":else"||t=="else")return e[e.length-1]=!0,"` : `";if(t=="/if"||t=="/unless")return e.pop()?"`}":"` : ``}";if(t=="/for"||t=="/each")return'`).join("")}';{let r="@html ";return t.startsWith(r)?t=t.replace(r,""):t=`Fez.htmlEscape(${t})`,"${"+t+"}"}}}function j(t,e={}){let r=[];t=t.replaceAll("[[","{{").replaceAll("]]","}}"),t=t.replace(/(\w+)=\{\{\s*(.*?)\s*\}\}([\s>])/g,(f,o,a,u)=>`${o}="{{ ${a} }}"${u}`);let n={};t=t.replace(/\{\{block\s+(\w+)\s*\}\}([^ยง]+)\{\{\/block\}\}/g,(f,o,a)=>(n[o]=a,"")),t=t.replace(/\{\{block:([\w\-]+)\s*\}\}/g,(f,o)=>n[o]||`block:${o}?`),t=t.replace(/:(\w+)="([\w\.\[\]]+)"/,(f,o,a)=>`:${o}=Fez.store.delete({{ Fez.store.set(${a}) }})`);let s=t.replace(/{{(.*?)}}/g,(f,o)=>(o=o.replaceAll("&#x60;","`"),o=o.replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),he(o,r)));s="`"+s.trim()+"`";try{let f=`const fez = this;
      with (this) {
        return ${s}
      }
    `,o=new Function(f);return u=>{try{return o.bind(u)()}catch(m){m.message=`FEZ template runtime error: ${m.message}

Template source: ${s}`,console.error(m)}}}catch(f){return f.message=`FEZ template compile error: ${f.message}Template source:
${s}`,console.error(f),()=>Fez.error("Template Compile Error",!0)}}var L=class{static getProps(e,r){let n={};if(e.props)return e.props;for(let s of e.attributes)n[s.name]=s.value;for(let[s,f]of Object.entries(n))if([":"].includes(s[0])){delete n[s];try{let o=new Function(`return (${f})`).bind(r)();n[s.replace(/[\:_]/,"")]=o}catch(o){console.error(`Fez: Error evaluating attribute ${s}="${f}" for ${e.tagName}: ${o.message}`)}}if(n["data-props"]){let s=n["data-props"];if(typeof s=="object")return s;s[0]!="{"&&(s=decodeURIComponent(s));try{n=JSON.parse(s)}catch(f){console.error(`Fez: Invalid JSON in data-props for ${e.tagName}: ${f.message}`)}}else if(n["data-json-template"]){let s=r.previousSibling?.textContent;if(s)try{n=JSON.parse(s),r.previousSibling.remove()}catch(f){console.error(`Fez: Invalid JSON in template for ${e.tagName}: ${f.message}`)}}return n}static formData(e){let r=e.closest("form")||e.querySelector("form");if(!r)return Fez.log("No form found for formData()"),{};let n=new FormData(r),s={};return n.forEach((f,o)=>{s[o]=f}),s}static fastBind(){return!1}static nodeName="div";constructor(){}n=_;get fezHtmlRoot(){return`Fez(${this.UID}).`}get isConnected(){return this.root?.isConnected?!0:(this._setIntervalCache||={},Object.keys(this._setIntervalCache).forEach(e=>{clearInterval(this._setIntervalCache[e])}),this.onDestroy(),this.onDestroy=()=>{},this.root&&(this.root.fez=void 0),this.root=void 0,!1)}prop(e){let r=this.oldRoot[e]||this.props[e];return typeof r=="function"&&(r=r.bind(this.root)),r}copy(){for(let e of Array.from(arguments)){let r=this.props[e];if(r!==void 0){if(e=="class"){let n=this.root.getAttribute(e,r);n&&(r=[n,r].join(" "))}(e=="style"||!this.root[e])&&(typeof r=="string"?this.root.setAttribute(e,r):this.root[e]=r)}}}onResize(e,r){let n,s=0;e();let f=()=>{if(!this.isConnected){window.removeEventListener("resize",o);return}e.call(this)},o=()=>{if(!this.isConnected){window.removeEventListener("resize",o);return}if(r){let a=Date.now();a-s>=r&&(f(),s=a)}else clearTimeout(n),n=setTimeout(f,200)};window.addEventListener("resize",o)}slot(e,r){r||=document.createElement("template");let n=r.nodeName=="SLOT";for(;e.firstChild;)n?r.parentNode.insertBefore(e.lastChild,r.nextSibling):r.appendChild(e.firstChild);return n?r.parentNode.removeChild(r):e.innerHTML="",r}setStyle(e,r){this.root.style.setProperty(e,r)}connect(){}onMount(){}beforeRender(){}afterRender(){}onDestroy(){}publish=Fez.publish;fezBlocks={};parseHtml(e){let r=this.fezHtmlRoot.replaceAll('"',"&quot;");return e=e.replace(/([^\w\.])fez\./g,`$1${r}`).replace(/>\s+</g,"><"),e.trim()}nextTick(e,r){r?(this._nextTicks||={},this._nextTicks[r]||=window.requestAnimationFrame(()=>{e.bind(this)(),this._nextTicks[r]=null},r)):window.requestAnimationFrame(e.bind(this))}render(e){if(e||=this?.class?.fezHtmlFunc,!e)return;this.beforeRender();let r=document.createElement(this.class.nodeName||"div"),n;Array.isArray(e)?e[0]instanceof Node?e.forEach(o=>r.appendChild(o)):n=e.join(""):typeof e=="string"?n=j(e)(this):typeof e=="function"&&(n=e(this)),n&&(n=n.replace(/\s\w+="undefined"/g,""),r.innerHTML=this.parseHtml(n));let s=r.querySelector("slot");s&&(this.slot(this.root,s.parentNode),s.parentNode.removeChild(s));let f=this.find(".fez-slot");if(f){let o=r.querySelector(".fez-slot");o&&o.parentNode.replaceChild(f,o)}Fez.morphdom(this.root,r),this.renderFezPostProcess(),this.afterRender()}renderFezPostProcess(){let e=(r,n)=>{this.root.querySelectorAll(`*[${r}]`).forEach(s=>{let f=s.getAttribute(r);s.removeAttribute(r),f&&n.bind(this)(f,s)})};e("fez-this",(r,n)=>{new Function("n",`this.${r} = n`).bind(this)(n)}),e("fez-use",(r,n)=>{let s=this[r];typeof s=="function"?s(n):console.error(`Fez error: "${r}" is not a function in ${this.fezName}`)}),e("fez-class",(r,n)=>{let s=r.split(/\s+/),f=s.pop();s.forEach(o=>n.classList.add(o)),f&&setTimeout(()=>{n.classList.add(f)},300)}),e("fez-bind",(r,n)=>{if(["INPUT","SELECT","TEXTAREA"].includes(n.nodeName)){let s=new Function(`return this.${r}`).bind(this)(),f=n.type.toLowerCase()=="checkbox",o=["SELECT"].includes(n.nodeName)||f?"onchange":"onkeyup";n.setAttribute(o,`${this.fezHtmlRoot}${r} = this.${f?"checked":"value"}`),this.val(n,s)}else console.error(`Cant fez-bind="${r}" to ${n.nodeName} (needs INPUT, SELECT or TEXTAREA. Want to use fez-this?).`)}),this.root.querySelectorAll("*[disabled]").forEach(r=>{let n=r.getAttribute("disabled");["false"].includes(n)?r.removeAttribute("disabled"):r.setAttribute("disabled","true")})}refresh(e){if(alert("NEEDS FIX and remove htmlTemplate"),e){let r=document.createElement("div");r.innerHTML=this.class.htmlTemplate;let n=r.querySelector(e).innerHTML;this.render(e,n)}else this.render()}setInterval(e,r,n){return typeof e=="number"&&([r,e]=[e,r]),n||=Fez.fnv1(String(e)),this._setIntervalCache||={},clearInterval(this._setIntervalCache[n]),this._setIntervalCache[n]=setInterval(()=>{this.isConnected&&e()},r),this._setIntervalCache[n]}find(e){return typeof e=="string"?this.root.querySelector(e):e}val(e,r){let n=this.find(e);if(n)if(["INPUT","TEXTAREA","SELECT"].includes(n.nodeName))if(typeof r<"u")n.type=="checkbox"?n.checked=!!r:n.value=r;else return n.value;else if(typeof r<"u")n.innerHTML=r;else return n.innerHTML}formData(e){return this.class.formData(e||this.root)}attr(e,r){return typeof r>"u"?this.root.getAttribute(e):(this.root.setAttribute(e,r),r)}childNodes(e){let r=Array.from(this.root.children);if(e){let n=document.createElement("div");n.style.display="none",document.body.appendChild(n),r.forEach(f=>n.appendChild(f));let s=Array.from(n.children).map(e);return document.body.removeChild(n),s}else return r}subscribe(e,r){Fez._subs||={},Fez._subs[e]||=[],Fez._subs[e]=Fez._subs[e].filter(n=>n[0].isConnected),Fez._subs[e].push([this,r])}rootId(){return this.root.id||=`fez_${this.UID}`,this.root.id}fezRegister(){this.css&&(this.css=Fez.globalCss(this.css,{name:this.fezName,wrap:!0})),this.class.css&&(this.class.css=Fez.globalCss(this.class.css,{name:this.fezName})),this.state||=this.reactiveStore(),this.fezRegisterBindMethods()}fezRegisterBindMethods(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).filter(r=>r!=="constructor"&&typeof this[r]=="function").forEach(r=>this[r]=this[r].bind(this))}fezHide(){let e=this.root,r=this.root.parentNode,n=document.createDocumentFragment();for(;e.firstChild;)n.appendChild(e.firstChild);return e.parentNode.replaceChild(n,e),this.root=r,Array.from(this.root.children)}reactiveStore(e,r){e||={},r||=(s,f,o)=>{this.nextTick(this.render,"render")},r.bind(this);function n(s,f){return typeof s!="object"||s===null?s:new Proxy(s,{set(o,a,u,m){if(Reflect.get(o,a,m)!==u){typeof u=="object"&&u!==null&&(u=n(u,f));let A=Reflect.set(o,a,u,m);return f(o,a,u),A}return!0},get(o,a,u){let m=Reflect.get(o,a,u);return typeof m=="object"&&m!==null?n(m,f):m}})}return n(e,r)}};var me={data:""},J=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||me,be=t=>{let e=J(t),r=e.data;return e.data="",r},ye=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ge=/\/\*[^]*?\*\/|  +/g,G=/\n+/g,C=(t,e)=>{let r="",n="",s="";for(let f in t){let o=t[f];f[0]=="@"?f[1]=="i"?r=f+" "+o+";":n+=f[1]=="f"?C(o,f):f+"{"+C(o,f[1]=="k"?"":e)+"}":typeof o=="object"?n+=C(o,e?e.replace(/([^,])+/g,a=>f.replace(/(^:.*)|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,a):a?a+" "+u:u)):f):o!=null&&(f=/^--/.test(f)?f:f.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=C.p?C.p(f,o):f+":"+o+";")}return r+(e&&s?e+"{"+s+"}":s)+n},T={},X=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+X(t[r]);return e}return t},ve=(t,e,r,n,s)=>{let f=X(t),o=T[f]||(T[f]=(u=>{let m=0,g=11;for(;m<u.length;)g=101*g+u.charCodeAt(m++)>>>0;return"go"+g})(f));if(!T[o]){let u=f!==t?t:(m=>{let g,A,E=[{}];for(;g=ye.exec(m.replace(ge,""));)g[4]?E.shift():g[3]?(A=g[3].replace(G," ").trim(),E.unshift(E[0][A]=E[0][A]||{})):E[0][g[1]]=g[2].replace(G," ").trim();return E[0]})(t);T[o]=C(s?{["@keyframes "+o]:u}:u,r?"":"."+o)}let a=r&&T.g?T.g:null;return r&&(T.g=T[o]),((u,m,g,A)=>{A?m.data=m.data.replace(A,u):m.data.indexOf(u)===-1&&(m.data=g?u+m.data:m.data+u)})(T[o],e,n,a),o},ze=(t,e,r)=>t.reduce((n,s,f)=>{let o=e[f];if(o&&o.call){let a=o(r),u=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=u?"."+u:a&&typeof a=="object"?a.props?"":C(a,""):a===!1?"":a}return n+s+(o??"")},"");function R(t){let e=this||{},r=t.call?t(e.p):t;return ve(r.unshift?r.raw?ze(r,[].slice.call(arguments,1),e.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(e.p):s),{}):r,J(e.target),e.g,e.o,e.k)}var Z,B,D,Ae=R.bind({g:1}),Ee=R.bind({k:1});function Se(t,e,r,n){C.p=e,Z=t,B=r,D=n}function $e(t,e){let r=this||{};return function(){let n=arguments;function s(f,o){let a=Object.assign({},f),u=a.className||s.className;r.p=Object.assign({theme:B&&B()},a),r.o=/ *go\d+/.test(u),a.className=R.apply(r,n)+(u?" "+u:""),e&&(a.ref=o);let m=t;return t[0]&&(m=a.as||t,delete a.as),D&&m[0]&&D(a),Z(m,a)}return e?e(s):s}}var K={css:R,extractCss:be,glob:Ae,keyframes:Ee,setup:Se,styled:$e};var Y=function(){"use strict";let t=new Set,e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:S,afterNodeAdded:S,beforeNodeMorphed:S,afterNodeMorphed:S,beforeNodeRemoved:S,afterNodeRemoved:S,beforeAttributeUpdated:S},head:{style:"merge",shouldPreserve:function(i){return i.getAttribute("im-preserve")==="true"},shouldReAppend:function(i){return i.getAttribute("im-re-append")==="true"},shouldRemove:S,afterHeadMorphed:S}};function r(i,l,c={}){i instanceof Document&&(i=i.documentElement),typeof l=="string"&&(l=oe(l));let d=ie(l),p=re(i,d,c);return n(i,d,p)}function n(i,l,c){if(c.head.block){let d=i.querySelector("head"),p=l.querySelector("head");if(d&&p){let h=A(p,d,c);Promise.all(h).then(function(){n(i,l,Object.assign(c,{head:{block:!1,ignore:!0}}))});return}}if(c.morphStyle==="innerHTML")return o(l,i,c),i.children;if(c.morphStyle==="outerHTML"||c.morphStyle==null){let d=ce(l,i,c),p=d?.previousSibling,h=d?.nextSibling,y=f(i,d,c);return d?le(p,y,h):[]}else throw"Do not understand how to morph style "+c.morphStyle}function s(i,l){return l.ignoreActiveValue&&i===document.activeElement&&i!==document.body}function f(i,l,c){if(!(c.ignoreActive&&i===document.activeElement))return l==null?c.callbacks.beforeNodeRemoved(i)===!1?i:(i.remove(),c.callbacks.afterNodeRemoved(i),null):H(i,l)?(c.callbacks.beforeNodeMorphed(i,l)===!1||(i instanceof HTMLHeadElement&&c.head.ignore||(i instanceof HTMLHeadElement&&c.head.style!=="morph"?A(l,i,c):(u(l,i,c),s(i,c)||o(l,i,c))),c.callbacks.afterNodeMorphed(i,l)),i):c.callbacks.beforeNodeRemoved(i)===!1||c.callbacks.beforeNodeAdded(l)===!1?i:(i.parentElement.replaceChild(l,i),c.callbacks.afterNodeAdded(l),c.callbacks.afterNodeRemoved(i),l)}function o(i,l,c){let d=i.firstChild,p=l.firstChild,h;for(;d;){if(h=d,d=h.nextSibling,p==null){if(c.callbacks.beforeNodeAdded(h)===!1)return;l.appendChild(h),c.callbacks.afterNodeAdded(h),w(c,h);continue}if(P(h,p,c)){f(p,h,c),p=p.nextSibling,w(c,h);continue}let y=ne(i,l,h,p,c);if(y){p=q(p,y,c),f(y,h,c),w(c,h);continue}let v=se(i,l,h,p,c);if(v){p=q(p,v,c),f(v,h,c),w(c,h);continue}if(c.callbacks.beforeNodeAdded(h)===!1)return;l.insertBefore(h,p),c.callbacks.afterNodeAdded(h),w(c,h)}for(;p!==null;){let y=p;p=p.nextSibling,V(y,c)}}function a(i,l,c,d){return i==="value"&&d.ignoreActiveValue&&l===document.activeElement?!0:d.callbacks.beforeAttributeUpdated(i,l,c)===!1}function u(i,l,c){let d=i.nodeType;if(d===1){let p=i.attributes,h=l.attributes;for(let y of p)if(!a(y.name,l,"update",c))try{l.getAttribute(y.name)!==y.value&&l.setAttribute(y.name,y.value)}catch(v){console.error("Error setting attribute:",{badNode:l,badAttribute:y,error:v.message})}for(let y=h.length-1;0<=y;y--){let v=h[y];a(v.name,l,"remove",c)||i.hasAttribute(v.name)||l.removeAttribute(v.name)}}(d===8||d===3)&&l.nodeValue!==i.nodeValue&&(l.nodeValue=i.nodeValue),s(l,c)||g(i,l,c)}function m(i,l,c,d){if(i[c]!==l[c]){let p=a(c,l,"update",d);p||(l[c]=i[c]),i[c]?p||l.setAttribute(c,i[c]):a(c,l,"remove",d)||l.removeAttribute(c)}}function g(i,l,c){if(i instanceof HTMLInputElement&&l instanceof HTMLInputElement&&i.type!=="file"){let d=i.value,p=l.value;m(i,l,"checked",c),m(i,l,"disabled",c),i.hasAttribute("value")?d!==p&&(a("value",l,"update",c)||(l.setAttribute("value",d),l.value=d)):a("value",l,"remove",c)||(l.value="",l.removeAttribute("value"))}else if(i instanceof HTMLOptionElement)m(i,l,"selected",c);else if(i instanceof HTMLTextAreaElement&&l instanceof HTMLTextAreaElement){let d=i.value,p=l.value;if(a("value",l,"update",c))return;d!==p&&(l.value=d),l.firstChild&&l.firstChild.nodeValue!==d&&(l.firstChild.nodeValue=d)}}function A(i,l,c){let d=[],p=[],h=[],y=[],v=c.head.style,M=new Map;for(let z of i.children)M.set(z.outerHTML,z);for(let z of l.children){let F=M.has(z.outerHTML),N=c.head.shouldReAppend(z),k=c.head.shouldPreserve(z);F||k?N?p.push(z):(M.delete(z.outerHTML),h.push(z)):v==="append"?N&&(p.push(z),y.push(z)):c.head.shouldRemove(z)!==!1&&p.push(z)}y.push(...M.values());let U=[];for(let z of y){let F=document.createRange().createContextualFragment(z.outerHTML).firstChild;if(c.callbacks.beforeNodeAdded(F)!==!1){if(F.href||F.src){let N=null,k=new Promise(function(pe){N=pe});F.addEventListener("load",function(){N()}),U.push(k)}l.appendChild(F),c.callbacks.afterNodeAdded(F),d.push(F)}}for(let z of p)c.callbacks.beforeNodeRemoved(z)!==!1&&(l.removeChild(z),c.callbacks.afterNodeRemoved(z));return c.head.afterHeadMorphed(l,{added:d,kept:h,removed:p}),U}function E(){}function S(){}function te(i){let l={};return Object.assign(l,e),Object.assign(l,i),l.callbacks={},Object.assign(l.callbacks,e.callbacks),Object.assign(l.callbacks,i.callbacks),l.head={},Object.assign(l.head,e.head),Object.assign(l.head,i.head),l}function re(i,l,c){return c=te(c),{target:i,newContent:l,config:c,morphStyle:c.morphStyle,ignoreActive:c.ignoreActive,ignoreActiveValue:c.ignoreActiveValue,idMap:de(i,l),deadIds:new Set,callbacks:c.callbacks,head:c.head}}function P(i,l,c){return i==null||l==null?!1:i.nodeType===l.nodeType&&i.tagName===l.tagName?i.id!==""&&i.id===l.id?!0:O(c,i,l)>0:!1}function H(i,l){return i==null||l==null?!1:i.nodeType===l.nodeType&&i.tagName===l.tagName}function q(i,l,c){for(;i!==l;){let d=i;i=i.nextSibling,V(d,c)}return w(c,l),l.nextSibling}function ne(i,l,c,d,p){let h=O(p,c,l),y=null;if(h>0){let v=d,M=0;for(;v!=null;){if(P(c,v,p))return v;if(M+=O(p,v,i),M>h)return null;v=v.nextSibling}}return y}function se(i,l,c,d,p){let h=d,y=c.nextSibling,v=0;for(;h!=null;){if(O(p,h,i)>0)return null;if(H(c,h))return h;if(H(y,h)&&(v++,y=y.nextSibling,v>=2))return null;h=h.nextSibling}return h}function oe(i){let l=new DOMParser,c=i.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(c.match(/<\/html>/)||c.match(/<\/head>/)||c.match(/<\/body>/)){let d=l.parseFromString(i,"text/html");if(c.match(/<\/html>/))return d.generatedByIdiomorph=!0,d;{let p=d.firstChild;return p?(p.generatedByIdiomorph=!0,p):null}}else{let p=l.parseFromString("<body><template>"+i+"</template></body>","text/html").body.querySelector("template").content;return p.generatedByIdiomorph=!0,p}}function ie(i){if(i==null)return document.createElement("div");if(i.generatedByIdiomorph)return i;if(i instanceof Node){let l=document.createElement("div");return l.append(i),l}else{let l=document.createElement("div");for(let c of[...i])l.append(c);return l}}function le(i,l,c){let d=[],p=[];for(;i!=null;)d.push(i),i=i.previousSibling;for(;d.length>0;){let h=d.pop();p.push(h),l.parentElement.insertBefore(h,l)}for(p.push(l);c!=null;)d.push(c),p.push(c),c=c.nextSibling;for(;d.length>0;)l.parentElement.insertBefore(d.pop(),l.nextSibling);return p}function ce(i,l,c){let d;d=i.firstChild;let p=d,h=0;for(;d;){let y=fe(d,l,c);y>h&&(p=d,h=y),d=d.nextSibling}return p}function fe(i,l,c){return H(i,l)?.5+O(c,i,l):0}function V(i,l){w(l,i),l.callbacks.beforeNodeRemoved(i)!==!1&&(i.remove(),l.callbacks.afterNodeRemoved(i))}function ae(i,l){return!i.deadIds.has(l)}function ue(i,l,c){return(i.idMap.get(c)||t).has(l)}function w(i,l){let c=i.idMap.get(l)||t;for(let d of c)i.deadIds.add(d)}function O(i,l,c){let d=i.idMap.get(l)||t,p=0;for(let h of d)ae(i,h)&&ue(i,h,c)&&++p;return p}function W(i,l){let c=i.parentElement,d=i.querySelectorAll("[id]");for(let p of d){let h=p;for(;h!==c&&h!=null;){let y=l.get(h);y==null&&(y=new Set,l.set(h,y)),y.add(p.id),h=h.parentElement}}}function de(i,l){let c=new Map;return W(i,c),W(l,c),c}return{morph:r,defaults:e}}();function x(t,e){let r=globalThis.window?.Fez||globalThis.Fez;if(t.includes("-")||console.error(`Fez: Invalid custom element name "${t}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),!e.fezHtmlRoot){let n=new e,s=class extends L{};if(Object.getOwnPropertyNames(n).concat(Object.getOwnPropertyNames(e.prototype)).filter(a=>!["constructor","prototype"].includes(a)).forEach(a=>s.prototype[a]=n[a]),r.fastBindInfo||={fast:[],slow:[]},n.GLOBAL&&(s.fezGlobal=n.GLOBAL),n.CSS&&(s.css=n.CSS),n.HTML&&(s.html=n.HTML),n.NAME&&(s.nodeName=n.NAME),n.FAST?(s.fastBind=n.FAST,r.fastBindInfo.fast.push(typeof n.FAST=="function"?`${t} (func)`:t)):r.fastBindInfo.slow.push(t),n.GLOBAL){let a=()=>document.body.appendChild(document.createElement(t));document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a()}e=s;let o=`${t} compiled`;n.FAST&&(o+=" (fast bind)"),r.log(o)}e.html&&(e.html=Fe(e.html),e.html=e.html.replace(/<slot\s*\/>|<slot\s*>\s*<\/slot>/g,()=>{let n=e.slotNodeName||"div";return`<${n} class="fez-slot"></${n}>`}),e.fezHtmlFunc=j(e.html)),e.css&&(e.css=r.globalCss(e.css,{name:t})),r.classes[t]=e,customElements.get(t)||customElements.define(t,class extends HTMLElement{connectedCallback(){Te(this,e)?Q(t,this):window.requestAnimationFrame(()=>{this.parentNode&&Q(t,this)})}})}function Fe(t){let e=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]);return t.replace(/<([a-z-]+)\b([^>]*)\/>/g,(r,n,s)=>e.has(n)?r:`<${n}${s}></${n}>`)}function Te(t,e){let r=t.getAttribute("fez-fast");var n=typeof e.fastBind=="function"?e.fastBind(t):e.fastBind;return r=="false"?!1:r||n}function Q(t,e){let r=Fez.classes[t],n=e.parentNode;if(e.isConnected){let s=typeof r.nodeName=="function"?r.nodeName(e):r.nodeName,f=document.createElement(s||"div");f.classList.add("fez"),f.classList.add(`fez-${t}`),n.replaceChild(f,e);let o=new r;o.UID=++Fez.instanceCount,Fez.instances.set(o.UID,o),o.oldRoot=e,o.fezName=t,o.root=f,o.props=r.getProps(e,f),o.class=r,o.slot(e,f),f.fez=o,r.fezGlobal&&r.fezGlobal!=!0&&(window[r.fezGlobal]=o),window.$&&(o.$root=$(f)),o.props.id&&f.setAttribute("id",o.props.id),o.fezRegister(),(o.init||o.created||o.connect).bind(o)(o.props);let a=o.root.cloneNode(!0);o.class.fezHtmlFunc&&o.render();let u=o.root.querySelector(".fez-slot");if(u&&(o.props.html?u.innerHTML=o.props.html:o.slot(a,u)),o.onSubmit){let m=o.root.nodeName=="FORM"?o.root:o.find("form");m.onsubmit=g=>{g.preventDefault(),o.onSubmit(o.formData())}}if(o.onMount(o.props),o.onPropsChange){Ce.observe(f,{attributes:!0});for(let[m,g]of Object.entries(o.props))o.onPropsChange(m,g)}}}var Ce=new MutationObserver((t,e)=>{for(let r of t)if(r.type==="attributes"){let n=r.target.fez,s=r.attributeName,f=r.target.getAttribute(s);n&&(n.props[s]=f,n.onPropsChange(s,f))}});var we=t=>{let e={script:"",style:"",html:"",head:""},r=t.split(`
`),n=[],s="";for(var f of r)f=f.trim(),f.startsWith("<script")&&!e.script&&s!="head"?s="script":f.startsWith("<head")&&!e.script?s="head":f.startsWith("<style")?s="style":f.endsWith("<\/script>")&&s==="script"&&!e.script?(e.script=n.join(`
`),n=[],s=null):f.endsWith("</style>")&&s==="style"?(e.style=n.join(`
`),n=[],s=null):(f.endsWith("</head>")||f.endsWith("</header>"))&&s==="head"?(e.head=n.join(`
`),n=[],s=null):s?n.push(f):e.html+=f+`
`;if(e.head){let a=document.createElement("div");a.innerHTML=e.head,Array.from(a.children).forEach(u=>{if(u.tagName==="SCRIPT"){let m=document.createElement("script");Array.from(u.attributes).forEach(g=>{m.setAttribute(g.name,g.value)}),m.type||="text/javascript",u.src?document.head.appendChild(m):(m.type.includes("javascript")||m.type=="module")&&(m.textContent=u.textContent,document.head.appendChild(m))}else document.head.appendChild(u.cloneNode(!0))})}let o=e.script;return/class\s+\{/.test(o)||(o=`class {
${o}
}`),String(e.style).includes(":")&&(Object.entries(Fez._styleMacros).forEach(([a,u])=>{e.style=e.style.replaceAll(`:${a} `,`${u} `)}),e.style=e.style.includes(":fez")||/(?:^|\s)body\s*\{/.test(e.style)?e.style:`:fez {
${e.style}
}`,o=o.replace(/\}\s*$/,`
  CSS = \`${e.style}\`
}`)),/\w/.test(String(e.html))&&(e.html=e.html.replaceAll("`","&#x60;"),e.html=e.html.replaceAll("$","\\$"),o=o.replace(/\}\s*$/,`
  HTML = \`${e.html}\`
}`)),o};function ee(t,e){if(t instanceof Node){let s=t;s.remove();let f=s.getAttribute("fez");if(f&&(f.includes(".")||f.includes("/"))){let o=f;Fez.log(`Loading from ${o}`),fetch(o).then(a=>{if(!a.ok)throw new Error(`Failed to load ${o}: ${a.status}`);return a.text()}).then(a=>{let g=new DOMParser().parseFromString(a,"text/html").querySelectorAll("template[fez], xmp[fez]");if(g.length>0)g.forEach(A=>{let E=A.getAttribute("fez");E&&!E.includes("-")&&!E.includes(".")&&!E.includes("/")&&console.error(`Fez: Invalid custom element name "${E}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let S=A.innerHTML;Fez.compile(E,S)});else{let A=o.split("/").pop().split(".")[0];Fez.compile(A,a)}}).catch(a=>{console.error(`FEZ template load error for "${f}": ${a.message}`)});return}else f&&!f.includes("-")&&console.error(`Fez: Invalid custom element name "${f}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),e=s.innerHTML,t=f}else if(typeof e!="string"){document.body.querySelectorAll("template[fez], xmp[fez]").forEach(s=>Fez.compile(s));return}t&&!t.includes("-")&&!t.includes(".")&&!t.includes("/")&&console.error(`Fez: Invalid custom element name "${t}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let r=we(e),n=r.split(/class\s+\{/,2);if(r=`${n[0]};

window.Fez('${t}', class {
${n[1]})`,t){let s=document.getElementById("fez-hidden-styles");s||(s=document.createElement("style"),s.id="fez-hidden-styles",document.head.appendChild(s)),s.textContent+=`${t} { display: none; }
`}if(r.includes("import "))Fez.head({script:r}),setTimeout(()=>{Fez.classes[t]||Fez.error(`Template "${t}" possible compile error. (can be a false positive, it imports are not loaded)`)},2e3);else try{new Function(r)()}catch(s){Fez.error(`Template "${t}" compile error: ${s.message}`),console.log(r)}}var b=(t,e)=>{if(typeof t=="number"){let r=b.instances.get(t);if(r)return r;b.error(`Instance with UID "${t}" not found.`)}else if(t)if(e)if(typeof e=="function"&&!/^\s*class/.test(e.toString())&&!/\b(this|new)\b/.test(e.toString())){let n=Array.from(document.querySelectorAll(`.fez.fez-${t}`)).filter(s=>s.fez);return n.forEach(s=>e(s.fez)),n}else return typeof e!="function"?b.find(t,e):x(t,e);else{let r=t.nodeName?t.closest(".fez"):document.querySelector(t.includes("#")?t:`.fez.fez-${t}`);if(r){if(r.fez)return r.fez;b.error(`node "${t}" has no Fez attached.`)}else b.error(`node "${t}" not found.`)}else return FezBase};b.classes={};b.instanceCount=0;b.instances=new Map;b.find=(t,e)=>{let r=t;typeof r=="string"&&(r=document.body.querySelector(r)),typeof r.val=="function"&&(r=r[0]);let n=e?`.fez.fez-${e}`:".fez",s=r.closest(n);if(s&&s.fez)return s.fez;console.error("Fez node connector not found",t,r)};b.cssClass=t=>K.css(t);b.globalCss=(t,e={})=>{if(typeof t=="function"&&(t=t()),t.includes(":")){let r=t.split(`
`).filter(n=>!/^\s*\/\//.test(n)).join(`
`);e.wrap&&(r=`:fez { ${r} }`),r=r.replace(/\:fez|\:host/,`.fez.fez-${e.name}`),t=b.cssClass(r)}return document.body?document.body.parentElement.classList.add(t):document.addEventListener("DOMContentLoaded",()=>{document.body.parentElement.classList.add(t)}),t};b.info=()=>{console.log(JSON.stringify(b.fastBindInfo,null,2))};b.morphdom=(t,e,r={})=>{Array.from(t.attributes).forEach(s=>{e.setAttribute(s.name,s.value)}),Y.morph(t,e,{morphStyle:"outerHTML"});let n=t.nextSibling;n?.nodeType===Node.TEXT_NODE&&n.textContent.trim()===""&&n.remove()};b.htmlEscape=t=>typeof t=="string"?(t=t.replace(/font-family\s*:\s*(?:&[^;]+;|[^;])*?;/gi,"").replaceAll("'","&apos;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;"),t):t===void 0?"":t;b.publish=(t,...e)=>{b._subs||={},b._subs[t]||=[],b._subs[t].forEach(r=>{r[1].bind(r[0])(...e)})};b.fnv1=t=>{var e,r,n,s,f,o;for(e=2166136261,r=16777619,n=e,s=f=0,o=t.length-1;0<=o?f<=o:f>=o;s=0<=o?++f:--f)n^=t.charCodeAt(s),n*=r;return n.toString(36).replaceAll("-","")};b.tag=(t,e={},r="")=>{let n=encodeURIComponent(JSON.stringify(e));return`<${t} data-props="${n}">${r}</${t}>`};b.error=(t,e)=>{if(t=`Fez: ${t}`,console.error(t),e)return`<span style="border: 1px solid red; font-size: 14px; padding: 3px 7px; background: #fee; border-radius: 4px;">${t}</span>`};b.log=t=>{b.LOG===!0&&console.log(`Fez: ${t}`)};document.addEventListener("DOMContentLoaded",()=>{b.log("Fez.LOG === true, logging enabled.")});b.untilTrue=(t,e)=>{e||=200,t()||setTimeout(()=>{b.untilTrue(t,e)},e)};b.head=(t,e)=>{if(typeof t!="object"||t===null)throw new Error("head requires an object parameter");let r,n={},s;if(t.script){if(t.script.includes("import ")){e&&b.error("Fez.head callback is not supported when script with import is passed (module context).");let a=document.createElement("script");a.type="module",a.textContent=t.script,document.head.appendChild(a),setTimeout(()=>a.remove(),100)}else try{new Function(t.script)(),e&&e()}catch(a){console.error("Error executing script:",a),console.log(t.script)}return}else if(t.js){r=t.js,s="script";for(let[a,u]of Object.entries(t))a!=="js"&&a!=="module"&&(n[a]=u);t.module&&(n.type="module")}else if(t.css){r=t.css,s="link",n.rel="stylesheet";for(let[a,u]of Object.entries(t))a!=="css"&&(n[a]=u)}else throw new Error('head requires either "script", "js" or "css" property');let f=document.querySelector(`${s}[src="${r}"], ${s}[href="${r}"]`);if(f)return e&&e(),f;let o=document.createElement(s);s==="link"?o.href=r:o.src=r;for(let[a,u]of Object.entries(n))o.setAttribute(a,u);return(e||t.module)&&(o.onload=()=>{t.module&&s==="script"&&import(r).then(a=>{window[t.module]=a.default||a[t.module]||a}).catch(a=>{console.error(`Error importing module ${t.module}:`,a)}),e&&e()}),document.head.appendChild(o),o};b.fetch=function(...t){b._fetchCache||={};let e="GET",r,n;typeof t[0]=="string"&&/^[A-Z]+$/.test(t[0])&&(e=t.shift()),r=t.shift();let s={},f=null;if(typeof t[0]=="object"&&(f=t.shift()),typeof t[0]=="function"&&(n=t.shift()),f){if(e==="GET"){let u=new URLSearchParams(f);r+=(r.includes("?")?"&":"?")+u.toString()}else if(e==="POST"){let u=new FormData;for(let[m,g]of Object.entries(f))u.append(m,g);s.body=u}}s.method=e;let o=`${e}:${r}:${JSON.stringify(s)}`;if(b._fetchCache[o]){let u=b._fetchCache[o];if(b.log(`fetch cache hit: ${e} ${r}`),n){n(u);return}return Promise.resolve(u)}b.log(`fetch live: ${e} ${r}`);let a=u=>u.headers.get("content-type")?.includes("application/json")?u.json():u.text();if(n){fetch(r,s).then(a).then(u=>{b._fetchCache[o]=u,n(u)}).catch(u=>b.onError("fetch",u));return}return fetch(r,s).then(a).then(u=>(b._fetchCache[o]=u,u))};b.onError=(t,e)=>{if(typeof t!="string")throw new Error("Fez.onError: kind must be a string");console.error(`${t}: ${e.toString()}`)};b._styleMacros={};b.styleMacro=(t,e)=>{b._styleMacros[t]=e};b.store={store:new Map,counter:0,set(t){let e=this.counter++;return this.store.set(e,t),e},get(t){return this.store.get(t)},delete(t){let e=this.store.get(t);return this.store.delete(t),e}};b.compile=ee;var I=b;window.FezBase=L;window.Fez=I;setInterval(()=>{for(let[t,e]of I.instances)e?.isConnected||I.instances.delete(t)},5e3);var Me=new MutationObserver(t=>{for(let{addedNodes:e}of t)e.forEach(r=>{r.nodeType===1&&r.matches("template[fez], xmp[fez], script[fez]")&&window.requestAnimationFrame(()=>{I.compile(r),r.remove()})})});Me.observe(document.documentElement,{childList:!0,subtree:!0});I("fez-component",class{init(t){let e=document.createElement(t.name);for(e.props=t.props||t["data-props"]||t;this.root.firstChild;)this.root.parentNode.insertBefore(this.root.lastChild,e.nextSibling);this.root.innerHTML="",this.root.appendChild(e)}});})();
//# sourceMappingURL=fez.js.map
