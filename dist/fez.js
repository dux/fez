(()=>{function q(l,e){let s=/(\r\n|\r|\n)/g,f=/{{\s*(.+?)\s*}}/g,p=/^each\s+(.*)\s+as\s+(.*)$/,h=/^if\s+(.*)$/,c=/^else if\s+(.*)$/;function o(A){let S=T=>T.replaceAll("@","this."),L=`
      let _strings = [], _sequence = [], _values = [];

      function htmlEscape(text) {
        if (typeof text === 'string') {
          return text
            .replaceAll("'", '&apos;')
            .replaceAll('"', '&quot;')
            .replaceAll('<', '&lt;')
            .replaceAll('>', '&gt;')
        } else {
          return text
        }
      }

      _sequence.push('${A.trim().replace(s,"\\n").replace(f,(T,v)=>{if(v=v.replace(/^[#:]/,""),v.startsWith("each")||v.startsWith("for")){let _=v.split(/\s+/);if(_.shift()==="for"){let N=_.pop();_.pop(),v=`each ${N} as ${_.join(" ")}`}let j=p.exec(v);if(j)return j[1]=S(j[1]),`');
 (!Array.isArray(${j[1]}) ? Array.from(Object.entries(${j[1]} || []), ([key, value]) => [key, value]) : ${j[1]}).forEach((${j[2]}) => { _sequence.push('`}else if(v.startsWith("if")){let _=h.exec(v);if(_)return _[1]=S(_[1]),`');
 if (${_[1]}) { _sequence.push('`}else if(v.startsWith("else if")){let _=c.exec(v);if(_)return _[1]=S(_[1]),`');
 } else if (${_[1]}) { _sequence.push('`}else{if(v==="else")return`');
 } else { _sequence.push('`;if(v==="/each"||v==="/for")return`');
 }); _sequence.push('`;if(v==="/if")return`');
 } _sequence.push('`}let I=v.split(/^\@html\s+/);return I[1]?v=S(I[1]):v=`htmlEscape(${S(v)})`,`');
 _strings.push(_sequence.join(''));
 _sequence = [];
 _values.push(${v});
 _sequence.push('`})}');
      _strings.push(_sequence.join(''));
      return [_strings, _values];
    `;return new Function("_data",L)}function m(A){let S=o(A);return()=>{let[L,T]=S.bind(e)();return L.reduce((v,I,_)=>v+T[_-1]+I)}}function g(A){let S=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]);return A.replace(/<([a-z-]+)\b([^>]*)\/>/g,(L,T,v)=>S.has(T)?L:`<${T}${v}></${T}>`)}return l=g(l),m(l)}var Y=function(){"use strict";let l=new Set,e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:T,afterNodeAdded:T,beforeNodeMorphed:T,afterNodeMorphed:T,beforeNodeRemoved:T,afterNodeRemoved:T,beforeAttributeUpdated:T},head:{style:"merge",shouldPreserve:function(t){return t.getAttribute("im-preserve")==="true"},shouldReAppend:function(t){return t.getAttribute("im-re-append")==="true"},shouldRemove:T,afterHeadMorphed:T}};function s(t,r,i={}){t instanceof Document&&(t=t.documentElement),typeof r=="string"&&(r=re(r));let a=ie(r),u=I(t,a,i);return f(t,a,u)}function f(t,r,i){if(i.head.block){let a=t.querySelector("head"),u=r.querySelector("head");if(a&&u){let d=S(u,a,i);Promise.all(d).then(function(){f(t,r,Object.assign(i,{head:{block:!1,ignore:!0}}))});return}}if(i.morphStyle==="innerHTML")return c(r,t,i),t.children;if(i.morphStyle==="outerHTML"||i.morphStyle==null){let a=se(r,t,i),u=a?.previousSibling,d=a?.nextSibling,b=h(t,a,i);return a?ne(u,b,d):[]}else throw"Do not understand how to morph style "+i.morphStyle}function p(t,r){return r.ignoreActiveValue&&t===document.activeElement&&t!==document.body}function h(t,r,i){if(!(i.ignoreActive&&t===document.activeElement))return r==null?i.callbacks.beforeNodeRemoved(t)===!1?t:(t.remove(),i.callbacks.afterNodeRemoved(t),null):j(t,r)?(i.callbacks.beforeNodeMorphed(t,r)===!1||(t instanceof HTMLHeadElement&&i.head.ignore||(t instanceof HTMLHeadElement&&i.head.style!=="morph"?S(r,t,i):(m(r,t,i),p(t,i)||c(r,t,i))),i.callbacks.afterNodeMorphed(t,r)),t):i.callbacks.beforeNodeRemoved(t)===!1||i.callbacks.beforeNodeAdded(r)===!1?t:(t.parentElement.replaceChild(r,t),i.callbacks.afterNodeAdded(r),i.callbacks.afterNodeRemoved(t),r)}function c(t,r,i){let a=t.firstChild,u=r.firstChild,d;for(;a;){if(d=a,a=d.nextSibling,u==null){if(i.callbacks.beforeNodeAdded(d)===!1)return;r.appendChild(d),i.callbacks.afterNodeAdded(d),w(i,d);continue}if(_(d,u,i)){h(u,d,i),u=u.nextSibling,w(i,d);continue}let b=ee(t,r,d,u,i);if(b){u=N(u,b,i),h(b,d,i),w(i,d);continue}let M=te(t,r,d,u,i);if(M){u=N(u,M,i),h(M,d,i),w(i,d);continue}if(i.callbacks.beforeNodeAdded(d)===!1)return;r.insertBefore(d,u),i.callbacks.afterNodeAdded(d),w(i,d)}for(;u!==null;){let b=u;u=u.nextSibling,U(b,i)}}function o(t,r,i,a){return t==="value"&&a.ignoreActiveValue&&r===document.activeElement?!0:a.callbacks.beforeAttributeUpdated(t,r,i)===!1}function m(t,r,i){let a=t.nodeType;if(a===1){let u=t.attributes,d=r.attributes;for(let b of u)o(b.name,r,"update",i)||r.getAttribute(b.name)!==b.value&&r.setAttribute(b.name,b.value);for(let b=d.length-1;0<=b;b--){let M=d[b];o(M.name,r,"remove",i)||t.hasAttribute(M.name)||r.removeAttribute(M.name)}}(a===8||a===3)&&r.nodeValue!==t.nodeValue&&(r.nodeValue=t.nodeValue),p(r,i)||A(t,r,i)}function g(t,r,i,a){if(t[i]!==r[i]){let u=o(i,r,"update",a);u||(r[i]=t[i]),t[i]?u||r.setAttribute(i,t[i]):o(i,r,"remove",a)||r.removeAttribute(i)}}function A(t,r,i){if(t instanceof HTMLInputElement&&r instanceof HTMLInputElement&&t.type!=="file"){let a=t.value,u=r.value;g(t,r,"checked",i),g(t,r,"disabled",i),t.hasAttribute("value")?a!==u&&(o("value",r,"update",i)||(r.setAttribute("value",a),r.value=a)):o("value",r,"remove",i)||(r.value="",r.removeAttribute("value"))}else if(t instanceof HTMLOptionElement)g(t,r,"selected",i);else if(t instanceof HTMLTextAreaElement&&r instanceof HTMLTextAreaElement){let a=t.value,u=r.value;if(o("value",r,"update",i))return;a!==u&&(r.value=a),r.firstChild&&r.firstChild.nodeValue!==a&&(r.firstChild.nodeValue=a)}}function S(t,r,i){let a=[],u=[],d=[],b=[],M=i.head.style,z=new Map;for(let E of t.children)z.set(E.outerHTML,E);for(let E of r.children){let C=z.has(E.outerHTML),F=i.head.shouldReAppend(E),P=i.head.shouldPreserve(E);C||P?F?u.push(E):(z.delete(E.outerHTML),d.push(E)):M==="append"?F&&(u.push(E),b.push(E)):i.head.shouldRemove(E)!==!1&&u.push(E)}b.push(...z.values());let X=[];for(let E of b){let C=document.createRange().createContextualFragment(E.outerHTML).firstChild;if(i.callbacks.beforeNodeAdded(C)!==!1){if(C.href||C.src){let F=null,P=new Promise(function(ue){F=ue});C.addEventListener("load",function(){F()}),X.push(P)}r.appendChild(C),i.callbacks.afterNodeAdded(C),a.push(C)}}for(let E of u)i.callbacks.beforeNodeRemoved(E)!==!1&&(r.removeChild(E),i.callbacks.afterNodeRemoved(E));return i.head.afterHeadMorphed(r,{added:a,kept:d,removed:u}),X}function L(){}function T(){}function v(t){let r={};return Object.assign(r,e),Object.assign(r,t),r.callbacks={},Object.assign(r.callbacks,e.callbacks),Object.assign(r.callbacks,t.callbacks),r.head={},Object.assign(r.head,e.head),Object.assign(r.head,t.head),r}function I(t,r,i){return i=v(i),{target:t,newContent:r,config:i,morphStyle:i.morphStyle,ignoreActive:i.ignoreActive,ignoreActiveValue:i.ignoreActiveValue,idMap:fe(t,r),deadIds:new Set,callbacks:i.callbacks,head:i.head}}function _(t,r,i){return t==null||r==null?!1:t.nodeType===r.nodeType&&t.tagName===r.tagName?t.id!==""&&t.id===r.id?!0:k(i,t,r)>0:!1}function j(t,r){return t==null||r==null?!1:t.nodeType===r.nodeType&&t.tagName===r.tagName}function N(t,r,i){for(;t!==r;){let a=t;t=t.nextSibling,U(a,i)}return w(i,r),r.nextSibling}function ee(t,r,i,a,u){let d=k(u,i,r),b=null;if(d>0){let M=a,z=0;for(;M!=null;){if(_(i,M,u))return M;if(z+=k(u,M,t),z>d)return null;M=M.nextSibling}}return b}function te(t,r,i,a,u){let d=a,b=i.nextSibling,M=0;for(;d!=null;){if(k(u,d,t)>0)return null;if(j(i,d))return d;if(j(b,d)&&(M++,b=b.nextSibling,M>=2))return null;d=d.nextSibling}return d}function re(t){let r=new DOMParser,i=t.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(i.match(/<\/html>/)||i.match(/<\/head>/)||i.match(/<\/body>/)){let a=r.parseFromString(t,"text/html");if(i.match(/<\/html>/))return a.generatedByIdiomorph=!0,a;{let u=a.firstChild;return u?(u.generatedByIdiomorph=!0,u):null}}else{let u=r.parseFromString("<body><template>"+t+"</template></body>","text/html").body.querySelector("template").content;return u.generatedByIdiomorph=!0,u}}function ie(t){if(t==null)return document.createElement("div");if(t.generatedByIdiomorph)return t;if(t instanceof Node){let r=document.createElement("div");return r.append(t),r}else{let r=document.createElement("div");for(let i of[...t])r.append(i);return r}}function ne(t,r,i){let a=[],u=[];for(;t!=null;)a.push(t),t=t.previousSibling;for(;a.length>0;){let d=a.pop();u.push(d),r.parentElement.insertBefore(d,r)}for(u.push(r);i!=null;)a.push(i),u.push(i),i=i.nextSibling;for(;a.length>0;)r.parentElement.insertBefore(a.pop(),r.nextSibling);return u}function se(t,r,i){let a;a=t.firstChild;let u=a,d=0;for(;a;){let b=le(a,r,i);b>d&&(u=a,d=b),a=a.nextSibling}return u}function le(t,r,i){return j(t,r)?.5+k(i,t,r):0}function U(t,r){w(r,t),r.callbacks.beforeNodeRemoved(t)!==!1&&(t.remove(),r.callbacks.afterNodeRemoved(t))}function oe(t,r){return!t.deadIds.has(r)}function ae(t,r,i){return(t.idMap.get(i)||l).has(r)}function w(t,r){let i=t.idMap.get(r)||l;for(let a of i)t.deadIds.add(a)}function k(t,r,i){let a=t.idMap.get(r)||l,u=0;for(let d of a)oe(t,d)&&ae(t,d,i)&&++u;return u}function G(t,r){let i=t.parentElement,a=t.querySelectorAll("[id]");for(let u of a){let d=u;for(;d!==i&&d!=null;){let b=r.get(d);b==null&&(b=new Set,r.set(d,b)),b.add(u.id),d=d.parentElement}}}function fe(t,r){let i=new Map;return G(t,i),G(r,i),i}return{morph:s,defaults:e}}();var ce={data:""},J=l=>typeof window=="object"?((l?l.querySelector("#_goober"):window._goober)||Object.assign((l||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:l||ce,de=l=>{let e=J(l),s=e.data;return e.data="",s},he=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,pe=/\/\*[^]*?\*\/|  +/g,Z=/\n+/g,R=(l,e)=>{let s="",f="",p="";for(let h in l){let c=l[h];h[0]=="@"?h[1]=="i"?s=h+" "+c+";":f+=h[1]=="f"?R(c,h):h+"{"+R(c,h[1]=="k"?"":e)+"}":typeof c=="object"?f+=R(c,e?e.replace(/([^,])+/g,o=>h.replace(/(^:.*)|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,o):o?o+" "+m:m)):h):c!=null&&(h=/^--/.test(h)?h:h.replace(/[A-Z]/g,"-$&").toLowerCase(),p+=R.p?R.p(h,c):h+":"+c+";")}return s+(e&&p?e+"{"+p+"}":p)+f},H={},K=l=>{if(typeof l=="object"){let e="";for(let s in l)e+=s+K(l[s]);return e}return l},me=(l,e,s,f,p)=>{let h=K(l),c=H[h]||(H[h]=(m=>{let g=0,A=11;for(;g<m.length;)A=101*A+m.charCodeAt(g++)>>>0;return"go"+A})(h));if(!H[c]){let m=h!==l?l:(g=>{let A,S,L=[{}];for(;A=he.exec(g.replace(pe,""));)A[4]?L.shift():A[3]?(S=A[3].replace(Z," ").trim(),L.unshift(L[0][S]=L[0][S]||{})):L[0][A[1]]=A[2].replace(Z," ").trim();return L[0]})(l);H[c]=R(p?{["@keyframes "+c]:m}:m,s?"":"."+c)}let o=s&&H.g?H.g:null;return s&&(H.g=H[c]),((m,g,A,S)=>{S?g.data=g.data.replace(S,m):g.data.indexOf(m)===-1&&(g.data=A?m+g.data:g.data+m)})(H[c],e,f,o),c},be=(l,e,s)=>l.reduce((f,p,h)=>{let c=e[h];if(c&&c.call){let o=c(s),m=o&&o.props&&o.props.className||/^go/.test(o)&&o;c=m?"."+m:o&&typeof o=="object"?o.props?"":R(o,""):o===!1?"":o}return f+p+(c??"")},"");function B(l){let e=this||{},s=l.call?l(e.p):l;return me(s.unshift?s.raw?be(s,[].slice.call(arguments,1),e.p):s.reduce((f,p)=>Object.assign(f,p&&p.call?p(e.p):p),{}):s,J(e.target),e.g,e.o,e.k)}var Q,V,D,ge=B.bind({g:1}),ve=B.bind({k:1});function ye(l,e,s,f){R.p=e,Q=l,V=s,D=f}function Ae(l,e){let s=this||{};return function(){let f=arguments;function p(h,c){let o=Object.assign({},h),m=o.className||p.className;s.p=Object.assign({theme:V&&V()},o),s.o=/ *go\d+/.test(m),o.className=B.apply(s,f)+(m?" "+m:""),e&&(o.ref=c);let g=l;return l[0]&&(g=o.as||l,delete o.as),D&&g[0]&&D(o),Q(g,o)}return e?e(p):p}}var x={css:B,extractCss:de,glob:ge,keyframes:ve,setup:ye,styled:Ae};function W(l,e={},s){if(typeof e=="string"&&([e,s]=[s,e],e||={}),e instanceof Node&&(s=e,e={}),Array.isArray(l)&&(s=l,l="div"),(typeof e!="object"||Array.isArray(e))&&(s=e,e={}),l.includes(".")){let p=l.split(".");l=p.shift()||"div";let h=p.join(" ");e.class?e.class+=` ${h}`:e.class=h}let f=document.createElement(l);for(let[p,h]of Object.entries(e))if(typeof h=="function")f[p]=h.bind(this);else{let c=String(h).replaceAll("$$.",this.fezHtmlRoot);f.setAttribute(p,c)}if(s)if(Array.isArray(s))for(let p of s)f.appendChild(p);else s instanceof Node?f.appendChild(s):f.innerHTML=String(s);return f}var O=class{static __objects=[];static find(e,s){return y.find(e,s)}static fnv1(e){var s,f,p,h,c,o;for(s=2166136261,f=16777619,p=s,h=c=0,o=e.length-1;0<=o?c<=o:c>=o;h=0<=o?++c:--c)p^=e.charCodeAt(h),p*=f;return p.toString(36).replaceAll("-","")}static getProps(e){let s={};for(let f of e.attributes)s[f.name]=f.value;return s}static formData(e){let s=new FormData(e.closest("form")),f={};return s.forEach((p,h)=>{f[h]=p}),f}static fastBind(){return!1}constructor(){this.__int={}}n=W;get fezHtmlRoot(){return`Fez.find(this, "${this.fezName}").`}get isAttached(){return this.root?.parentNode?!0:(Object.keys(this.__int).forEach(e=>{clearInterval(this.__int[e])}),this.root.fez=null,this.root=null,!1)}prop(e){let s=this.oldRoot[e]||this.props[e];return typeof s=="function"&&(s=s.bind(this.root)),s}copy(){for(let e of Array.from(arguments)){let s=this.props[e];if(s!==void 0){if(e=="class"){let f=this.root.getAttribute(e,s);f&&(s=[f,s].join(" "))}typeof s=="string"?this.root.setAttribute(e,s):this.root[e]=s}}}slot(e,s){s||=document.createElement("template");let f=s.nodeName=="SLOT";for(;e.firstChild;)f?s.parentNode.insertBefore(e.lastChild,s.nextSibling):s.appendChild(e.firstChild);return f?s.parentNode.removeChild(s):e.innerHTML="",s}style(){console.error("call Fez static style")}connect(){console.error('Fez is missing "connect" method.',this.root)}parseHtml(e,s){if(typeof e=="object"&&(e=e[0]),e=e.replaceAll("$$.",this.fezHtmlRoot.replaceAll('"',"&quot;")),e.includes("{{"))try{e=q(e,this)()}catch(f){console.error(`Fez stache template error in "${this.fezName}"`,f)}return e}html(e,s){e||(e=this.class.html),typeof s>"u"&&(s=e,e=this.root),typeof e=="string"&&(e=this.find(e));let f=document.createElement("div");typeof s=="function"&&(s=s()),Array.isArray(s)?s[0]instanceof Node?s.forEach(c=>{f.appendChild(c)}):s=s.join(""):typeof s=="string"?f.innerHTML=this.parseHtml(s):f.appendChild(s);let p=f.querySelector("slot");p&&this.slot(e,p),y.morphdom(e,f);let h=(c,o)=>{e.querySelectorAll(`*[${c}]`).forEach(m=>{let g=m.getAttribute(c);m.removeAttribute(c),g&&o.bind(this)(g,m)})};h("fez-this",(c,o)=>{this[c]=o}),h("fez-use",(c,o)=>{let m=this[c];typeof m=="function"?m(o):console.error(`Fez error: "${c}" is not a function in ${this.fezName}`)}),h("fez-class",c=>{let o=c.split(/\s+/),m=o.pop();o.forEach(g=>n.classList.add(g)),m&&setTimeout(()=>{n.classList.add(m)},1e3)})}setInterval(e,s,f){return typeof e=="number"&&([s,e]=[e,s]),f||=this.class.fnv1(String(e)),clearInterval(this.__int[f]),this.__int[f]=setInterval(()=>{this.isAttached&&e()},s),this.__int[f]}css(e,s){let f=y.css(e);return s&&this.root.classList.add(f),f}find(e){return this.root.querySelector(e)}val(e,s){let f=this.find(".time");["INPUT","TEXTAREA","SELECT"].includes(f.nodeName)?f.value=s:f.innerHTML=new Date}formData(e){return this.class.formData(e||this.root)}attr(e,s){return typeof s>"u"?this.root.getAttribute(e):(this.root.setAttribute(e,s),s)}childNodes(e){let s=Array.from(this.root.querySelectorAll(":scope > *"));if(e)s.forEach(e);else return s}subscribe(e,s){y._subs||={},y._subs[e]||=[],y._subs[e]=y._subs[e].filter(f=>f[0].isAttached),y._subs[e].push([this,s])}fezRegister(){this.class.css&&(typeof this.class.css=="function"&&(this.class.css=this.class.css(this)),this.class.css.includes(":")&&(this.class.css=y.css(this.class.css)),this.root.classList.add(this.class.css)),this.fezRegisterBindMethods()}fezRegisterBindMethods(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).filter(s=>s!=="constructor"&&typeof this[s]=="function").forEach(s=>this[s]=this[s].bind(this))}};setInterval(()=>{O.__objects=O.__objects.filter(l=>l.isAttached)},1e4);var Ee=new MutationObserver((l,e)=>{for(let s of l)if(s.type==="attributes"){let f=s.target.fez,p=s.attributeName,h=s.target.getAttribute(p);f.props[p]=h,f.onPropsChange(p,h)}}),y=(l,e)=>{function s(){let p=this.parentNode;if(p){let h=typeof e.nodeName=="function"?e.nodeName(this):e.nodeName,c=document.createElement(h||"div");c.classList.add("fez"),c.classList.add(`fez-${l}`),p.replaceChild(c,this);let o=new e;o.oldRoot=this,o.fezName=l,o.root=c,o.props=e.getProps(this),o.class=e,o.slot(this,c),c.fez=o,window.$&&(o.$root=$(c)),o.props.id&&c.setAttribute("id",o.props.id),o.fezRegister(),o.connect(o.props),e.__objects.push(o),e.html&&(typeof e.html=="function"&&(e.html=e.html(this)),e.html=q(e.html,o),o.html()),o.onPropsChange&&Ee.observe(c,{attributes:!0})}}function f(p){return typeof e.fastBind=="function"?e.fastBind(p):e.fastBind}if(!l)return O;if(typeof e!="function")return y.find(l,e);customElements.define(l,class extends HTMLElement{connectedCallback(){this.firstChild||f(this)?(y.info(`fast bind: ${l}`),s.bind(this)()):(y.info(`slow bind: ${l}`),window.requestAnimationFrame(()=>{s.bind(this)()}))}})};y.find=(l,e)=>{typeof l=="string"&&(l=document.body.querySelector(l)),typeof l.val=="function"&&(l=l[0]);let s=e?`.fez-${e}`:".fez";return l.closest(s).fez};y.globalCss=l=>{let e=y.css(l);return document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add(e)}),e};y.css=l=>x.css(l);y.info=l=>{window.DEBUG&&console.log(`Fez: ${l}`)};y.morphdom=(l,e,s={})=>{s.childrenOnly===void 0&&(s.childrenOnly=!0),Y.morph(l,e,{morphStyle:"innerHTML"})};y.htmlEscape=l=>l.replaceAll("'","&apos;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;");y.publish=(l,...e)=>{y._subs[l]||=[],y._subs[l].forEach(s=>{s[1].bind(s[0])(...e)})};window.Fez=y;window.FezBase=O;})();
//# sourceMappingURL=fez.js.map
