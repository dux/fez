(()=>{function P(r,e={},t){if(typeof e=="string"&&([e,t]=[t,e],e||={}),e instanceof Node&&(t=e,e={}),Array.isArray(r)&&(t=r,r="div"),(typeof e!="object"||Array.isArray(e))&&(t=e,e={}),r.includes(".")){let c=r.split(".");r=c.shift()||"div";let f=c.join(" ");e.class?e.class+=` ${f}`:e.class=f}let s=document.createElement(r);for(let[c,f]of Object.entries(e))if(typeof f=="function")s[c]=f.bind(this);else{let i=String(f).replaceAll("$$.",this.fezHtmlRoot);s.setAttribute(c,i)}if(t)if(Array.isArray(t))for(let c of t)s.appendChild(c);else t instanceof Node?s.appendChild(t):s.innerHTML=String(t);return s}function me(r,e){if(r=r.replace(/^#?raw/,"@html").replace(/^#?html/,"@html"),r.startsWith("#if")||r.startsWith("if"))return e.push(!1),r=r.replace(/^#?if/,""),`\${ ${r} ? \``;if(r.startsWith("#unless")||r.startsWith("unless"))return e.push(!1),r=r.replace(/^#?unless/,""),`\${ !(${r}) ? \``;if(r=="/block")return"`) && ''}";if(r.startsWith("#for")||r.startsWith("for")){r=r.replace(/^#?for/,"");let t=r.split(" in ",2);return"${"+t[1]+".map(("+t[0]+")=>`"}else if(r.startsWith("#each")||r.startsWith("each")){r=r.replace(/^#?each/,"");let t=r.split(" as ",2);return"${"+t[0]+".map(("+t[1]+")=>`"}else{if(r==":else"||r=="else")return e[e.length-1]=!0,"` : `";if(r=="/if"||r=="/unless")return e.pop()?"`}":"` : ``}";if(r=="/for"||r=="/each")return'`).join("")}';{let t="@html ";return r.startsWith(t)?r=r.replace(t,""):r=`Fez.htmlEscape(${r})`,"${"+r+"}"}}}function R(r,e={}){let t=[];r=r.replaceAll("[[","{{").replaceAll("]]","}}"),r=r.replace(/(\w+)=\{\{\s*(.*?)\s*\}\}([\s>])/g,(f,i,u,d)=>`${i}="{{ ${u} }}"${d}`);let s={};r=r.replace(/\{\{block\s+(\w+)\s*\}\}([^ยง]+)\{\{\/block\}\}/g,(f,i,u)=>(s[i]=u,"")),r=r.replace(/\{\{block:([\w\-]+)\s*\}\}/g,(f,i)=>s[i]||`block:${i}?`),r=r.replace(/:(\w+)="([\w\.\[\]]+)"/,(f,i,u)=>`:${i}="{{ JSON.stringify(${u}) }}"`);let c=r.replace(/{{(.*?)}}/g,(f,i)=>(i=i.replaceAll("&#x60;","`"),i=i.replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),me(i,t)));c="`"+c.trim()+"`";try{let f=`const fez = this;
      with (this) {
        return ${c}
      }
    `,i=new Function(f);return d=>{try{return i.bind(d)()}catch(b){b.message=`FEZ template runtime error: ${b.message}

Template source: ${c}`,console.error(b)}}}catch(f){return f.message=`FEZ template compile error: ${f.message}Template source:
${c}`,console.error(f),()=>Fez.error("Template Compile Error",!0)}}var N=class{static getProps(e,t){let s={};if(e.props)return e.props;for(let c of e.attributes)s[c.name]=c.value;for(let[c,f]of Object.entries(s))if([":"].includes(c[0])){delete s[c];try{let i=new Function(`return (${f})`).bind(t)();s[c.replace(/[\:_]/,"")]=i}catch(i){console.error(`Fez: Error evaluating attribute ${c}="${f}" for ${e.tagName}: ${i.message}`)}}if(s["data-props"]){let c=s["data-props"];if(typeof c=="object")return c;c[0]!="{"&&(c=decodeURIComponent(c));try{s=JSON.parse(c)}catch(f){console.error(`Fez: Invalid JSON in data-props for ${e.tagName}: ${f.message}`)}}else if(s["data-json-template"]){let c=t.previousSibling?.textContent;if(c)try{s=JSON.parse(c),t.previousSibling.remove()}catch(f){console.error(`Fez: Invalid JSON in template for ${e.tagName}: ${f.message}`)}}return s}static formData(e){let t=e.closest("form")||e.querySelector("form");if(!t)return Fez.log("No form found for formData()"),{};let s=new FormData(t),c={};return s.forEach((f,i)=>{c[i]=f}),c}static fastBind(){return!1}static nodeName="div";constructor(){}n=P;get fezHtmlRoot(){return`Fez(${this.UID}).`}get isConnected(){return this.root?.isConnected?!0:(this._setIntervalCache||={},Object.keys(this._setIntervalCache).forEach(e=>{clearInterval(this._setIntervalCache[e])}),this.onDestroy(),this.onDestroy=()=>{},this.root&&(this.root.fez=void 0),this.root=void 0,!1)}prop(e){let t=this.oldRoot[e]||this.props[e];return typeof t=="function"&&(t=t.bind(this.root)),t}copy(){for(let e of Array.from(arguments)){let t=this.props[e];if(t!==void 0){if(e=="class"){let s=this.root.getAttribute(e,t);s&&(t=[s,t].join(" "))}(e=="style"||!this.root[e])&&(typeof t=="string"?this.root.setAttribute(e,t):this.root[e]=t)}}}onResize(e,t){let s,c=0;e();let f=()=>{if(!this.isConnected){window.removeEventListener("resize",i);return}e.call(this)},i=()=>{if(!this.isConnected){window.removeEventListener("resize",i);return}if(t){let u=Date.now();u-c>=t&&(f(),c=u)}else clearTimeout(s),s=setTimeout(f,200)};window.addEventListener("resize",i)}slot(e,t){t||=document.createElement("template");let s=t.nodeName=="SLOT";for(;e.firstChild;)s?t.parentNode.insertBefore(e.lastChild,t.nextSibling):t.appendChild(e.firstChild);return s?t.parentNode.removeChild(t):e.innerHTML="",t}setStyle(e,t){this.root.style.setProperty(e,t)}connect(){}onMount(){}beforeRender(){}afterRender(){}onDestroy(){}publish=Fez.publish;fezBlocks={};parseHtml(e){let t=this.fezHtmlRoot.replaceAll('"',"&quot;");return e=e.replace(/([^\w\.])fez\./g,`$1${t}`).replace(/>\s+</g,"><"),e.trim()}nextTick(e,t){t?(this._nextTicks||={},this._nextTicks[t]||=window.requestAnimationFrame(()=>{e.bind(this)(),this._nextTicks[t]=null},t)):window.requestAnimationFrame(e.bind(this))}render(e){if(e||=this?.class?.fezHtmlFunc,!e)return;this.beforeRender();let t=document.createElement(this.class.nodeName||"div"),s;Array.isArray(e)?e[0]instanceof Node?e.forEach(i=>t.appendChild(i)):s=e.join(""):typeof e=="string"?s=R(e)(this):typeof e=="function"&&(s=e(this)),s&&(s=s.replace(/\s\w+="undefined"/g,""),t.innerHTML=this.parseHtml(s));let c=t.querySelector("slot");c&&(this.slot(this.root,c.parentNode),c.parentNode.removeChild(c));let f=this.find(".fez-slot");if(f){let i=t.querySelector(".fez-slot");i&&i.parentNode.replaceChild(f,i)}Fez.morphdom(this.root,t),this.renderFezPostProcess(),this.afterRender()}renderFezPostProcess(){let e=(t,s)=>{this.root.querySelectorAll(`*[${t}]`).forEach(c=>{let f=c.getAttribute(t);c.removeAttribute(t),f&&s.bind(this)(f,c)})};e("fez-this",(t,s)=>{new Function("n",`this.${t} = n`).bind(this)(s)}),e("fez-use",(t,s)=>{let c=this[t];typeof c=="function"?c(s):console.error(`Fez error: "${t}" is not a function in ${this.fezName}`)}),e("fez-class",t=>{let s=t.split(/\s+/),c=s.pop();s.forEach(f=>n.classList.add(f)),c&&setTimeout(()=>{n.classList.add(c)},300)}),e("fez-bind",(t,s)=>{if(["INPUT","SELECT","TEXTAREA"].includes(s.nodeName)){let c=new Function(`return this.${t}`).bind(this)(),f=s.type.toLowerCase()=="checkbox",i=["SELECT"].includes(s.nodeName)||f?"onchange":"onkeyup";s.setAttribute(i,`${this.fezHtmlRoot}${t} = this.${f?"checked":"value"}`),this.val(s,c)}else console.error(`Cant fez-bind="${t}" to ${s.nodeName} (needs INPUT, SELECT or TEXTAREA. Want to use fez-this?).`)}),this.root.querySelectorAll("*[disabled]").forEach(t=>{let s=t.getAttribute("disabled");["false"].includes(s)?t.removeAttribute("disabled"):t.setAttribute("disabled","true")})}refresh(e){if(alert("NEEDS FIX and remove htmlTemplate"),e){let t=document.createElement("div");t.innerHTML=this.class.htmlTemplate;let s=t.querySelector(e).innerHTML;this.render(e,s)}else this.render()}setInterval(e,t,s){return typeof e=="number"&&([t,e]=[e,t]),s||=Fez.fnv1(String(e)),this._setIntervalCache||={},clearInterval(this._setIntervalCache[s]),this._setIntervalCache[s]=setInterval(()=>{this.isConnected&&e()},t),this._setIntervalCache[s]}find(e){return typeof e=="string"?this.root.querySelector(e):e}val(e,t){let s=this.find(e);if(s)if(["INPUT","TEXTAREA","SELECT"].includes(s.nodeName))if(typeof t<"u")s.type=="checkbox"?s.checked=!!t:s.value=t;else return s.value;else if(typeof t<"u")s.innerHTML=t;else return s.innerHTML}formData(e){return this.class.formData(e||this.root)}attr(e,t){return typeof t>"u"?this.root.getAttribute(e):(this.root.setAttribute(e,t),t)}childNodes(e){let t=Array.from(this.root.children);if(e){let s=document.createElement("div");s.style.display="none",document.body.appendChild(s),t.forEach(f=>s.appendChild(f));let c=Array.from(s.children).map(e);return document.body.removeChild(s),c}else return t}subscribe(e,t){Fez._subs||={},Fez._subs[e]||=[],Fez._subs[e]=Fez._subs[e].filter(s=>s[0].isConnected),Fez._subs[e].push([this,t])}nodeId(){return this._id||(this._id=Fez.id(),this.root.id=this._id),this._id}fezRegister(){this.css&&(this.css=Fez.globalCss(this.css,{name:this.fezName,wrap:!0})),this.class.css&&(this.class.css=Fez.globalCss(this.class.css,{name:this.fezName})),this.state||=this.reactiveStore(),this.fezRegisterBindMethods()}fezRegisterBindMethods(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).filter(t=>t!=="constructor"&&typeof this[t]=="function").forEach(t=>this[t]=this[t].bind(this))}fezHide(){let e=this.root,t=this.root.parentNode,s=document.createDocumentFragment();for(;e.firstChild;)s.appendChild(e.firstChild);return e.parentNode.replaceChild(s,e),this.root=t,Array.from(this.root.children)}reactiveStore(e,t){e||={},t||=(c,f,i)=>{this.nextTick(this.render,"render")},t.bind(this);function s(c,f){return typeof c!="object"||c===null?c:new Proxy(c,{set(i,u,d,b){if(Reflect.get(i,u,b)!==d){typeof d=="object"&&d!==null&&(d=s(d,f));let S=Reflect.set(i,u,d,b);return f(i,u,d),S}return!0},get(i,u,d){let b=Reflect.get(i,u,d);return typeof b=="object"&&b!==null?s(b,f):b}})}return s(e,t)}};var be={data:""},Z=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||be,ye=r=>{let e=Z(r),t=e.data;return e.data="",t},ge=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ve=/\/\*[^]*?\*\/|  +/g,J=/\n+/g,w=(r,e)=>{let t="",s="",c="";for(let f in r){let i=r[f];f[0]=="@"?f[1]=="i"?t=f+" "+i+";":s+=f[1]=="f"?w(i,f):f+"{"+w(i,f[1]=="k"?"":e)+"}":typeof i=="object"?s+=w(i,e?e.replace(/([^,])+/g,u=>f.replace(/(^:.*)|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,u):u?u+" "+d:d)):f):i!=null&&(f=/^--/.test(f)?f:f.replace(/[A-Z]/g,"-$&").toLowerCase(),c+=w.p?w.p(f,i):f+":"+i+";")}return t+(e&&c?e+"{"+c+"}":c)+s},C={},X=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+X(r[t]);return e}return r},ze=(r,e,t,s,c)=>{let f=X(r),i=C[f]||(C[f]=(d=>{let b=0,v=11;for(;b<d.length;)v=101*v+d.charCodeAt(b++)>>>0;return"go"+v})(f));if(!C[i]){let d=f!==r?r:(b=>{let v,S,E=[{}];for(;v=ge.exec(b.replace(ve,""));)v[4]?E.shift():v[3]?(S=v[3].replace(J," ").trim(),E.unshift(E[0][S]=E[0][S]||{})):E[0][v[1]]=v[2].replace(J," ").trim();return E[0]})(r);C[i]=w(c?{["@keyframes "+i]:d}:d,t?"":"."+i)}let u=t&&C.g?C.g:null;return t&&(C.g=C[i]),((d,b,v,S)=>{S?b.data=b.data.replace(S,d):b.data.indexOf(d)===-1&&(b.data=v?d+b.data:b.data+d)})(C[i],e,s,u),i},Ae=(r,e,t)=>r.reduce((s,c,f)=>{let i=e[f];if(i&&i.call){let u=i(t),d=u&&u.props&&u.props.className||/^go/.test(u)&&u;i=d?"."+d:u&&typeof u=="object"?u.props?"":w(u,""):u===!1?"":u}return s+c+(i??"")},"");function _(r){let e=this||{},t=r.call?r(e.p):r;return ze(t.unshift?t.raw?Ae(t,[].slice.call(arguments,1),e.p):t.reduce((s,c)=>Object.assign(s,c&&c.call?c(e.p):c),{}):t,Z(e.target),e.g,e.o,e.k)}var K,B,D,Se=_.bind({g:1}),Ee=_.bind({k:1});function $e(r,e,t,s){w.p=e,K=r,B=t,D=s}function Fe(r,e){let t=this||{};return function(){let s=arguments;function c(f,i){let u=Object.assign({},f),d=u.className||c.className;t.p=Object.assign({theme:B&&B()},u),t.o=/ *go\d+/.test(d),u.className=_.apply(t,s)+(d?" "+d:""),e&&(u.ref=i);let b=r;return r[0]&&(b=u.as||r,delete u.as),D&&b[0]&&D(u),K(b,u)}return e?e(c):c}}var Y={css:_,extractCss:ye,glob:Se,keyframes:Ee,setup:$e,styled:Fe};var Q=function(){"use strict";let r=new Set,e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:F,afterNodeAdded:F,beforeNodeMorphed:F,afterNodeMorphed:F,beforeNodeRemoved:F,afterNodeRemoved:F,beforeAttributeUpdated:F},head:{style:"merge",shouldPreserve:function(o){return o.getAttribute("im-preserve")==="true"},shouldReAppend:function(o){return o.getAttribute("im-re-append")==="true"},shouldRemove:F,afterHeadMorphed:F}};function t(o,l,a={}){o instanceof Document&&(o=o.documentElement),typeof l=="string"&&(l=oe(l));let h=le(l),p=ne(o,h,a);return s(o,h,p)}function s(o,l,a){if(a.head.block){let h=o.querySelector("head"),p=l.querySelector("head");if(h&&p){let m=S(p,h,a);Promise.all(m).then(function(){s(o,l,Object.assign(a,{head:{block:!1,ignore:!0}}))});return}}if(a.morphStyle==="innerHTML")return i(l,o,a),o.children;if(a.morphStyle==="outerHTML"||a.morphStyle==null){let h=fe(l,o,a),p=h?.previousSibling,m=h?.nextSibling,g=f(o,h,a);return h?ce(p,g,m):[]}else throw"Do not understand how to morph style "+a.morphStyle}function c(o,l){return l.ignoreActiveValue&&o===document.activeElement&&o!==document.body}function f(o,l,a){if(!(a.ignoreActive&&o===document.activeElement))return l==null?a.callbacks.beforeNodeRemoved(o)===!1?o:(o.remove(),a.callbacks.afterNodeRemoved(o),null):H(o,l)?(a.callbacks.beforeNodeMorphed(o,l)===!1||(o instanceof HTMLHeadElement&&a.head.ignore||(o instanceof HTMLHeadElement&&a.head.style!=="morph"?S(l,o,a):(d(l,o,a),c(o,a)||i(l,o,a))),a.callbacks.afterNodeMorphed(o,l)),o):a.callbacks.beforeNodeRemoved(o)===!1||a.callbacks.beforeNodeAdded(l)===!1?o:(o.parentElement.replaceChild(l,o),a.callbacks.afterNodeAdded(l),a.callbacks.afterNodeRemoved(o),l)}function i(o,l,a){let h=o.firstChild,p=l.firstChild,m;for(;h;){if(m=h,h=m.nextSibling,p==null){if(a.callbacks.beforeNodeAdded(m)===!1)return;l.appendChild(m),a.callbacks.afterNodeAdded(m),M(a,m);continue}if(q(m,p,a)){f(p,m,a),p=p.nextSibling,M(a,m);continue}let g=se(o,l,m,p,a);if(g){p=V(p,g,a),f(g,m,a),M(a,m);continue}let z=ie(o,l,m,p,a);if(z){p=V(p,z,a),f(z,m,a),M(a,m);continue}if(a.callbacks.beforeNodeAdded(m)===!1)return;l.insertBefore(m,p),a.callbacks.afterNodeAdded(m),M(a,m)}for(;p!==null;){let g=p;p=p.nextSibling,W(g,a)}}function u(o,l,a,h){return o==="value"&&h.ignoreActiveValue&&l===document.activeElement?!0:h.callbacks.beforeAttributeUpdated(o,l,a)===!1}function d(o,l,a){let h=o.nodeType;if(h===1){let p=o.attributes,m=l.attributes;for(let g of p)if(!u(g.name,l,"update",a))try{l.getAttribute(g.name)!==g.value&&l.setAttribute(g.name,g.value)}catch(z){console.error("Error setting attribute:",{badNode:l,badAttribute:g,error:z.message})}for(let g=m.length-1;0<=g;g--){let z=m[g];u(z.name,l,"remove",a)||o.hasAttribute(z.name)||l.removeAttribute(z.name)}}(h===8||h===3)&&l.nodeValue!==o.nodeValue&&(l.nodeValue=o.nodeValue),c(l,a)||v(o,l,a)}function b(o,l,a,h){if(o[a]!==l[a]){let p=u(a,l,"update",h);p||(l[a]=o[a]),o[a]?p||l.setAttribute(a,o[a]):u(a,l,"remove",h)||l.removeAttribute(a)}}function v(o,l,a){if(o instanceof HTMLInputElement&&l instanceof HTMLInputElement&&o.type!=="file"){let h=o.value,p=l.value;b(o,l,"checked",a),b(o,l,"disabled",a),o.hasAttribute("value")?h!==p&&(u("value",l,"update",a)||(l.setAttribute("value",h),l.value=h)):u("value",l,"remove",a)||(l.value="",l.removeAttribute("value"))}else if(o instanceof HTMLOptionElement)b(o,l,"selected",a);else if(o instanceof HTMLTextAreaElement&&l instanceof HTMLTextAreaElement){let h=o.value,p=l.value;if(u("value",l,"update",a))return;h!==p&&(l.value=h),l.firstChild&&l.firstChild.nodeValue!==h&&(l.firstChild.nodeValue=h)}}function S(o,l,a){let h=[],p=[],m=[],g=[],z=a.head.style,L=new Map;for(let A of o.children)L.set(A.outerHTML,A);for(let A of l.children){let T=L.has(A.outerHTML),j=a.head.shouldReAppend(A),k=a.head.shouldPreserve(A);T||k?j?p.push(A):(L.delete(A.outerHTML),m.push(A)):z==="append"?j&&(p.push(A),g.push(A)):a.head.shouldRemove(A)!==!1&&p.push(A)}g.push(...L.values());let G=[];for(let A of g){let T=document.createRange().createContextualFragment(A.outerHTML).firstChild;if(a.callbacks.beforeNodeAdded(T)!==!1){if(T.href||T.src){let j=null,k=new Promise(function(pe){j=pe});T.addEventListener("load",function(){j()}),G.push(k)}l.appendChild(T),a.callbacks.afterNodeAdded(T),h.push(T)}}for(let A of p)a.callbacks.beforeNodeRemoved(A)!==!1&&(l.removeChild(A),a.callbacks.afterNodeRemoved(A));return a.head.afterHeadMorphed(l,{added:h,kept:m,removed:p}),G}function E(){}function F(){}function re(o){let l={};return Object.assign(l,e),Object.assign(l,o),l.callbacks={},Object.assign(l.callbacks,e.callbacks),Object.assign(l.callbacks,o.callbacks),l.head={},Object.assign(l.head,e.head),Object.assign(l.head,o.head),l}function ne(o,l,a){return a=re(a),{target:o,newContent:l,config:a,morphStyle:a.morphStyle,ignoreActive:a.ignoreActive,ignoreActiveValue:a.ignoreActiveValue,idMap:he(o,l),deadIds:new Set,callbacks:a.callbacks,head:a.head}}function q(o,l,a){return o==null||l==null?!1:o.nodeType===l.nodeType&&o.tagName===l.tagName?o.id!==""&&o.id===l.id?!0:I(a,o,l)>0:!1}function H(o,l){return o==null||l==null?!1:o.nodeType===l.nodeType&&o.tagName===l.tagName}function V(o,l,a){for(;o!==l;){let h=o;o=o.nextSibling,W(h,a)}return M(a,l),l.nextSibling}function se(o,l,a,h,p){let m=I(p,a,l),g=null;if(m>0){let z=h,L=0;for(;z!=null;){if(q(a,z,p))return z;if(L+=I(p,z,o),L>m)return null;z=z.nextSibling}}return g}function ie(o,l,a,h,p){let m=h,g=a.nextSibling,z=0;for(;m!=null;){if(I(p,m,o)>0)return null;if(H(a,m))return m;if(H(g,m)&&(z++,g=g.nextSibling,z>=2))return null;m=m.nextSibling}return m}function oe(o){let l=new DOMParser,a=o.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(a.match(/<\/html>/)||a.match(/<\/head>/)||a.match(/<\/body>/)){let h=l.parseFromString(o,"text/html");if(a.match(/<\/html>/))return h.generatedByIdiomorph=!0,h;{let p=h.firstChild;return p?(p.generatedByIdiomorph=!0,p):null}}else{let p=l.parseFromString("<body><template>"+o+"</template></body>","text/html").body.querySelector("template").content;return p.generatedByIdiomorph=!0,p}}function le(o){if(o==null)return document.createElement("div");if(o.generatedByIdiomorph)return o;if(o instanceof Node){let l=document.createElement("div");return l.append(o),l}else{let l=document.createElement("div");for(let a of[...o])l.append(a);return l}}function ce(o,l,a){let h=[],p=[];for(;o!=null;)h.push(o),o=o.previousSibling;for(;h.length>0;){let m=h.pop();p.push(m),l.parentElement.insertBefore(m,l)}for(p.push(l);a!=null;)h.push(a),p.push(a),a=a.nextSibling;for(;h.length>0;)l.parentElement.insertBefore(h.pop(),l.nextSibling);return p}function fe(o,l,a){let h;h=o.firstChild;let p=h,m=0;for(;h;){let g=ae(h,l,a);g>m&&(p=h,m=g),h=h.nextSibling}return p}function ae(o,l,a){return H(o,l)?.5+I(a,o,l):0}function W(o,l){M(l,o),l.callbacks.beforeNodeRemoved(o)!==!1&&(o.remove(),l.callbacks.afterNodeRemoved(o))}function ue(o,l){return!o.deadIds.has(l)}function de(o,l,a){return(o.idMap.get(a)||r).has(l)}function M(o,l){let a=o.idMap.get(l)||r;for(let h of a)o.deadIds.add(h)}function I(o,l,a){let h=o.idMap.get(l)||r,p=0;for(let m of h)ue(o,m)&&de(o,m,a)&&++p;return p}function U(o,l){let a=o.parentElement,h=o.querySelectorAll("[id]");for(let p of h){let m=p;for(;m!==a&&m!=null;){let g=l.get(m);g==null&&(g=new Set,l.set(m,g)),g.add(p.id),m=m.parentElement}}}function he(o,l){let a=new Map;return U(o,a),U(l,a),a}return{morph:t,defaults:e}}();function ee(r,e){if(r.includes("-")||console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),!e.fezHtmlRoot){let t=new e,s=class extends N{};if(Object.getOwnPropertyNames(t).concat(Object.getOwnPropertyNames(e.prototype)).filter(i=>!["constructor","prototype"].includes(i)).forEach(i=>s.prototype[i]=t[i]),Fez.fastBindInfo||={fast:[],slow:[]},t.GLOBAL&&(s.fezGlobal=t.GLOBAL),t.CSS&&(s.css=t.CSS),t.HTML&&(s.html=t.HTML),t.NAME&&(s.nodeName=t.NAME),t.FAST?(s.fastBind=t.FAST,Fez.fastBindInfo.fast.push(typeof t.FAST=="function"?`${r} (func)`:r)):Fez.fastBindInfo.slow.push(r),t.GLOBAL){let i=()=>document.body.appendChild(document.createElement(r));document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()}e=s;let f=`${r} compiled`;t.FAST&&(f+=" (fast bind)"),Fez.log(f)}e.html&&(e.html=Te(e.html),e.html=e.html.replace(/<slot\s*\/>|<slot\s*>\s*<\/slot>/g,()=>{let t=e.slotNodeName||"div";return`<${t} class="fez-slot"></${t}>`}),e.fezHtmlFunc=R(e.html)),e.css&&(e.css=Fez.globalCss(e.css,{name:r})),Fez.classes[r]=e,customElements.get(r)||customElements.define(r,class extends HTMLElement{connectedCallback(){Ce(this,e)?x(r,this):window.requestAnimationFrame(()=>{this.parentNode&&x(r,this)})}})}function Te(r){let e=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]);return r.replace(/<([a-z-]+)\b([^>]*)\/>/g,(t,s,c)=>e.has(s)?t:`<${s}${c}></${s}>`)}function Ce(r,e){let t=r.getAttribute("fez-fast");var s=typeof e.fastBind=="function"?e.fastBind(r):e.fastBind;return t=="false"?!1:t||s}function x(r,e){let t=Fez.classes[r],s=e.parentNode;if(e.isConnected){let c=typeof t.nodeName=="function"?t.nodeName(e):t.nodeName,f=document.createElement(c||"div");f.classList.add("fez"),f.classList.add(`fez-${r}`),s.replaceChild(f,e);let i=new t;i.oldRoot=e,i.fezName=r,i.root=f,i.props=t.getProps(e,f),i.class=t,i.slot(e,f),f.fez=i,t.fezGlobal&&t.fezGlobal!=!0&&(window[t.fezGlobal]=i),window.$&&(i.$root=$(f)),i.props.id&&f.setAttribute("id",i.props.id),i.fezRegister(),(i.init||i.created||i.connect).bind(i)(i.props),i.UID=++Fez.instanceCount,Fez.instances[i.UID]=i;let u=i.root.cloneNode(!0);i.class.fezHtmlFunc&&i.render();let d=i.root.querySelector(".fez-slot");if(d&&(i.props.html?d.innerHTML=i.props.html:i.slot(u,d)),i.onSubmit){let b=i.root.nodeName=="FORM"?i.root:i.find("form");b.onsubmit=v=>{v.preventDefault(),i.onSubmit(i.formData())}}if(i.onMount(i.props),i.onPropsChange){we.observe(f,{attributes:!0});for(let[b,v]of Object.entries(i.props))i.onPropsChange(b,v)}}}var we=new MutationObserver((r,e)=>{for(let t of r)if(t.type==="attributes"){let s=t.target.fez,c=t.attributeName,f=t.target.getAttribute(c);s&&(s.props[c]=f,s.onPropsChange(c,f))}});var Me=r=>{let e={script:"",style:"",html:"",head:""},t=r.split(`
`),s=[],c="";for(var f of t)f=f.trim(),f.startsWith("<script")&&!e.script&&c!="head"?c="script":f.startsWith("<head")&&!e.script?c="head":f.startsWith("<style")?c="style":f.endsWith("<\/script>")&&c==="script"&&!e.script?(e.script=s.join(`
`),s=[],c=null):f.endsWith("</style>")&&c==="style"?(e.style=s.join(`
`),s=[],c=null):(f.endsWith("</head>")||f.endsWith("</header>"))&&c==="head"?(e.head=s.join(`
`),s=[],c=null):c?s.push(f):e.html+=f+`
`;if(e.head){let u=document.createElement("div");u.innerHTML=e.head,Array.from(u.children).forEach(d=>{if(d.tagName==="SCRIPT"){let b=document.createElement("script");Array.from(d.attributes).forEach(v=>{b.setAttribute(v.name,v.value)}),b.type||="text/javascript",d.src?document.head.appendChild(b):b.type.includes("javascript")&&(b.textContent=d.textContent,document.head.appendChild(b))}else document.head.appendChild(d.cloneNode(!0))})}let i=e.script;return/class\s+\{/.test(i)||(i=`class {
${i}
}`),String(e.style).includes(":")&&(e.style=e.style.includes(":fez")||/(?:^|\s)body\s*\{/.test(e.style)?e.style:`:fez {
${e.style}
}`,i=i.replace(/\}\s*$/,`
  CSS = \`${e.style}\`
}`)),/\w/.test(String(e.html))&&(e.html=e.html.replaceAll("`","&#x60;"),e.html=e.html.replaceAll("$","\\$"),i=i.replace(/\}\s*$/,`
  HTML = \`${e.html}\`
}`)),i};function te(r,e){if(r instanceof Node){let c=r;c.remove();let f=c.getAttribute("fez");if(f&&(f.includes(".")||f.includes("/"))){let i=f;Fez.log(`Loading from ${i}`),fetch(i).then(u=>{if(!u.ok)throw new Error(`Failed to load ${i}: ${u.status}`);return u.text()}).then(u=>{let v=new DOMParser().parseFromString(u,"text/html").querySelectorAll("template[fez], xmp[fez]");if(v.length>0)v.forEach(S=>{let E=S.getAttribute("fez");E&&!E.includes("-")&&!E.includes(".")&&!E.includes("/")&&console.error(`Fez: Invalid custom element name "${E}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let F=S.innerHTML;Fez.compile(E,F)});else{let S=i.split("/").pop().split(".")[0];Fez.compile(S,u)}}).catch(u=>{console.error(`FEZ template load error for "${f}": ${u.message}`)});return}else f&&!f.includes("-")&&console.error(`Fez: Invalid custom element name "${f}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),e=c.innerHTML,r=f}else if(typeof e!="string"){document.body.querySelectorAll("template[fez], xmp[fez]").forEach(c=>Fez.compile(c));return}r&&!r.includes("-")&&!r.includes(".")&&!r.includes("/")&&console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let t=Me(e),s=t.split(/class\s+\{/,2);t=`${s[0]};

window.Fez('${r}', class {
${s[1]})`;try{new Function(t)()}catch(c){console.error(`FEZ template "${r}" compile error: ${c.message}`),console.log(t)}}var y=(r,e)=>{if(typeof r=="number"){let t=y.instances[r];if(t)return t;y.error(`Instance with UID "${r}" not found.`)}else if(r)if(e)if(typeof e=="function"&&!/^\s*class/.test(e.toString())&&!/\b(this|new)\b/.test(e.toString())){let s=Array.from(document.querySelectorAll(`.fez.fez-${r}`)).filter(c=>c.fez);return s.forEach(c=>e(c.fez)),s}else return typeof e!="function"?y.find(r,e):ee(r,e);else{let t=r.nodeName?r.closest(".fez"):document.querySelector(r.includes("#")?r:`.fez.fez-${r}`);if(t){if(t.fez)return t.fez;y.error(`node "${r}" has no Fez attached.`)}else y.error(`node "${r}" not found.`)}else return FezBase};y.classes={};y.instanceCount=0;y.instances={};y.id=()=>{y._id_count||=0,y._id_count+=1;let r=Math.random().toString(36).substring(2,6);return`fez_${y._id_count}${r}`};y.find=(r,e)=>{let t=r;typeof t=="string"&&(t=document.body.querySelector(t)),typeof t.val=="function"&&(t=t[0]);let s=e?`.fez.fez-${e}`:".fez",c=t.closest(s);if(c&&c.fez)return c.fez;console.error("Fez node connector not found",r,t)};y.cssClass=r=>Y.css(r);y.globalCss=(r,e={})=>{if(typeof r=="function"&&(r=r()),r.includes(":")){let t=r.split(`
`).filter(s=>!/^\s*\/\//.test(s)).join(`
`);e.wrap&&(t=`:fez { ${t} }`),t=t.replace(/\:fez|\:host/,`.fez.fez-${e.name}`),r=y.cssClass(t)}return document.body?document.body.parentElement.classList.add(r):document.addEventListener("DOMContentLoaded",()=>{document.body.parentElement.classList.add(r)}),r};y.info=()=>{console.log(JSON.stringify(y.fastBindInfo,null,2))};y.morphdom=(r,e,t={})=>{Array.from(r.attributes).forEach(c=>{e.setAttribute(c.name,c.value)}),Q.morph(r,e,{morphStyle:"outerHTML"});let s=r.nextSibling;s?.nodeType===Node.TEXT_NODE&&s.textContent.trim()===""&&s.remove()};y.htmlEscape=r=>typeof r=="string"?(r=r.replace(/font-family\s*:\s*(?:&[^;]+;|[^;])*?;/gi,"").replaceAll("'","&apos;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;"),r):r===void 0?"":r;y.publish=(r,...e)=>{y._subs||={},y._subs[r]||=[],y._subs[r].forEach(t=>{t[1].bind(t[0])(...e)})};y.fnv1=r=>{var e,t,s,c,f,i;for(e=2166136261,t=16777619,s=e,c=f=0,i=r.length-1;0<=i?f<=i:f>=i;c=0<=i?++f:--f)s^=r.charCodeAt(c),s*=t;return s.toString(36).replaceAll("-","")};y.tag=(r,e={},t="")=>{let s=encodeURIComponent(JSON.stringify(e));return`<${r} data-props="${s}">${t}</${r}>`};y.error=(r,e)=>{if(r=`Fez: ${r}`,console.error(r),e)return`<span style="border: 1px solid red; font-size: 14px; padding: 3px 7px; background: #fee; border-radius: 4px;">${r}</span>`};y.log=r=>{y.LOG===!0&&console.log(`Fez: ${r}`)};document.addEventListener("DOMContentLoaded",()=>{y.log("Fez.LOG === true, logging enabled.")});y.untilTrue=(r,e)=>{r()||setTimeout(r,e||200)};y.head=(r,e)=>{if(typeof r!="object"||r===null)throw new Error("head requires an object parameter");let t,s={},c;if(r.script){try{new Function(r.script)(),e&&e()}catch(u){console.error("Error executing script:",u)}return}else if(r.js){t=r.js,c="script";for(let[u,d]of Object.entries(r))u!=="js"&&u!=="module"&&(s[u]=d);r.module&&(s.type="module")}else if(r.css){t=r.css,c="link",s.rel="stylesheet";for(let[u,d]of Object.entries(r))u!=="css"&&(s[u]=d)}else throw new Error('head requires either "script", "js" or "css" property');let f=document.querySelector(`${c}[src="${t}"], ${c}[href="${t}"]`);if(f)return e&&e(),f;let i=document.createElement(c);c==="link"?i.href=t:i.src=t;for(let[u,d]of Object.entries(s))i.setAttribute(u,d);return(e||r.module)&&(i.onload=()=>{r.module&&c==="script"&&import(t).then(u=>{window[r.module]=u.default||u[r.module]||u}).catch(u=>{console.error(`Error importing module ${r.module}:`,u)}),e&&e()}),document.head.appendChild(i),i};y.fetch=function(...r){y._fetchCache||={};let e="GET",t,s;typeof r[0]=="string"&&/^[A-Z]+$/.test(r[0])&&(e=r.shift()),t=r.shift();let c={},f=null;if(typeof r[0]=="object"&&(f=r.shift()),typeof r[0]=="function"&&(s=r.shift()),f){if(e==="GET"){let d=new URLSearchParams(f);t+=(t.includes("?")?"&":"?")+d.toString()}else if(e==="POST"){let d=new FormData;for(let[b,v]of Object.entries(f))d.append(b,v);c.body=d}}c.method=e;let i=`${e}:${t}:${JSON.stringify(c)}`;if(y._fetchCache[i]){let d=y._fetchCache[i];if(y.log(`fetch cache hit: ${e} ${t}`),s){s(d);return}return Promise.resolve(d)}y.log(`fetch live: ${e} ${t}`);let u=d=>d.headers.get("content-type")?.includes("application/json")?d.json():d.text();if(s){fetch(t,c).then(u).then(d=>{y._fetchCache[i]=d,s(d)}).catch(d=>y.onError("fetch",d));return}return fetch(t,c).then(u).then(d=>(y._fetchCache[i]=d,d))};y.onError=function(r,e){if(typeof r!="string")throw new Error("Fez.onError: kind must be a string");console.error(`${r}: ${e.toString()}`)};y.compile=te;var O=y;window.FezBase=N;window.Fez=O;setInterval(()=>{for(let r in O.instances)O.instances[r]?.isConnected||delete O.instances[r]},5e3);var Le=new MutationObserver(r=>{for(let{addedNodes:e}of r)e.forEach(t=>{t.nodeType===1&&t.matches("template[fez], xmp[fez], script[fez]")&&window.requestAnimationFrame(()=>{O.compile(t),t.remove()})})});Le.observe(document.documentElement,{childList:!0,subtree:!0});O("fez-component",class{init(r){let e=document.createElement(r.name);for(e.props=r.props||r["data-props"]||r;this.root.firstChild;)this.root.parentNode.insertBefore(this.root.lastChild,e.nextSibling);this.root.innerHTML="",this.root.appendChild(e)}});})();
//# sourceMappingURL=fez.js.map
