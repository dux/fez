(()=>{function B(r,e={},t){if(typeof e=="string"&&([e,t]=[t,e],e||={}),e instanceof Node&&(t=e,e={}),Array.isArray(r)&&(t=r,r="div"),(typeof e!="object"||Array.isArray(e))&&(t=e,e={}),r.includes(".")){let l=r.split(".");r=l.shift()||"div";let a=l.join(" ");e.class?e.class+=` ${a}`:e.class=a}let s=document.createElement(r);for(let[l,a]of Object.entries(e))if(typeof a=="function")s[l]=a.bind(this);else{let c=String(a).replaceAll("$$.",this.fezHtmlRoot);s.setAttribute(l,c)}if(t)if(Array.isArray(t))for(let l of t)s.appendChild(l);else t instanceof Node?s.appendChild(t):s.innerHTML=String(t);return s}function me(r,e){if(r=r.replace(/^#?raw/,"@html").replace(/^#?html/,"@html"),r.startsWith("#if")||r.startsWith("if"))return e.push(!1),r=r.replace(/^#?if/,""),`\${ ${r} ? \``;if(r.startsWith("#unless")||r.startsWith("unless"))return e.push(!1),r=r.replace(/^#?unless/,""),`\${ !(${r}) ? \``;if(r.startsWith("#block")||r.startsWith("block")){let t=r.split("block ",2),s=r.split("block:",2);return t[1]?"${(this.fezBlocks."+t[1]+" = `":"${ this.fezBlocks."+s[1]+" }"}else{if(r=="/block")return"`) && ''}";if(r.startsWith("#for")||r.startsWith("for")){r=r.replace(/^#?for/,"");let t=r.split(" in ",2);return"${"+t[1]+".map(("+t[0]+")=>`"}else if(r.startsWith("#each")||r.startsWith("each")){r=r.replace(/^#?each/,"");let t=r.split(" as ",2);return"${"+t[0]+".map(("+t[1]+")=>`"}else{if(r==":else"||r=="else")return e[e.length-1]=!0,"` : `";if(r=="/if"||r=="/unless")return e.pop()?"`}":"` : ``}";if(r=="/for"||r=="/each")return'`).join("")}';{let t="@html ";return r.startsWith(t)?r=r.replace(t,""):r=`Fez.htmlEscape(${r})`,"${"+r+"}"}}}}function H(r,e={}){let t=[];r=r.replaceAll("[[","{{").replaceAll("]]","}}"),r=r.replace(/(\w+)=\{\{\s*(.*?)\s*\}\}([\s>])/g,(l,a,c,u)=>`${a}="{{ ${c} }}"${u}`),r=r.replace(/:(\w+)="([\w\.\[\]]+)"/,(l,a,c)=>`:${a}="{{ JSON.stringify(${c}) }}"`);let s=r.replace(/{{(.*?)}}/g,(l,a)=>(a=a.replaceAll("&#x60;","`"),a=a.replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),me(a,t)));s="`"+s.trim()+"`";try{let l=`const fez = this;
      with (this) {
        return ${s}
      }
    `,a=new Function(l);return u=>{try{return a.bind(u)()}catch(m){m.message=`FEZ template runtime error: ${m.message}

Template source: ${s}`,console.error(m)}}}catch(l){l.message=`FEZ template compile error: ${l.message}Template source:
${s}`,console.error(l)}}var N=class{static getProps(e,t){let s={};if(e.props)return e.props;for(let l of e.attributes)s[l.name]=l.value;for(let[l,a]of Object.entries(s))if([":"].includes(l[0])){delete s[l];try{let c=new Function(`return (${a})`).bind(t)();s[l.replace(/[\:_]/,"")]=c}catch(c){console.error(`Fez: Error evaluating attribute ${l}="${a}" for ${e.tagName}: ${c.message}`)}}if(s["data-props"]){let l=s["data-props"];if(typeof l=="object")return l;l[0]!="{"&&(l=decodeURIComponent(l));try{s=JSON.parse(l)}catch(a){console.error(`Fez: Invalid JSON in data-props for ${e.tagName}: ${a.message}`)}}else if(s["data-json-template"]){let l=t.previousSibling?.textContent;if(l)try{s=JSON.parse(l),t.previousSibling.remove()}catch(a){console.error(`Fez: Invalid JSON in template for ${e.tagName}: ${a.message}`)}}return s}static formData(e){let t=e.closest("form")||e.querySelector("form");if(!t)return Fez.log("No form found for formData()"),{};let s=new FormData(t),l={};return s.forEach((a,c)=>{l[c]=a}),l}static fastBind(){return!1}static nodeName="div";constructor(){}n=B;get fezHtmlRoot(){return`Fez(${this.UID}).`}get isConnected(){return this.root?.isConnected?!0:(this._setIntervalCache||={},Object.keys(this._setIntervalCache).forEach(e=>{clearInterval(this._setIntervalCache[e])}),this.onDestroy(),this.onDestroy=()=>{},this.root&&(this.root.fez=void 0),this.root=void 0,!1)}prop(e){let t=this.oldRoot[e]||this.props[e];return typeof t=="function"&&(t=t.bind(this.root)),t}copy(){for(let e of Array.from(arguments)){let t=this.props[e];if(t!==void 0){if(e=="class"){let s=this.root.getAttribute(e,t);s&&(t=[s,t].join(" "))}(e=="style"||!this.root[e])&&(typeof t=="string"?this.root.setAttribute(e,t):this.root[e]=t)}}}onResize(e,t){let s,l=0;e();let a=()=>{if(!this.isConnected){window.removeEventListener("resize",c);return}e.call(this)},c=()=>{if(!this.isConnected){window.removeEventListener("resize",c);return}if(t){let u=Date.now();u-l>=t&&(a(),l=u)}else clearTimeout(s),s=setTimeout(a,200)};window.addEventListener("resize",c)}slot(e,t){t||=document.createElement("template");let s=t.nodeName=="SLOT";for(;e.firstChild;)s?t.parentNode.insertBefore(e.lastChild,t.nextSibling):t.appendChild(e.firstChild);return s?t.parentNode.removeChild(t):e.innerHTML="",t}setStyle(e,t){this.root.style.setProperty(e,t)}connect(){}onMount(){}beforeRender(){}afterRender(){}onDestroy(){}publish=Fez.publish;fezBlocks={};parseHtml(e){let t=this.fezHtmlRoot.replaceAll('"',"&quot;");return e=e.replace(/([^\w\.])fez\./g,`$1${t}`).replace(/>\s+</g,"><"),e.trim()}nextTick(e,t){t?(this._nextTicks||={},this._nextTicks[t]||=window.requestAnimationFrame(()=>{e.bind(this)(),this._nextTicks[t]=null},t)):window.requestAnimationFrame(e.bind(this))}render(e){if(e||=this?.class?.fezHtmlFunc,!e)return;this.beforeRender();let t=document.createElement(this.class.nodeName||"div"),s;Array.isArray(e)?e[0]instanceof Node?e.forEach(c=>t.appendChild(c)):s=e.join(""):typeof e=="string"?s=H(e)(this):typeof e=="function"&&(s=e(this)),s&&(s=s.replace(/\s\w+="undefined"/g,""),t.innerHTML=this.parseHtml(s));let l=t.querySelector("slot");l&&(this.slot(this.root,l.parentNode),l.parentNode.removeChild(l));let a=this.find(".fez-slot");if(a){let c=t.querySelector(".fez-slot");c&&c.parentNode.replaceChild(a,c)}Fez.morphdom(this.root,t),this.renderFezPostProcess(),this.afterRender()}renderFezPostProcess(){let e=(t,s)=>{this.root.querySelectorAll(`*[${t}]`).forEach(l=>{let a=l.getAttribute(t);l.removeAttribute(t),a&&s.bind(this)(a,l)})};e("fez-this",(t,s)=>{new Function("n",`this.${t} = n`).bind(this)(s)}),e("fez-use",(t,s)=>{let l=this[t];typeof l=="function"?l(s):console.error(`Fez error: "${t}" is not a function in ${this.fezName}`)}),e("fez-class",t=>{let s=t.split(/\s+/),l=s.pop();s.forEach(a=>n.classList.add(a)),l&&setTimeout(()=>{n.classList.add(l)},300)}),e("fez-bind",(t,s)=>{if(["INPUT","SELECT","TEXTAREA"].includes(s.nodeName)){let l=new Function(`return this.${t}`).bind(this)(),a=s.type.toLowerCase()=="checkbox",c=["SELECT"].includes(s.nodeName)||a?"onchange":"onkeyup";s.setAttribute(c,`${this.fezHtmlRoot}${t} = this.${a?"checked":"value"}`),this.val(s,l)}else console.error(`Cant fez-bind="${t}" to ${s.nodeName} (needs INPUT, SELECT or TEXTAREA. Want to use fez-this?).`)}),this.root.querySelectorAll("*[disabled]").forEach(t=>{let s=t.getAttribute("disabled");["false"].includes(s)?t.removeAttribute("disabled"):t.setAttribute("disabled","true")})}refresh(e){if(alert("NEEDS FIX and remove htmlTemplate"),e){let t=document.createElement("div");t.innerHTML=this.class.htmlTemplate;let s=t.querySelector(e).innerHTML;this.render(e,s)}else this.render()}setInterval(e,t,s){return typeof e=="number"&&([t,e]=[e,t]),s||=Fez.fnv1(String(e)),this._setIntervalCache||={},clearInterval(this._setIntervalCache[s]),this._setIntervalCache[s]=setInterval(()=>{this.isConnected&&e()},t),this._setIntervalCache[s]}find(e){return typeof e=="string"?this.root.querySelector(e):e}val(e,t){let s=this.find(e);if(s)if(["INPUT","TEXTAREA","SELECT"].includes(s.nodeName))if(typeof t<"u")s.type=="checkbox"?s.checked=!!t:s.value=t;else return s.value;else if(typeof t<"u")s.innerHTML=t;else return s.innerHTML}formData(e){return this.class.formData(e||this.root)}attr(e,t){return typeof t>"u"?this.root.getAttribute(e):(this.root.setAttribute(e,t),t)}childNodes(e){let t=document.createElement("div");t.style.display="none",document.body.appendChild(t);let s=Array.from(this.root.children);if(e===!1)return s;s.forEach(a=>t.appendChild(a));let l=Array.from(t.children);return e&&(l=l.map(e)),document.body.removeChild(t),l}subscribe(e,t){Fez._subs||={},Fez._subs[e]||=[],Fez._subs[e]=Fez._subs[e].filter(s=>s[0].isConnected),Fez._subs[e].push([this,t])}nodeId(){return this._id||(this._id=Fez.id(),this.root.id=this._id),this._id}fezRegister(){this.css&&(this.css=Fez.globalCss(this.css,{name:this.fezName,wrap:!0})),this.class.css&&(this.class.css=Fez.globalCss(this.class.css,{name:this.fezName})),this.state||=this.reactiveStore(),this.fezRegisterBindMethods()}fezRegisterBindMethods(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).filter(t=>t!=="constructor"&&typeof this[t]=="function").forEach(t=>this[t]=this[t].bind(this))}fezHide(){let e=this.root,t=this.root.parentNode,s=document.createDocumentFragment();for(;e.firstChild;)s.appendChild(e.firstChild);return e.parentNode.replaceChild(s,e),this.root=t,Array.from(this.root.children)}reactiveStore(e,t){e||={},t||=(l,a,c)=>{this.nextTick(this.render,"render")},t.bind(this);function s(l,a){return typeof l!="object"||l===null?l:new Proxy(l,{set(c,u,m,b){if(Reflect.get(c,u,b)!==m){typeof m=="object"&&m!==null&&(m=s(m,a));let S=Reflect.set(c,u,m,b);return a(c,u,m),S}return!0},get(c,u,m){let b=Reflect.get(c,u,m);return typeof b=="object"&&b!==null?s(b,a):b}})}return s(e,t)}};var be={data:""},X=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||be,ye=r=>{let e=X(r),t=e.data;return e.data="",t},ge=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ve=/\/\*[^]*?\*\/|  +/g,J=/\n+/g,w=(r,e)=>{let t="",s="",l="";for(let a in r){let c=r[a];a[0]=="@"?a[1]=="i"?t=a+" "+c+";":s+=a[1]=="f"?w(c,a):a+"{"+w(c,a[1]=="k"?"":e)+"}":typeof c=="object"?s+=w(c,e?e.replace(/([^,])+/g,u=>a.replace(/(^:.*)|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,u):u?u+" "+m:m)):a):c!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),l+=w.p?w.p(a,c):a+":"+c+";")}return t+(e&&l?e+"{"+l+"}":l)+s},C={},Z=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+Z(r[t]);return e}return r},ze=(r,e,t,s,l)=>{let a=Z(r),c=C[a]||(C[a]=(m=>{let b=0,v=11;for(;b<m.length;)v=101*v+m.charCodeAt(b++)>>>0;return"go"+v})(a));if(!C[c]){let m=a!==r?r:(b=>{let v,S,E=[{}];for(;v=ge.exec(b.replace(ve,""));)v[4]?E.shift():v[3]?(S=v[3].replace(J," ").trim(),E.unshift(E[0][S]=E[0][S]||{})):E[0][v[1]]=v[2].replace(J," ").trim();return E[0]})(r);C[c]=w(l?{["@keyframes "+c]:m}:m,t?"":"."+c)}let u=t&&C.g?C.g:null;return t&&(C.g=C[c]),((m,b,v,S)=>{S?b.data=b.data.replace(S,m):b.data.indexOf(m)===-1&&(b.data=v?m+b.data:b.data+m)})(C[c],e,s,u),c},Ae=(r,e,t)=>r.reduce((s,l,a)=>{let c=e[a];if(c&&c.call){let u=c(t),m=u&&u.props&&u.props.className||/^go/.test(u)&&u;c=m?"."+m:u&&typeof u=="object"?u.props?"":w(u,""):u===!1?"":u}return s+l+(c??"")},"");function k(r){let e=this||{},t=r.call?r(e.p):r;return ze(t.unshift?t.raw?Ae(t,[].slice.call(arguments,1),e.p):t.reduce((s,l)=>Object.assign(s,l&&l.call?l(e.p):l),{}):t,X(e.target),e.g,e.o,e.k)}var K,P,D,Se=k.bind({g:1}),Ee=k.bind({k:1});function $e(r,e,t,s){w.p=e,K=r,P=t,D=s}function Fe(r,e){let t=this||{};return function(){let s=arguments;function l(a,c){let u=Object.assign({},a),m=u.className||l.className;t.p=Object.assign({theme:P&&P()},u),t.o=/ *go\d+/.test(m),u.className=k.apply(t,s)+(m?" "+m:""),e&&(u.ref=c);let b=r;return r[0]&&(b=u.as||r,delete u.as),D&&b[0]&&D(u),K(b,u)}return e?e(l):l}}var Y={css:k,extractCss:ye,glob:Se,keyframes:Ee,setup:$e,styled:Fe};var Q=function(){"use strict";let r=new Set,e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:F,afterNodeAdded:F,beforeNodeMorphed:F,afterNodeMorphed:F,beforeNodeRemoved:F,afterNodeRemoved:F,beforeAttributeUpdated:F},head:{style:"merge",shouldPreserve:function(i){return i.getAttribute("im-preserve")==="true"},shouldReAppend:function(i){return i.getAttribute("im-re-append")==="true"},shouldRemove:F,afterHeadMorphed:F}};function t(i,o,f={}){i instanceof Document&&(i=i.documentElement),typeof o=="string"&&(o=oe(o));let d=le(o),p=ne(i,d,f);return s(i,d,p)}function s(i,o,f){if(f.head.block){let d=i.querySelector("head"),p=o.querySelector("head");if(d&&p){let h=S(p,d,f);Promise.all(h).then(function(){s(i,o,Object.assign(f,{head:{block:!1,ignore:!0}}))});return}}if(f.morphStyle==="innerHTML")return c(o,i,f),i.children;if(f.morphStyle==="outerHTML"||f.morphStyle==null){let d=fe(o,i,f),p=d?.previousSibling,h=d?.nextSibling,y=a(i,d,f);return d?ce(p,y,h):[]}else throw"Do not understand how to morph style "+f.morphStyle}function l(i,o){return o.ignoreActiveValue&&i===document.activeElement&&i!==document.body}function a(i,o,f){if(!(f.ignoreActive&&i===document.activeElement))return o==null?f.callbacks.beforeNodeRemoved(i)===!1?i:(i.remove(),f.callbacks.afterNodeRemoved(i),null):j(i,o)?(f.callbacks.beforeNodeMorphed(i,o)===!1||(i instanceof HTMLHeadElement&&f.head.ignore||(i instanceof HTMLHeadElement&&f.head.style!=="morph"?S(o,i,f):(m(o,i,f),l(i,f)||c(o,i,f))),f.callbacks.afterNodeMorphed(i,o)),i):f.callbacks.beforeNodeRemoved(i)===!1||f.callbacks.beforeNodeAdded(o)===!1?i:(i.parentElement.replaceChild(o,i),f.callbacks.afterNodeAdded(o),f.callbacks.afterNodeRemoved(i),o)}function c(i,o,f){let d=i.firstChild,p=o.firstChild,h;for(;d;){if(h=d,d=h.nextSibling,p==null){if(f.callbacks.beforeNodeAdded(h)===!1)return;o.appendChild(h),f.callbacks.afterNodeAdded(h),M(f,h);continue}if(q(h,p,f)){a(p,h,f),p=p.nextSibling,M(f,h);continue}let y=se(i,o,h,p,f);if(y){p=V(p,y,f),a(y,h,f),M(f,h);continue}let z=ie(i,o,h,p,f);if(z){p=V(p,z,f),a(z,h,f),M(f,h);continue}if(f.callbacks.beforeNodeAdded(h)===!1)return;o.insertBefore(h,p),f.callbacks.afterNodeAdded(h),M(f,h)}for(;p!==null;){let y=p;p=p.nextSibling,W(y,f)}}function u(i,o,f,d){return i==="value"&&d.ignoreActiveValue&&o===document.activeElement?!0:d.callbacks.beforeAttributeUpdated(i,o,f)===!1}function m(i,o,f){let d=i.nodeType;if(d===1){let p=i.attributes,h=o.attributes;for(let y of p)if(!u(y.name,o,"update",f))try{o.getAttribute(y.name)!==y.value&&o.setAttribute(y.name,y.value)}catch(z){console.error("Error setting attribute:",{badNode:o,badAttribute:y,error:z.message})}for(let y=h.length-1;0<=y;y--){let z=h[y];u(z.name,o,"remove",f)||i.hasAttribute(z.name)||o.removeAttribute(z.name)}}(d===8||d===3)&&o.nodeValue!==i.nodeValue&&(o.nodeValue=i.nodeValue),l(o,f)||v(i,o,f)}function b(i,o,f,d){if(i[f]!==o[f]){let p=u(f,o,"update",d);p||(o[f]=i[f]),i[f]?p||o.setAttribute(f,i[f]):u(f,o,"remove",d)||o.removeAttribute(f)}}function v(i,o,f){if(i instanceof HTMLInputElement&&o instanceof HTMLInputElement&&i.type!=="file"){let d=i.value,p=o.value;b(i,o,"checked",f),b(i,o,"disabled",f),i.hasAttribute("value")?d!==p&&(u("value",o,"update",f)||(o.setAttribute("value",d),o.value=d)):u("value",o,"remove",f)||(o.value="",o.removeAttribute("value"))}else if(i instanceof HTMLOptionElement)b(i,o,"selected",f);else if(i instanceof HTMLTextAreaElement&&o instanceof HTMLTextAreaElement){let d=i.value,p=o.value;if(u("value",o,"update",f))return;d!==p&&(o.value=d),o.firstChild&&o.firstChild.nodeValue!==d&&(o.firstChild.nodeValue=d)}}function S(i,o,f){let d=[],p=[],h=[],y=[],z=f.head.style,L=new Map;for(let A of i.children)L.set(A.outerHTML,A);for(let A of o.children){let T=L.has(A.outerHTML),R=f.head.shouldReAppend(A),_=f.head.shouldPreserve(A);T||_?R?p.push(A):(L.delete(A.outerHTML),h.push(A)):z==="append"?R&&(p.push(A),y.push(A)):f.head.shouldRemove(A)!==!1&&p.push(A)}y.push(...L.values());let G=[];for(let A of y){let T=document.createRange().createContextualFragment(A.outerHTML).firstChild;if(f.callbacks.beforeNodeAdded(T)!==!1){if(T.href||T.src){let R=null,_=new Promise(function(he){R=he});T.addEventListener("load",function(){R()}),G.push(_)}o.appendChild(T),f.callbacks.afterNodeAdded(T),d.push(T)}}for(let A of p)f.callbacks.beforeNodeRemoved(A)!==!1&&(o.removeChild(A),f.callbacks.afterNodeRemoved(A));return f.head.afterHeadMorphed(o,{added:d,kept:h,removed:p}),G}function E(){}function F(){}function re(i){let o={};return Object.assign(o,e),Object.assign(o,i),o.callbacks={},Object.assign(o.callbacks,e.callbacks),Object.assign(o.callbacks,i.callbacks),o.head={},Object.assign(o.head,e.head),Object.assign(o.head,i.head),o}function ne(i,o,f){return f=re(f),{target:i,newContent:o,config:f,morphStyle:f.morphStyle,ignoreActive:f.ignoreActive,ignoreActiveValue:f.ignoreActiveValue,idMap:pe(i,o),deadIds:new Set,callbacks:f.callbacks,head:f.head}}function q(i,o,f){return i==null||o==null?!1:i.nodeType===o.nodeType&&i.tagName===o.tagName?i.id!==""&&i.id===o.id?!0:O(f,i,o)>0:!1}function j(i,o){return i==null||o==null?!1:i.nodeType===o.nodeType&&i.tagName===o.tagName}function V(i,o,f){for(;i!==o;){let d=i;i=i.nextSibling,W(d,f)}return M(f,o),o.nextSibling}function se(i,o,f,d,p){let h=O(p,f,o),y=null;if(h>0){let z=d,L=0;for(;z!=null;){if(q(f,z,p))return z;if(L+=O(p,z,i),L>h)return null;z=z.nextSibling}}return y}function ie(i,o,f,d,p){let h=d,y=f.nextSibling,z=0;for(;h!=null;){if(O(p,h,i)>0)return null;if(j(f,h))return h;if(j(y,h)&&(z++,y=y.nextSibling,z>=2))return null;h=h.nextSibling}return h}function oe(i){let o=new DOMParser,f=i.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(f.match(/<\/html>/)||f.match(/<\/head>/)||f.match(/<\/body>/)){let d=o.parseFromString(i,"text/html");if(f.match(/<\/html>/))return d.generatedByIdiomorph=!0,d;{let p=d.firstChild;return p?(p.generatedByIdiomorph=!0,p):null}}else{let p=o.parseFromString("<body><template>"+i+"</template></body>","text/html").body.querySelector("template").content;return p.generatedByIdiomorph=!0,p}}function le(i){if(i==null)return document.createElement("div");if(i.generatedByIdiomorph)return i;if(i instanceof Node){let o=document.createElement("div");return o.append(i),o}else{let o=document.createElement("div");for(let f of[...i])o.append(f);return o}}function ce(i,o,f){let d=[],p=[];for(;i!=null;)d.push(i),i=i.previousSibling;for(;d.length>0;){let h=d.pop();p.push(h),o.parentElement.insertBefore(h,o)}for(p.push(o);f!=null;)d.push(f),p.push(f),f=f.nextSibling;for(;d.length>0;)o.parentElement.insertBefore(d.pop(),o.nextSibling);return p}function fe(i,o,f){let d;d=i.firstChild;let p=d,h=0;for(;d;){let y=ae(d,o,f);y>h&&(p=d,h=y),d=d.nextSibling}return p}function ae(i,o,f){return j(i,o)?.5+O(f,i,o):0}function W(i,o){M(o,i),o.callbacks.beforeNodeRemoved(i)!==!1&&(i.remove(),o.callbacks.afterNodeRemoved(i))}function ue(i,o){return!i.deadIds.has(o)}function de(i,o,f){return(i.idMap.get(f)||r).has(o)}function M(i,o){let f=i.idMap.get(o)||r;for(let d of f)i.deadIds.add(d)}function O(i,o,f){let d=i.idMap.get(o)||r,p=0;for(let h of d)ue(i,h)&&de(i,h,f)&&++p;return p}function U(i,o){let f=i.parentElement,d=i.querySelectorAll("[id]");for(let p of d){let h=p;for(;h!==f&&h!=null;){let y=o.get(h);y==null&&(y=new Set,o.set(h,y)),y.add(p.id),h=h.parentElement}}}function pe(i,o){let f=new Map;return U(i,f),U(o,f),f}return{morph:t,defaults:e}}();function ee(r,e){if(r.includes("-")||console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),!e.fezHtmlRoot){let t=new e,s=class extends N{};if(Object.getOwnPropertyNames(t).concat(Object.getOwnPropertyNames(e.prototype)).filter(c=>!["constructor","prototype"].includes(c)).forEach(c=>s.prototype[c]=t[c]),Fez.fastBindInfo||={fast:[],slow:[]},t.GLOBAL&&(s.fezGlobal=t.GLOBAL),t.CSS&&(s.css=t.CSS),t.HTML&&(s.html=t.HTML),t.NAME&&(s.nodeName=t.NAME),t.FAST?(s.fastBind=t.FAST,Fez.fastBindInfo.fast.push(typeof t.FAST=="function"?`${r} (func)`:r)):Fez.fastBindInfo.slow.push(r),t.GLOBAL){let c=()=>document.body.appendChild(document.createElement(r));document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c()}e=s;let a=`${r} compiled`;t.FAST&&(a+=" (fast bind)"),Fez.log(a)}e.html&&(e.html=Te(e.html),e.html=e.html.replace(/<slot\s*\/>|<slot\s*>\s*<\/slot>/g,()=>{let t=e.slotNodeName||"div";return`<${t} class="fez-slot"></${t}>`}),e.fezHtmlFunc=H(e.html)),e.css&&(e.css=Fez.globalCss(e.css,{name:r})),Fez.classes[r]=e,customElements.get(r)||customElements.define(r,class extends HTMLElement{connectedCallback(){Ce(this,e)?x(r,this):window.requestAnimationFrame(()=>{this.parentNode&&x(r,this)})}})}function Te(r){let e=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]);return r.replace(/<([a-z-]+)\b([^>]*)\/>/g,(t,s,l)=>e.has(s)?t:`<${s}${l}></${s}>`)}function Ce(r,e){let t=r.getAttribute("fez-fast");var s=typeof e.fastBind=="function"?e.fastBind(r):e.fastBind;return t=="false"?!1:t||s}function x(r,e){let t=Fez.classes[r],s=e.parentNode;if(e.isConnected){let l=typeof t.nodeName=="function"?t.nodeName(e):t.nodeName,a=document.createElement(l||"div");a.classList.add("fez"),a.classList.add(`fez-${r}`),s.replaceChild(a,e);let c=new t;c.oldRoot=e,c.fezName=r,c.root=a,c.props=t.getProps(e,a),c.class=t,c.slot(e,a),a.fez=c,t.fezGlobal&&(window[t.fezGlobal]=c),window.$&&(c.$root=$(a)),c.props.id&&a.setAttribute("id",c.props.id),c.fezRegister(),(c.init||c.created||c.connect).bind(c)(c.props),c.UID=++Fez.instanceCount,Fez.instances[c.UID]=c;let u=c.root.cloneNode(!0);c.class.fezHtmlFunc&&c.render();let m=c.root.querySelector(".fez-slot");if(m&&(c.props.html?m.innerHTML=c.props.html:c.slot(u,m)),c.onSubmit){let b=c.root.nodeName=="FORM"?c.root:c.find("form");b.onsubmit=v=>{v.preventDefault(),c.onSubmit(c.formData())}}if(c.onMount(c.props),c.onPropsChange){we.observe(a,{attributes:!0});for(let[b,v]of Object.entries(c.props))c.onPropsChange(b,v)}}}var we=new MutationObserver((r,e)=>{for(let t of r)if(t.type==="attributes"){let s=t.target.fez,l=t.attributeName,a=t.target.getAttribute(l);s&&(s.props[l]=a,s.onPropsChange(l,a))}});var Me=r=>{let e={script:"",style:"",html:"",head:""},t=r.split(`
`),s=[],l="";for(var a of t)a=a.trim(),a.startsWith("<script")&&!e.script&&l!="head"?l="script":a.startsWith("<head")&&!e.script?l="head":a.startsWith("<style")?l="style":a.endsWith("<\/script>")&&l==="script"&&!e.script?(e.script=s.join(`
`),s=[],l=null):a.endsWith("</style>")&&l==="style"?(e.style=s.join(`
`),s=[],l=null):(a.endsWith("</head>")||a.endsWith("</header>"))&&l==="head"?(e.head=s.join(`
`),s=[],l=null):l?s.push(a):e.html+=a+`
`;if(e.head){let u=document.createElement("div");u.innerHTML=e.head,Array.from(u.children).forEach(m=>{if(m.tagName==="SCRIPT"){let b=document.createElement("script");Array.from(m.attributes).forEach(v=>{b.setAttribute(v.name,v.value)}),b.type||="text/javascript",m.src?document.head.appendChild(b):b.type.includes("javascript")&&(b.textContent=m.textContent,document.head.appendChild(b))}else document.head.appendChild(m.cloneNode(!0))})}let c=e.script;return/class\s+\{/.test(c)||(c=`class {
${c}
}`),String(e.style).includes(":")&&(e.style=e.style.includes(":fez")||/(?:^|\s)body\s*\{/.test(e.style)?e.style:`:fez {
${e.style}
}`,c=c.replace(/\}\s*$/,`
  CSS = \`${e.style}\`
}`)),/\w/.test(String(e.html))&&(e.html=e.html.replaceAll("`","&#x60;"),e.html=e.html.replaceAll("$","\\$"),c=c.replace(/\}\s*$/,`
  HTML = \`${e.html}\`
}`)),c};function te(r,e){if(r instanceof Node){let l=r;l.remove();let a=l.getAttribute("fez");if(a&&(a.includes(".")||a.includes("/"))){let c=a;Fez.log(`Loading from ${c}`),fetch(c).then(u=>{if(!u.ok)throw new Error(`Failed to load ${c}: ${u.status}`);return u.text()}).then(u=>{let v=new DOMParser().parseFromString(u,"text/html").querySelectorAll("template[fez], xmp[fez]");if(v.length>0)v.forEach(S=>{let E=S.getAttribute("fez");E&&!E.includes("-")&&!E.includes(".")&&!E.includes("/")&&console.error(`Fez: Invalid custom element name "${E}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let F=S.innerHTML;Fez.compile(E,F)});else{let S=c.split("/").pop().split(".")[0];Fez.compile(S,u)}}).catch(u=>{console.error(`FEZ template load error for "${a}": ${u.message}`)});return}else a&&!a.includes("-")&&console.error(`Fez: Invalid custom element name "${a}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),e=l.innerHTML,r=a}else if(typeof e!="string"){document.body.querySelectorAll("template[fez], xmp[fez]").forEach(l=>Fez.compile(l));return}r&&!r.includes("-")&&!r.includes(".")&&!r.includes("/")&&console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let t=Me(e),s=t.split(/class\s+\{/,2);t=`${s[0]};

window.Fez('${r}', class {
${s[1]})`;try{new Function(t)()}catch(l){console.error(`FEZ template "${r}" compile error: ${l.message}`),console.log(t)}}var g=(r,e)=>{if(typeof r=="number"){let t=g.instances[r];if(t)return t;g.error(`Instance with UID "${r}" not found.`)}else if(r)if(e)if(typeof e=="function"&&!/^\s*class/.test(e.toString())&&!/\b(this|new)\b/.test(e.toString())){let s=Array.from(document.querySelectorAll(`.fez.fez-${r}`)).filter(l=>l.fez);return s.forEach(l=>e(l.fez)),s}else return typeof e!="function"?g.find(r,e):ee(r,e);else{let t=r.nodeName?r.closest(".fez"):document.querySelector(r.includes("#")?r:`.fez.fez-${r}`);if(t){if(t.fez)return t.fez;g.error(`node "${r}" has no Fez attached.`)}else g.error(`node "${r}" not found.`)}else return FezBase};g.classes={};g.instanceCount=0;g.instances={};g.id=()=>{g._id_count||=0,g._id_count+=1;let r=Math.random().toString(36).substring(2,6);return`fez_${g._id_count}${r}`};g.find=(r,e)=>{let t=r;typeof t=="string"&&(t=document.body.querySelector(t)),typeof t.val=="function"&&(t=t[0]);let s=e?`.fez.fez-${e}`:".fez",l=t.closest(s);if(l&&l.fez)return l.fez;console.error("Fez node connector not found",r,t)};g.cssClass=r=>Y.css(r);g.globalCss=(r,e={})=>{if(typeof r=="function"&&(r=r()),r.includes(":")){let t=r.split(`
`).filter(s=>!/^\s*\/\//.test(s)).join(`
`);e.wrap&&(t=`:fez { ${t} }`),t=t.replace(/\:fez|\:host/,`.fez.fez-${e.name}`),r=g.cssClass(t)}return document.body?document.body.parentElement.classList.add(r):document.addEventListener("DOMContentLoaded",()=>{document.body.parentElement.classList.add(r)}),r};g.info=()=>{console.log(JSON.stringify(g.fastBindInfo,null,2))};g.morphdom=(r,e,t={})=>{Array.from(r.attributes).forEach(l=>{e.setAttribute(l.name,l.value)}),Q.morph(r,e,{morphStyle:"outerHTML"});let s=r.nextSibling;s?.nodeType===Node.TEXT_NODE&&s.textContent.trim()===""&&s.remove()};g.htmlEscape=r=>typeof r=="string"?(r=r.replace(/font-family\s*:\s*(?:&[^;]+;|[^;])*?;/gi,"").replaceAll("'","&apos;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;"),r):r===void 0?"":r;g.publish=(r,...e)=>{g._subs||={},g._subs[r]||=[],g._subs[r].forEach(t=>{t[1].bind(t[0])(...e)})};g.fnv1=r=>{var e,t,s,l,a,c;for(e=2166136261,t=16777619,s=e,l=a=0,c=r.length-1;0<=c?a<=c:a>=c;l=0<=c?++a:--a)s^=r.charCodeAt(l),s*=t;return s.toString(36).replaceAll("-","")};g.tag=(r,e={},t="")=>{let s=encodeURIComponent(JSON.stringify(e));return`<${r} data-props="${s}">${t}</${r}>`};g.error=r=>{console.error(`Fez ERROR: ${r}`)};g.log=r=>{g.LOG===!0&&console.log(`Fez: ${r}`)};document.addEventListener("DOMContentLoaded",()=>{g.log("Fez.LOG === true, logging enabled.")});g.untilTrue=(r,e)=>{r()||setTimeout(r,e||200)};g.head=(r,e)=>{if(typeof r!="object"||r===null)throw new Error("head requires an object parameter");let t,s={},l;if(r.script){try{new Function(r.script)(),e&&e()}catch(u){console.error("Error executing script:",u)}return}else if(r.js){t=r.js,l="script";for(let[u,m]of Object.entries(r))u!=="js"&&u!=="module"&&(s[u]=m);r.module&&(s.type="module")}else if(r.css){t=r.css,l="link",s.rel="stylesheet";for(let[u,m]of Object.entries(r))u!=="css"&&(s[u]=m)}else throw new Error('head requires either "script", "js" or "css" property');let a=document.querySelector(`${l}[src="${t}"], ${l}[href="${t}"]`);if(a)return e&&e(),a;let c=document.createElement(l);l==="link"?c.href=t:c.src=t;for(let[u,m]of Object.entries(s))c.setAttribute(u,m);return(e||r.module)&&(c.onload=()=>{r.module&&l==="script"&&import(t).then(u=>{window[r.module]=u.default||u[r.module]||u}).catch(u=>{console.error(`Error importing module ${r.module}:`,u)}),e&&e()}),document.head.appendChild(c),c};g.compile=te;var I=g;window.FezBase=N;window.Fez=I;setInterval(()=>{for(let r in I.instances)I.instances[r]?.isConnected||delete I.instances[r]},5e3);var Le=new MutationObserver(r=>{for(let{addedNodes:e}of r)e.forEach(t=>{t.nodeType===1&&t.matches("template[fez], xmp[fez], script[fez]")&&window.requestAnimationFrame(()=>{I.compile(t),t.remove()})})});Le.observe(document.documentElement,{childList:!0,subtree:!0});I("fez-component",class{init(r){let e=document.createElement(r.name);for(e.props=r.props||r["data-props"]||r;this.root.firstChild;)this.root.parentNode.insertBefore(this.root.lastChild,e.nextSibling);this.root.innerHTML="",this.root.appendChild(e)}});})();
//# sourceMappingURL=fez.js.map
