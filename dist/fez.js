(()=>{function k(r,e={},t){if(typeof e=="string"&&([e,t]=[t,e],e||={}),e instanceof Node&&(t=e,e={}),Array.isArray(r)&&(t=r,r="div"),(typeof e!="object"||Array.isArray(e))&&(t=e,e={}),r.includes(".")){let s=r.split(".");r=s.shift()||"div";let f=s.join(" ");e.class?e.class+=` ${f}`:e.class=f}let n=document.createElement(r);for(let[s,f]of Object.entries(e))if(typeof f=="function")n[s]=f.bind(this);else{let i=String(f).replaceAll("$$.",this.fezHtmlRoot);n.setAttribute(s,i)}if(t)if(Array.isArray(t))for(let s of t)n.appendChild(s);else t instanceof Node?n.appendChild(t):n.innerHTML=String(t);return n}function pe(r,e){if(r=r.replace(/^#?raw/,"@html").replace(/^#?html/,"@html"),r.startsWith("#if")||r.startsWith("if"))return e.push(!1),r=r.replace(/^#?if/,""),`\${ ${r} ? \``;if(r.startsWith("#unless")||r.startsWith("unless"))return e.push(!1),r=r.replace(/^#?unless/,""),`\${ !(${r}) ? \``;if(r=="/block")return"`) && ''}";if(r.startsWith("#for")||r.startsWith("for")){r=r.replace(/^#?for/,"");let t=r.split(" in ",2);return"${"+t[1]+".map(("+t[0]+")=>`"}else if(r.startsWith("#each")||r.startsWith("each")){r=r.replace(/^#?each/,"");let t=r.split(" as ",2);return"${"+t[0]+".map(("+t[1]+")=>`"}else{if(r==":else"||r=="else")return e[e.length-1]=!0,"` : `";if(r=="/if"||r=="/unless")return e.pop()?"`}":"` : ``}";if(r=="/for"||r=="/each")return'`).join("")}';{let t="@html ";return r.startsWith(t)?r=r.replace(t,""):r=`Fez.htmlEscape(${r})`,"${"+r+"}"}}}function j(r,e={}){let t=[];r=r.replaceAll("[[","{{").replaceAll("]]","}}"),r=r.replace(/(\w+)=\{\{\s*(.*?)\s*\}\}([\s>])/g,(f,i,a,u)=>`${i}="{{ ${a} }}"${u}`);let n={};r=r.replace(/\{\{block\s+(\w+)\s*\}\}([^ยง]+)\{\{\/block\}\}/g,(f,i,a)=>(n[i]=a,"")),r=r.replace(/\{\{block:([\w\-]+)\s*\}\}/g,(f,i)=>n[i]||`block:${i}?`),r=r.replace(/:(\w+)="([\w\.\[\]]+)"/,(f,i,a)=>`:${i}="{{ JSON.stringify(${a}) }}"`);let s=r.replace(/{{(.*?)}}/g,(f,i)=>(i=i.replaceAll("&#x60;","`"),i=i.replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),pe(i,t)));s="`"+s.trim()+"`";try{let f=`const fez = this;
      with (this) {
        return ${s}
      }
    `,i=new Function(f);return u=>{try{return i.bind(u)()}catch(b){b.message=`FEZ template runtime error: ${b.message}

Template source: ${s}`,console.error(b)}}}catch(f){return f.message=`FEZ template compile error: ${f.message}Template source:
${s}`,console.error(f),()=>Fez.error("Template Compile Error",!0)}}var L=class{static getProps(e,t){let n={};if(e.props)return e.props;for(let s of e.attributes)n[s.name]=s.value;for(let[s,f]of Object.entries(n))if([":"].includes(s[0])){delete n[s];try{let i=new Function(`return (${f})`).bind(t)();n[s.replace(/[\:_]/,"")]=i}catch(i){console.error(`Fez: Error evaluating attribute ${s}="${f}" for ${e.tagName}: ${i.message}`)}}if(n["data-props"]){let s=n["data-props"];if(typeof s=="object")return s;s[0]!="{"&&(s=decodeURIComponent(s));try{n=JSON.parse(s)}catch(f){console.error(`Fez: Invalid JSON in data-props for ${e.tagName}: ${f.message}`)}}else if(n["data-json-template"]){let s=t.previousSibling?.textContent;if(s)try{n=JSON.parse(s),t.previousSibling.remove()}catch(f){console.error(`Fez: Invalid JSON in template for ${e.tagName}: ${f.message}`)}}return n}static formData(e){let t=e.closest("form")||e.querySelector("form");if(!t)return Fez.log("No form found for formData()"),{};let n=new FormData(t),s={};return n.forEach((f,i)=>{s[i]=f}),s}static fastBind(){return!1}static nodeName="div";constructor(){}n=k;get fezHtmlRoot(){return`Fez(${this.UID}).`}get isConnected(){return this.root?.isConnected?!0:(this._setIntervalCache||={},Object.keys(this._setIntervalCache).forEach(e=>{clearInterval(this._setIntervalCache[e])}),this.onDestroy(),this.onDestroy=()=>{},this.root&&(this.root.fez=void 0),this.root=void 0,!1)}prop(e){let t=this.oldRoot[e]||this.props[e];return typeof t=="function"&&(t=t.bind(this.root)),t}copy(){for(let e of Array.from(arguments)){let t=this.props[e];if(t!==void 0){if(e=="class"){let n=this.root.getAttribute(e,t);n&&(t=[n,t].join(" "))}(e=="style"||!this.root[e])&&(typeof t=="string"?this.root.setAttribute(e,t):this.root[e]=t)}}}onResize(e,t){let n,s=0;e();let f=()=>{if(!this.isConnected){window.removeEventListener("resize",i);return}e.call(this)},i=()=>{if(!this.isConnected){window.removeEventListener("resize",i);return}if(t){let a=Date.now();a-s>=t&&(f(),s=a)}else clearTimeout(n),n=setTimeout(f,200)};window.addEventListener("resize",i)}slot(e,t){t||=document.createElement("template");let n=t.nodeName=="SLOT";for(;e.firstChild;)n?t.parentNode.insertBefore(e.lastChild,t.nextSibling):t.appendChild(e.firstChild);return n?t.parentNode.removeChild(t):e.innerHTML="",t}setStyle(e,t){this.root.style.setProperty(e,t)}connect(){}onMount(){}beforeRender(){}afterRender(){}onDestroy(){}publish=Fez.publish;fezBlocks={};parseHtml(e){let t=this.fezHtmlRoot.replaceAll('"',"&quot;");return e=e.replace(/([^\w\.])fez\./g,`$1${t}`).replace(/>\s+</g,"><"),e.trim()}nextTick(e,t){t?(this._nextTicks||={},this._nextTicks[t]||=window.requestAnimationFrame(()=>{e.bind(this)(),this._nextTicks[t]=null},t)):window.requestAnimationFrame(e.bind(this))}render(e){if(e||=this?.class?.fezHtmlFunc,!e)return;this.beforeRender();let t=document.createElement(this.class.nodeName||"div"),n;Array.isArray(e)?e[0]instanceof Node?e.forEach(i=>t.appendChild(i)):n=e.join(""):typeof e=="string"?n=j(e)(this):typeof e=="function"&&(n=e(this)),n&&(n=n.replace(/\s\w+="undefined"/g,""),t.innerHTML=this.parseHtml(n));let s=t.querySelector("slot");s&&(this.slot(this.root,s.parentNode),s.parentNode.removeChild(s));let f=this.find(".fez-slot");if(f){let i=t.querySelector(".fez-slot");i&&i.parentNode.replaceChild(f,i)}Fez.morphdom(this.root,t),this.renderFezPostProcess(),this.afterRender()}renderFezPostProcess(){let e=(t,n)=>{this.root.querySelectorAll(`*[${t}]`).forEach(s=>{let f=s.getAttribute(t);s.removeAttribute(t),f&&n.bind(this)(f,s)})};e("fez-this",(t,n)=>{new Function("n",`this.${t} = n`).bind(this)(n)}),e("fez-use",(t,n)=>{let s=this[t];typeof s=="function"?s(n):console.error(`Fez error: "${t}" is not a function in ${this.fezName}`)}),e("fez-class",(t,n)=>{let s=t.split(/\s+/),f=s.pop();s.forEach(i=>n.classList.add(i)),f&&setTimeout(()=>{n.classList.add(f)},300)}),e("fez-bind",(t,n)=>{if(["INPUT","SELECT","TEXTAREA"].includes(n.nodeName)){let s=new Function(`return this.${t}`).bind(this)(),f=n.type.toLowerCase()=="checkbox",i=["SELECT"].includes(n.nodeName)||f?"onchange":"onkeyup";n.setAttribute(i,`${this.fezHtmlRoot}${t} = this.${f?"checked":"value"}`),this.val(n,s)}else console.error(`Cant fez-bind="${t}" to ${n.nodeName} (needs INPUT, SELECT or TEXTAREA. Want to use fez-this?).`)}),this.root.querySelectorAll("*[disabled]").forEach(t=>{let n=t.getAttribute("disabled");["false"].includes(n)?t.removeAttribute("disabled"):t.setAttribute("disabled","true")})}refresh(e){if(alert("NEEDS FIX and remove htmlTemplate"),e){let t=document.createElement("div");t.innerHTML=this.class.htmlTemplate;let n=t.querySelector(e).innerHTML;this.render(e,n)}else this.render()}setInterval(e,t,n){return typeof e=="number"&&([t,e]=[e,t]),n||=Fez.fnv1(String(e)),this._setIntervalCache||={},clearInterval(this._setIntervalCache[n]),this._setIntervalCache[n]=setInterval(()=>{this.isConnected&&e()},t),this._setIntervalCache[n]}find(e){return typeof e=="string"?this.root.querySelector(e):e}val(e,t){let n=this.find(e);if(n)if(["INPUT","TEXTAREA","SELECT"].includes(n.nodeName))if(typeof t<"u")n.type=="checkbox"?n.checked=!!t:n.value=t;else return n.value;else if(typeof t<"u")n.innerHTML=t;else return n.innerHTML}formData(e){return this.class.formData(e||this.root)}attr(e,t){return typeof t>"u"?this.root.getAttribute(e):(this.root.setAttribute(e,t),t)}childNodes(e){let t=Array.from(this.root.children);if(e){let n=document.createElement("div");n.style.display="none",document.body.appendChild(n),t.forEach(f=>n.appendChild(f));let s=Array.from(n.children).map(e);return document.body.removeChild(n),s}else return t}subscribe(e,t){Fez._subs||={},Fez._subs[e]||=[],Fez._subs[e]=Fez._subs[e].filter(n=>n[0].isConnected),Fez._subs[e].push([this,t])}nodeId(){return this._id||(this._id=Fez.id(),this.root.id=this._id),this._id}fezRegister(){this.css&&(this.css=Fez.globalCss(this.css,{name:this.fezName,wrap:!0})),this.class.css&&(this.class.css=Fez.globalCss(this.class.css,{name:this.fezName})),this.state||=this.reactiveStore(),this.fezRegisterBindMethods()}fezRegisterBindMethods(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).filter(t=>t!=="constructor"&&typeof this[t]=="function").forEach(t=>this[t]=this[t].bind(this))}fezHide(){let e=this.root,t=this.root.parentNode,n=document.createDocumentFragment();for(;e.firstChild;)n.appendChild(e.firstChild);return e.parentNode.replaceChild(n,e),this.root=t,Array.from(this.root.children)}reactiveStore(e,t){e||={},t||=(s,f,i)=>{this.nextTick(this.render,"render")},t.bind(this);function n(s,f){return typeof s!="object"||s===null?s:new Proxy(s,{set(i,a,u,b){if(Reflect.get(i,a,b)!==u){typeof u=="object"&&u!==null&&(u=n(u,f));let A=Reflect.set(i,a,u,b);return f(i,a,u),A}return!0},get(i,a,u){let b=Reflect.get(i,a,u);return typeof b=="object"&&b!==null?n(b,f):b}})}return n(e,t)}};var me={data:""},J=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||me,be=r=>{let e=J(r),t=e.data;return e.data="",t},ye=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ge=/\/\*[^]*?\*\/|  +/g,G=/\n+/g,C=(r,e)=>{let t="",n="",s="";for(let f in r){let i=r[f];f[0]=="@"?f[1]=="i"?t=f+" "+i+";":n+=f[1]=="f"?C(i,f):f+"{"+C(i,f[1]=="k"?"":e)+"}":typeof i=="object"?n+=C(i,e?e.replace(/([^,])+/g,a=>f.replace(/(^:.*)|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,a):a?a+" "+u:u)):f):i!=null&&(f=/^--/.test(f)?f:f.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=C.p?C.p(f,i):f+":"+i+";")}return t+(e&&s?e+"{"+s+"}":s)+n},T={},Z=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+Z(r[t]);return e}return r},ve=(r,e,t,n,s)=>{let f=Z(r),i=T[f]||(T[f]=(u=>{let b=0,g=11;for(;b<u.length;)g=101*g+u.charCodeAt(b++)>>>0;return"go"+g})(f));if(!T[i]){let u=f!==r?r:(b=>{let g,A,S=[{}];for(;g=ye.exec(b.replace(ge,""));)g[4]?S.shift():g[3]?(A=g[3].replace(G," ").trim(),S.unshift(S[0][A]=S[0][A]||{})):S[0][g[1]]=g[2].replace(G," ").trim();return S[0]})(r);T[i]=C(s?{["@keyframes "+i]:u}:u,t?"":"."+i)}let a=t&&T.g?T.g:null;return t&&(T.g=T[i]),((u,b,g,A)=>{A?b.data=b.data.replace(A,u):b.data.indexOf(u)===-1&&(b.data=g?u+b.data:b.data+u)})(T[i],e,n,a),i},ze=(r,e,t)=>r.reduce((n,s,f)=>{let i=e[f];if(i&&i.call){let a=i(t),u=a&&a.props&&a.props.className||/^go/.test(a)&&a;i=u?"."+u:a&&typeof a=="object"?a.props?"":C(a,""):a===!1?"":a}return n+s+(i??"")},"");function H(r){let e=this||{},t=r.call?r(e.p):r;return ve(t.unshift?t.raw?ze(t,[].slice.call(arguments,1),e.p):t.reduce((n,s)=>Object.assign(n,s&&s.call?s(e.p):s),{}):t,J(e.target),e.g,e.o,e.k)}var X,P,B,Ae=H.bind({g:1}),Se=H.bind({k:1});function Ee(r,e,t,n){C.p=e,X=r,P=t,B=n}function $e(r,e){let t=this||{};return function(){let n=arguments;function s(f,i){let a=Object.assign({},f),u=a.className||s.className;t.p=Object.assign({theme:P&&P()},a),t.o=/ *go\d+/.test(u),a.className=H.apply(t,n)+(u?" "+u:""),e&&(a.ref=i);let b=r;return r[0]&&(b=a.as||r,delete a.as),B&&b[0]&&B(a),X(b,a)}return e?e(s):s}}var K={css:H,extractCss:be,glob:Ae,keyframes:Se,setup:Ee,styled:$e};var Y=function(){"use strict";let r=new Set,e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:E,afterNodeAdded:E,beforeNodeMorphed:E,afterNodeMorphed:E,beforeNodeRemoved:E,afterNodeRemoved:E,beforeAttributeUpdated:E},head:{style:"merge",shouldPreserve:function(o){return o.getAttribute("im-preserve")==="true"},shouldReAppend:function(o){return o.getAttribute("im-re-append")==="true"},shouldRemove:E,afterHeadMorphed:E}};function t(o,l,c={}){o instanceof Document&&(o=o.documentElement),typeof l=="string"&&(l=ie(l));let d=oe(l),h=re(o,d,c);return n(o,d,h)}function n(o,l,c){if(c.head.block){let d=o.querySelector("head"),h=l.querySelector("head");if(d&&h){let p=A(h,d,c);Promise.all(p).then(function(){n(o,l,Object.assign(c,{head:{block:!1,ignore:!0}}))});return}}if(c.morphStyle==="innerHTML")return i(l,o,c),o.children;if(c.morphStyle==="outerHTML"||c.morphStyle==null){let d=ce(l,o,c),h=d?.previousSibling,p=d?.nextSibling,y=f(o,d,c);return d?le(h,y,p):[]}else throw"Do not understand how to morph style "+c.morphStyle}function s(o,l){return l.ignoreActiveValue&&o===document.activeElement&&o!==document.body}function f(o,l,c){if(!(c.ignoreActive&&o===document.activeElement))return l==null?c.callbacks.beforeNodeRemoved(o)===!1?o:(o.remove(),c.callbacks.afterNodeRemoved(o),null):_(o,l)?(c.callbacks.beforeNodeMorphed(o,l)===!1||(o instanceof HTMLHeadElement&&c.head.ignore||(o instanceof HTMLHeadElement&&c.head.style!=="morph"?A(l,o,c):(u(l,o,c),s(o,c)||i(l,o,c))),c.callbacks.afterNodeMorphed(o,l)),o):c.callbacks.beforeNodeRemoved(o)===!1||c.callbacks.beforeNodeAdded(l)===!1?o:(o.parentElement.replaceChild(l,o),c.callbacks.afterNodeAdded(l),c.callbacks.afterNodeRemoved(o),l)}function i(o,l,c){let d=o.firstChild,h=l.firstChild,p;for(;d;){if(p=d,d=p.nextSibling,h==null){if(c.callbacks.beforeNodeAdded(p)===!1)return;l.appendChild(p),c.callbacks.afterNodeAdded(p),w(c,p);continue}if(D(p,h,c)){f(h,p,c),h=h.nextSibling,w(c,p);continue}let y=ne(o,l,p,h,c);if(y){h=q(h,y,c),f(y,p,c),w(c,p);continue}let v=se(o,l,p,h,c);if(v){h=q(h,v,c),f(v,p,c),w(c,p);continue}if(c.callbacks.beforeNodeAdded(p)===!1)return;l.insertBefore(p,h),c.callbacks.afterNodeAdded(p),w(c,p)}for(;h!==null;){let y=h;h=h.nextSibling,V(y,c)}}function a(o,l,c,d){return o==="value"&&d.ignoreActiveValue&&l===document.activeElement?!0:d.callbacks.beforeAttributeUpdated(o,l,c)===!1}function u(o,l,c){let d=o.nodeType;if(d===1){let h=o.attributes,p=l.attributes;for(let y of h)if(!a(y.name,l,"update",c))try{l.getAttribute(y.name)!==y.value&&l.setAttribute(y.name,y.value)}catch(v){console.error("Error setting attribute:",{badNode:l,badAttribute:y,error:v.message})}for(let y=p.length-1;0<=y;y--){let v=p[y];a(v.name,l,"remove",c)||o.hasAttribute(v.name)||l.removeAttribute(v.name)}}(d===8||d===3)&&l.nodeValue!==o.nodeValue&&(l.nodeValue=o.nodeValue),s(l,c)||g(o,l,c)}function b(o,l,c,d){if(o[c]!==l[c]){let h=a(c,l,"update",d);h||(l[c]=o[c]),o[c]?h||l.setAttribute(c,o[c]):a(c,l,"remove",d)||l.removeAttribute(c)}}function g(o,l,c){if(o instanceof HTMLInputElement&&l instanceof HTMLInputElement&&o.type!=="file"){let d=o.value,h=l.value;b(o,l,"checked",c),b(o,l,"disabled",c),o.hasAttribute("value")?d!==h&&(a("value",l,"update",c)||(l.setAttribute("value",d),l.value=d)):a("value",l,"remove",c)||(l.value="",l.removeAttribute("value"))}else if(o instanceof HTMLOptionElement)b(o,l,"selected",c);else if(o instanceof HTMLTextAreaElement&&l instanceof HTMLTextAreaElement){let d=o.value,h=l.value;if(a("value",l,"update",c))return;d!==h&&(l.value=d),l.firstChild&&l.firstChild.nodeValue!==d&&(l.firstChild.nodeValue=d)}}function A(o,l,c){let d=[],h=[],p=[],y=[],v=c.head.style,M=new Map;for(let z of o.children)M.set(z.outerHTML,z);for(let z of l.children){let F=M.has(z.outerHTML),I=c.head.shouldReAppend(z),R=c.head.shouldPreserve(z);F||R?I?h.push(z):(M.delete(z.outerHTML),p.push(z)):v==="append"?I&&(h.push(z),y.push(z)):c.head.shouldRemove(z)!==!1&&h.push(z)}y.push(...M.values());let U=[];for(let z of y){let F=document.createRange().createContextualFragment(z.outerHTML).firstChild;if(c.callbacks.beforeNodeAdded(F)!==!1){if(F.href||F.src){let I=null,R=new Promise(function(he){I=he});F.addEventListener("load",function(){I()}),U.push(R)}l.appendChild(F),c.callbacks.afterNodeAdded(F),d.push(F)}}for(let z of h)c.callbacks.beforeNodeRemoved(z)!==!1&&(l.removeChild(z),c.callbacks.afterNodeRemoved(z));return c.head.afterHeadMorphed(l,{added:d,kept:p,removed:h}),U}function S(){}function E(){}function te(o){let l={};return Object.assign(l,e),Object.assign(l,o),l.callbacks={},Object.assign(l.callbacks,e.callbacks),Object.assign(l.callbacks,o.callbacks),l.head={},Object.assign(l.head,e.head),Object.assign(l.head,o.head),l}function re(o,l,c){return c=te(c),{target:o,newContent:l,config:c,morphStyle:c.morphStyle,ignoreActive:c.ignoreActive,ignoreActiveValue:c.ignoreActiveValue,idMap:de(o,l),deadIds:new Set,callbacks:c.callbacks,head:c.head}}function D(o,l,c){return o==null||l==null?!1:o.nodeType===l.nodeType&&o.tagName===l.tagName?o.id!==""&&o.id===l.id?!0:O(c,o,l)>0:!1}function _(o,l){return o==null||l==null?!1:o.nodeType===l.nodeType&&o.tagName===l.tagName}function q(o,l,c){for(;o!==l;){let d=o;o=o.nextSibling,V(d,c)}return w(c,l),l.nextSibling}function ne(o,l,c,d,h){let p=O(h,c,l),y=null;if(p>0){let v=d,M=0;for(;v!=null;){if(D(c,v,h))return v;if(M+=O(h,v,o),M>p)return null;v=v.nextSibling}}return y}function se(o,l,c,d,h){let p=d,y=c.nextSibling,v=0;for(;p!=null;){if(O(h,p,o)>0)return null;if(_(c,p))return p;if(_(y,p)&&(v++,y=y.nextSibling,v>=2))return null;p=p.nextSibling}return p}function ie(o){let l=new DOMParser,c=o.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(c.match(/<\/html>/)||c.match(/<\/head>/)||c.match(/<\/body>/)){let d=l.parseFromString(o,"text/html");if(c.match(/<\/html>/))return d.generatedByIdiomorph=!0,d;{let h=d.firstChild;return h?(h.generatedByIdiomorph=!0,h):null}}else{let h=l.parseFromString("<body><template>"+o+"</template></body>","text/html").body.querySelector("template").content;return h.generatedByIdiomorph=!0,h}}function oe(o){if(o==null)return document.createElement("div");if(o.generatedByIdiomorph)return o;if(o instanceof Node){let l=document.createElement("div");return l.append(o),l}else{let l=document.createElement("div");for(let c of[...o])l.append(c);return l}}function le(o,l,c){let d=[],h=[];for(;o!=null;)d.push(o),o=o.previousSibling;for(;d.length>0;){let p=d.pop();h.push(p),l.parentElement.insertBefore(p,l)}for(h.push(l);c!=null;)d.push(c),h.push(c),c=c.nextSibling;for(;d.length>0;)l.parentElement.insertBefore(d.pop(),l.nextSibling);return h}function ce(o,l,c){let d;d=o.firstChild;let h=d,p=0;for(;d;){let y=fe(d,l,c);y>p&&(h=d,p=y),d=d.nextSibling}return h}function fe(o,l,c){return _(o,l)?.5+O(c,o,l):0}function V(o,l){w(l,o),l.callbacks.beforeNodeRemoved(o)!==!1&&(o.remove(),l.callbacks.afterNodeRemoved(o))}function ae(o,l){return!o.deadIds.has(l)}function ue(o,l,c){return(o.idMap.get(c)||r).has(l)}function w(o,l){let c=o.idMap.get(l)||r;for(let d of c)o.deadIds.add(d)}function O(o,l,c){let d=o.idMap.get(l)||r,h=0;for(let p of d)ae(o,p)&&ue(o,p,c)&&++h;return h}function W(o,l){let c=o.parentElement,d=o.querySelectorAll("[id]");for(let h of d){let p=h;for(;p!==c&&p!=null;){let y=l.get(p);y==null&&(y=new Set,l.set(p,y)),y.add(h.id),p=p.parentElement}}}function de(o,l){let c=new Map;return W(o,c),W(l,c),c}return{morph:t,defaults:e}}();function x(r,e){let t=globalThis.window?.Fez||globalThis.Fez;if(r.includes("-")||console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),!e.fezHtmlRoot){let n=new e,s=class extends L{};if(Object.getOwnPropertyNames(n).concat(Object.getOwnPropertyNames(e.prototype)).filter(a=>!["constructor","prototype"].includes(a)).forEach(a=>s.prototype[a]=n[a]),t.fastBindInfo||={fast:[],slow:[]},n.GLOBAL&&(s.fezGlobal=n.GLOBAL),n.CSS&&(s.css=n.CSS),n.HTML&&(s.html=n.HTML),n.NAME&&(s.nodeName=n.NAME),n.FAST?(s.fastBind=n.FAST,t.fastBindInfo.fast.push(typeof n.FAST=="function"?`${r} (func)`:r)):t.fastBindInfo.slow.push(r),n.GLOBAL){let a=()=>document.body.appendChild(document.createElement(r));document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a()}e=s;let i=`${r} compiled`;n.FAST&&(i+=" (fast bind)"),t.log(i)}e.html&&(e.html=Fe(e.html),e.html=e.html.replace(/<slot\s*\/>|<slot\s*>\s*<\/slot>/g,()=>{let n=e.slotNodeName||"div";return`<${n} class="fez-slot"></${n}>`}),e.fezHtmlFunc=j(e.html)),e.css&&(e.css=t.globalCss(e.css,{name:r})),t.classes[r]=e,customElements.get(r)||customElements.define(r,class extends HTMLElement{connectedCallback(){Te(this,e)?Q(r,this):window.requestAnimationFrame(()=>{this.parentNode&&Q(r,this)})}})}function Fe(r){let e=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]);return r.replace(/<([a-z-]+)\b([^>]*)\/>/g,(t,n,s)=>e.has(n)?t:`<${n}${s}></${n}>`)}function Te(r,e){let t=r.getAttribute("fez-fast");var n=typeof e.fastBind=="function"?e.fastBind(r):e.fastBind;return t=="false"?!1:t||n}function Q(r,e){let t=Fez.classes[r],n=e.parentNode;if(e.isConnected){let s=typeof t.nodeName=="function"?t.nodeName(e):t.nodeName,f=document.createElement(s||"div");f.classList.add("fez"),f.classList.add(`fez-${r}`),n.replaceChild(f,e);let i=new t;i.oldRoot=e,i.fezName=r,i.root=f,i.props=t.getProps(e,f),i.class=t,i.slot(e,f),f.fez=i,t.fezGlobal&&t.fezGlobal!=!0&&(window[t.fezGlobal]=i),window.$&&(i.$root=$(f)),i.props.id&&f.setAttribute("id",i.props.id),i.fezRegister(),(i.init||i.created||i.connect).bind(i)(i.props),i.UID=++Fez.instanceCount,Fez.instances[i.UID]=i;let a=i.root.cloneNode(!0);i.class.fezHtmlFunc&&i.render();let u=i.root.querySelector(".fez-slot");if(u&&(i.props.html?u.innerHTML=i.props.html:i.slot(a,u)),i.onSubmit){let b=i.root.nodeName=="FORM"?i.root:i.find("form");b.onsubmit=g=>{g.preventDefault(),i.onSubmit(i.formData())}}if(i.onMount(i.props),i.onPropsChange){Ce.observe(f,{attributes:!0});for(let[b,g]of Object.entries(i.props))i.onPropsChange(b,g)}}}var Ce=new MutationObserver((r,e)=>{for(let t of r)if(t.type==="attributes"){let n=t.target.fez,s=t.attributeName,f=t.target.getAttribute(s);n&&(n.props[s]=f,n.onPropsChange(s,f))}});var we=r=>{let e={script:"",style:"",html:"",head:""},t=r.split(`
`),n=[],s="";for(var f of t)f=f.trim(),f.startsWith("<script")&&!e.script&&s!="head"?s="script":f.startsWith("<head")&&!e.script?s="head":f.startsWith("<style")?s="style":f.endsWith("<\/script>")&&s==="script"&&!e.script?(e.script=n.join(`
`),n=[],s=null):f.endsWith("</style>")&&s==="style"?(e.style=n.join(`
`),n=[],s=null):(f.endsWith("</head>")||f.endsWith("</header>"))&&s==="head"?(e.head=n.join(`
`),n=[],s=null):s?n.push(f):e.html+=f+`
`;if(e.head){let a=document.createElement("div");a.innerHTML=e.head,Array.from(a.children).forEach(u=>{if(u.tagName==="SCRIPT"){let b=document.createElement("script");Array.from(u.attributes).forEach(g=>{b.setAttribute(g.name,g.value)}),b.type||="text/javascript",u.src?document.head.appendChild(b):(b.type.includes("javascript")||b.type=="module")&&(b.textContent=u.textContent,document.head.appendChild(b))}else document.head.appendChild(u.cloneNode(!0))})}let i=e.script;return/class\s+\{/.test(i)||(i=`class {
${i}
}`),String(e.style).includes(":")&&(Object.entries(Fez._styleMacros).forEach(([a,u])=>{e.style=e.style.replaceAll(`:${a} `,`${u} `)}),e.style=e.style.includes(":fez")||/(?:^|\s)body\s*\{/.test(e.style)?e.style:`:fez {
${e.style}
}`,i=i.replace(/\}\s*$/,`
  CSS = \`${e.style}\`
}`)),/\w/.test(String(e.html))&&(e.html=e.html.replaceAll("`","&#x60;"),e.html=e.html.replaceAll("$","\\$"),i=i.replace(/\}\s*$/,`
  HTML = \`${e.html}\`
}`)),i};function ee(r,e){if(r instanceof Node){let s=r;s.remove();let f=s.getAttribute("fez");if(f&&(f.includes(".")||f.includes("/"))){let i=f;Fez.log(`Loading from ${i}`),fetch(i).then(a=>{if(!a.ok)throw new Error(`Failed to load ${i}: ${a.status}`);return a.text()}).then(a=>{let g=new DOMParser().parseFromString(a,"text/html").querySelectorAll("template[fez], xmp[fez]");if(g.length>0)g.forEach(A=>{let S=A.getAttribute("fez");S&&!S.includes("-")&&!S.includes(".")&&!S.includes("/")&&console.error(`Fez: Invalid custom element name "${S}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let E=A.innerHTML;Fez.compile(S,E)});else{let A=i.split("/").pop().split(".")[0];Fez.compile(A,a)}}).catch(a=>{console.error(`FEZ template load error for "${f}": ${a.message}`)});return}else f&&!f.includes("-")&&console.error(`Fez: Invalid custom element name "${f}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`),e=s.innerHTML,r=f}else if(typeof e!="string"){document.body.querySelectorAll("template[fez], xmp[fez]").forEach(s=>Fez.compile(s));return}r&&!r.includes("-")&&!r.includes(".")&&!r.includes("/")&&console.error(`Fez: Invalid custom element name "${r}". Custom element names must contain a dash (e.g., 'my-element', 'ui-button').`);let t=we(e),n=t.split(/class\s+\{/,2);t=`${n[0]};

window.Fez('${r}', class {
${n[1]})`;try{new Function(t)()}catch(s){console.error(`FEZ template "${r}" compile error: ${s.message}`),console.log(t)}}var m=(r,e)=>{if(typeof r=="number"){let t=m.instances[r];if(t)return t;m.error(`Instance with UID "${r}" not found.`)}else if(r)if(e)if(typeof e=="function"&&!/^\s*class/.test(e.toString())&&!/\b(this|new)\b/.test(e.toString())){let n=Array.from(document.querySelectorAll(`.fez.fez-${r}`)).filter(s=>s.fez);return n.forEach(s=>e(s.fez)),n}else return typeof e!="function"?m.find(r,e):x(r,e);else{let t=r.nodeName?r.closest(".fez"):document.querySelector(r.includes("#")?r:`.fez.fez-${r}`);if(t){if(t.fez)return t.fez;m.error(`node "${r}" has no Fez attached.`)}else m.error(`node "${r}" not found.`)}else return FezBase};m.classes={};m.instanceCount=0;m.instances={};m.id=()=>{m._id_count||=0,m._id_count+=1;let r=Math.random().toString(36).substring(2,6);return`fez_${m._id_count}${r}`};m.find=(r,e)=>{let t=r;typeof t=="string"&&(t=document.body.querySelector(t)),typeof t.val=="function"&&(t=t[0]);let n=e?`.fez.fez-${e}`:".fez",s=t.closest(n);if(s&&s.fez)return s.fez;console.error("Fez node connector not found",r,t)};m.cssClass=r=>K.css(r);m.globalCss=(r,e={})=>{if(typeof r=="function"&&(r=r()),r.includes(":")){let t=r.split(`
`).filter(n=>!/^\s*\/\//.test(n)).join(`
`);e.wrap&&(t=`:fez { ${t} }`),t=t.replace(/\:fez|\:host/,`.fez.fez-${e.name}`),r=m.cssClass(t)}return document.body?document.body.parentElement.classList.add(r):document.addEventListener("DOMContentLoaded",()=>{document.body.parentElement.classList.add(r)}),r};m.info=()=>{console.log(JSON.stringify(m.fastBindInfo,null,2))};m.morphdom=(r,e,t={})=>{Array.from(r.attributes).forEach(s=>{e.setAttribute(s.name,s.value)}),Y.morph(r,e,{morphStyle:"outerHTML"});let n=r.nextSibling;n?.nodeType===Node.TEXT_NODE&&n.textContent.trim()===""&&n.remove()};m.htmlEscape=r=>typeof r=="string"?(r=r.replace(/font-family\s*:\s*(?:&[^;]+;|[^;])*?;/gi,"").replaceAll("'","&apos;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;"),r):r===void 0?"":r;m.publish=(r,...e)=>{m._subs||={},m._subs[r]||=[],m._subs[r].forEach(t=>{t[1].bind(t[0])(...e)})};m.fnv1=r=>{var e,t,n,s,f,i;for(e=2166136261,t=16777619,n=e,s=f=0,i=r.length-1;0<=i?f<=i:f>=i;s=0<=i?++f:--f)n^=r.charCodeAt(s),n*=t;return n.toString(36).replaceAll("-","")};m.tag=(r,e={},t="")=>{let n=encodeURIComponent(JSON.stringify(e));return`<${r} data-props="${n}">${t}</${r}>`};m.error=(r,e)=>{if(r=`Fez: ${r}`,console.error(r),e)return`<span style="border: 1px solid red; font-size: 14px; padding: 3px 7px; background: #fee; border-radius: 4px;">${r}</span>`};m.log=r=>{m.LOG===!0&&console.log(`Fez: ${r}`)};document.addEventListener("DOMContentLoaded",()=>{m.log("Fez.LOG === true, logging enabled.")});m.untilTrue=(r,e)=>{e||=200,r()||setTimeout(()=>{m.untilTrue(r,e)},e)};m.head=(r,e)=>{if(typeof r!="object"||r===null)throw new Error("head requires an object parameter");let t,n={},s;if(r.script){try{new Function(r.script)(),e&&e()}catch(a){console.error("Error executing script:",a)}return}else if(r.js){t=r.js,s="script";for(let[a,u]of Object.entries(r))a!=="js"&&a!=="module"&&(n[a]=u);r.module&&(n.type="module")}else if(r.css){t=r.css,s="link",n.rel="stylesheet";for(let[a,u]of Object.entries(r))a!=="css"&&(n[a]=u)}else throw new Error('head requires either "script", "js" or "css" property');let f=document.querySelector(`${s}[src="${t}"], ${s}[href="${t}"]`);if(f)return e&&e(),f;let i=document.createElement(s);s==="link"?i.href=t:i.src=t;for(let[a,u]of Object.entries(n))i.setAttribute(a,u);return(e||r.module)&&(i.onload=()=>{r.module&&s==="script"&&import(t).then(a=>{window[r.module]=a.default||a[r.module]||a}).catch(a=>{console.error(`Error importing module ${r.module}:`,a)}),e&&e()}),document.head.appendChild(i),i};m.fetch=function(...r){m._fetchCache||={};let e="GET",t,n;typeof r[0]=="string"&&/^[A-Z]+$/.test(r[0])&&(e=r.shift()),t=r.shift();let s={},f=null;if(typeof r[0]=="object"&&(f=r.shift()),typeof r[0]=="function"&&(n=r.shift()),f){if(e==="GET"){let u=new URLSearchParams(f);t+=(t.includes("?")?"&":"?")+u.toString()}else if(e==="POST"){let u=new FormData;for(let[b,g]of Object.entries(f))u.append(b,g);s.body=u}}s.method=e;let i=`${e}:${t}:${JSON.stringify(s)}`;if(m._fetchCache[i]){let u=m._fetchCache[i];if(m.log(`fetch cache hit: ${e} ${t}`),n){n(u);return}return Promise.resolve(u)}m.log(`fetch live: ${e} ${t}`);let a=u=>u.headers.get("content-type")?.includes("application/json")?u.json():u.text();if(n){fetch(t,s).then(a).then(u=>{m._fetchCache[i]=u,n(u)}).catch(u=>m.onError("fetch",u));return}return fetch(t,s).then(a).then(u=>(m._fetchCache[i]=u,u))};m.onError=(r,e)=>{if(typeof r!="string")throw new Error("Fez.onError: kind must be a string");console.error(`${r}: ${e.toString()}`)};m._styleMacros={};m.styleMacro=(r,e)=>{m._styleMacros[r]=e};m.compile=ee;var N=m;window.FezBase=L;window.Fez=N;setInterval(()=>{for(let r in N.instances)N.instances[r]?.isConnected||delete N.instances[r]},5e3);var Me=new MutationObserver(r=>{for(let{addedNodes:e}of r)e.forEach(t=>{t.nodeType===1&&t.matches("template[fez], xmp[fez], script[fez]")&&window.requestAnimationFrame(()=>{N.compile(t),t.remove()})})});Me.observe(document.documentElement,{childList:!0,subtree:!0});N("fez-component",class{init(r){let e=document.createElement(r.name);for(e.props=r.props||r["data-props"]||r;this.root.firstChild;)this.root.parentNode.insertBefore(this.root.lastChild,e.nextSibling);this.root.innerHTML="",this.root.appendChild(e)}});})();
//# sourceMappingURL=fez.js.map
