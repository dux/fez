

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test</title>
  <link rel="icon" href="./demo/fez.png">
  <link rel="stylesheet" href="./demo/main.css" />
  <link rel="stylesheet" href="./demo/hjs-theme.css" />
  <link rel="stylesheet" href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
  <script src="./dist/fez.js"></script>
  <script>
    hljs.addPlugin(new CopyButtonPlugin({autohide: false}));
  </script>
  <script>
    function timeSince(date) {
        const now = new Date();
        const secondsPast = (now.getTime() - new Date(date).getTime()) / 1000;

        if (secondsPast < 60) {
            return `just now`;
        }
        if (secondsPast < 3600) { // less than 60 minutes
            const minutes = Math.floor(secondsPast / 60);
            return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
        }
        if (secondsPast < 86400) { // less than 24 hours
            const hours = Math.floor(secondsPast / 3600);
            return `${hours} hour${hours > 1 ? 's' : ''} ago`;
        }
        if (secondsPast < 2592000) { // less than 30 days
            const days = Math.floor(secondsPast / 86400);
            return `${days} day${days > 1 ? 's' : ''} ago`;
        }
        if (secondsPast < 31536000) { // less than 12 months
            const months = Math.floor(secondsPast / 2592000);
            return `${months} month${months > 1 ? 's' : ''} ago`;
        }
        const years = Math.floor(secondsPast / 31536000);
        return `${years} year${years > 1 ? 's' : ''} ago`;
    }

    window.L = console.log
</script>
</head>
<body>
  <img src="./demo/fez.png" style="height: 128px; float: right; margin-bottom: -100px;" />
  <h1>
    Fez demo components
    &sdot;
    <a target="playground" href="https://jsitor.com/QoResUvMc">playground</a>
    &sdot;
    <a target="repo" href="https://github.com/dux/fez">GitHub repo</a>
  </h1>

  <p>Fez was created by <a href="https://github.com/dux/">@dux</a> in 2024. Latest update was <script>document.write(timeSince('Mon Jan 27 17:29:44 2025 +0100'))</script>.

  <template fez="ui-clock"><script>
  class {
    randomColor() {
      const colors = ['red', 'green', 'blue', 'magenta', 'teal']
      return colors[Math.floor(Math.random() * colors.length)];
    }

    setVars() {
      // will only render once on next tick
      let time = new Date();
      this.state.hours = time.getHours();
      this.state.minutes = time.getMinutes();
      this.state.seconds = time.getSeconds();
      this.state.color = this.randomColor()
    }

    connect() {
      this.setVars()
      this.setInterval(this.setVars, 1000)
    }
  }
</script>

<style>
  input {
    border: 3px solid red !important;
  }

  svg {
    width: 100%;
    height: 100%;
  }

  .clock-face {
    stroke: #333;
    fill: white;
  }

  .minor {
    stroke: #999;
    stroke-width: 0.5;
  }

  .major {
    stroke: #333;
    stroke-width: 1;
  }

  .hour {
    stroke: #333;
  }

  .minute {
    stroke: #666;
  }

  .second, .second-counterweight {
    stroke: var(--color);
  }

  .second-counterweight {
    stroke-width: 3;
  }
</style>

<svg viewBox="-50 -50 100 100" style="--color: {{ @state.color }}">
  <circle class="clock-face" r="48" />

  <!-- markers -->
  {{#each [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55] as minute}}
    <line class="major" y1="35" y2="45" transform="rotate({{30 * minute}})" />

    {{#each [1, 2, 3, 4] as offset}}
      <line class="minor" y1="42" y2="45" transform="rotate({{6 * (minute + offset)}})" />
    {{/each}}
  {{/each}}

  <!-- hour hand -->
  <line class="hour" y1="2" y2="-20" transform="rotate({{30 * @state.hours + @state.minutes / 2}})" />

  <!-- minute hand -->
  <line class="minute" y1="4" y2="-30" transform="rotate({{6 * @state.minutes + @state.seconds / 10}})" />

  <!-- second hand -->
  <g transform="rotate({{6 * @state.seconds}})">
    <line class="second" y1="10" y2="-38" />
    <line class="second-counterweight" y1="10" y2="2" />
  </g>
</svg>
</template>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-clock" style="">
        <h2>ui-clock</h2>
        <div class="info">
  <ul>
    <li>SVG generation</li>
    <li>reactive store - any update to <code>this.state</code> object triggers re-render.</li>
    <li>DOM morph updates - update only changed nodes and attributes</li>
    <li>dynamic styes (seconds line color)</li>
  </ul>
</div>

<div style="display: grid; grid-template-columns: 1fr fit-content(50%);">
  <div>
    <ui-clock></ui-clock>
  </div>
  <div>
    <ui-clock></ui-clock>
  </div>
  <div>
    <ui-clock></ui-clock>
  </div>
  <div>
    <ui-clock></ui-clock>
  </div>
</div>




      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('clock')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-clock" file="./demo/fez/clock.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>SVG generation&lt;/li>
    &lt;li>reactive store - any update to &lt;code>this.state&lt;/code> object triggers re-render.&lt;/li>
    &lt;li>DOM morph updates - update only changed nodes and attributes&lt;/li>
    &lt;li>dynamic styes (seconds line color)&lt;/li>
  &lt;/ul>
&lt;/div>

&lt;div style="display: grid; grid-template-columns: 1fr fit-content(50%);">
  &lt;div>
    &lt;ui-clock>&lt;/ui-clock>
  &lt;/div>
  &lt;div>
    &lt;ui-clock>&lt;/ui-clock>
  &lt;/div>
  &lt;div>
    &lt;ui-clock>&lt;/ui-clock>
  &lt;/div>
  &lt;div>
    &lt;ui-clock>&lt;/ui-clock>
  &lt;/div>
&lt;/div>




        </app-editor>

        <br />

        <app-editor id="code-ui-clock" file="./demo/fez/clock.fez">
           &lt;script>
  class {
    randomColor() {
      const colors = ['red', 'green', 'blue', 'magenta', 'teal']
      return colors[Math.floor(Math.random() * colors.length)];
    }

    setVars() {
      // will only render once on next tick
      let time = new Date();
      this.state.hours = time.getHours();
      this.state.minutes = time.getMinutes();
      this.state.seconds = time.getSeconds();
      this.state.color = this.randomColor()
    }

    connect() {
      this.setVars()
      this.setInterval(this.setVars, 1000)
    }
  }
&lt;/script>

&lt;style>
  input {
    border: 3px solid red !important;
  }

  svg {
    width: 100%;
    height: 100%;
  }

  .clock-face {
    stroke: #333;
    fill: white;
  }

  .minor {
    stroke: #999;
    stroke-width: 0.5;
  }

  .major {
    stroke: #333;
    stroke-width: 1;
  }

  .hour {
    stroke: #333;
  }

  .minute {
    stroke: #666;
  }

  .second, .second-counterweight {
    stroke: var(--color);
  }

  .second-counterweight {
    stroke-width: 3;
  }
&lt;/style>

&lt;svg viewBox="-50 -50 100 100" style="--color: {{ @state.color }}">
  &lt;circle class="clock-face" r="48" />

  &lt;!-- markers -->
  {{#each [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55] as minute}}
    &lt;line class="major" y1="35" y2="45" transform="rotate({{30 * minute}})" />

    {{#each [1, 2, 3, 4] as offset}}
      &lt;line class="minor" y1="42" y2="45" transform="rotate({{6 * (minute + offset)}})" />
    {{/each}}
  {{/each}}

  &lt;!-- hour hand -->
  &lt;line class="hour" y1="2" y2="-20" transform="rotate({{30 * @state.hours + @state.minutes / 2}})" />

  &lt;!-- minute hand -->
  &lt;line class="minute" y1="4" y2="-30" transform="rotate({{6 * @state.minutes + @state.seconds / 10}})" />

  &lt;!-- second hand -->
  &lt;g transform="rotate({{6 * @state.seconds}})">
    &lt;line class="second" y1="10" y2="-38" />
    &lt;line class="second-counterweight" y1="10" y2="2" />
  &lt;/g>
&lt;/svg>

        </app-editor>
      </div>
    </div>
  
  <template fez="ui-todo"><script>
  clearCompleted() {
    this.state.tasks = this.state.tasks.filter((t) => !t.done)
  }

  removeTask(index) {
    this.state.tasks = this.state.tasks.filter((_, i) => i !== index);
  }

  addTask() {
    // no need to force update template, this is automatic because we are using reactiveStore()
    this.counter ||= 0
    this.state.tasks.push({
      name: `new task ${++this.counter}`,
      done: false,
      animate: true
    })
  }

  animate(node) {
    // same as in Svelte, uf you define fez-use="methodName", method will be called when node is added to dom.
    // in this case, we animate show new node

    $(node)
      .css('display', 'block')
      .animate({height: '33px', opacity: 1}, 200, () => {
        delete this.state.tasks[this.state.tasks.length-1].animate
        $(node).css('height', 'auto')
      })
  }

  connect() {
    this.state.tasks = [
      {name: 'First task', done: false},
      {name: 'Second task', done: false},
      {name: 'Third task', done: true },
    ]
  }
</script>

<h3>Tasks</h3>
{{#if !@state.tasks[0] }}
  <p>No tasks found</p>
{{/if}}

{{#for task, index in @state.tasks}}
  {{#if task.animate}} <!-- this is fine because this is string templating -->
    <p fez-use="animate" style="display: none; height: 0px; opacity: 0;">
  {{:else}}
    <p>
  {{/if}}
    <input
      type="text"
      fez-bind="state.tasks[{{index}}].name"
      style="{{ task.done ? 'background-color: #ccc;' : '' }}"
    />
    &sdot;
    <input
      type="checkbox"
      fez-bind="state.tasks[{{index}}].done"
    />
    &sdot;
    <button onclick="$$.removeTask({{ index }})">&times;</button>
  </p>
{{/for}}
<p>
  <button onclick="$$.addTask()">add task</button>
  &sdot;
  <button onclick="$$.clearCompleted()">clear completed</button>
</p>
<pre class="code">{{ JSON.stringify(this.state.tasks, null, 2) }}</pre>
<p>If you want to preserve state in templates, wrap content in "fez-slot"</p>
<p>Refresh: {{Math.random()}}</p>
<p class="fez-slot">
  Do not refresh: {{Math.random()}}.
</p>
</template>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-todo" style="">
        <h2>ui-todo</h2>
        <div class="info">
  <ul>
    <li>fully <b>rective state</b></li>
    <li><b>fez-bind</b> - two way binding of input element</li>
    <li><b>fez-use</b> - when node is added to dom, call described function and pass node as reference (inspired by Svelte)</li>
  </ul>
</div>

<ui-todo></ui-todo>

      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('todo')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-todo" file="./demo/fez/todo.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>fully &lt;b>rective state&lt;/b>&lt;/li>
    &lt;li>&lt;b>fez-bind&lt;/b> - two way binding of input element&lt;/li>
    &lt;li>&lt;b>fez-use&lt;/b> - when node is added to dom, call described function and pass node as reference (inspired by Svelte)&lt;/li>
  &lt;/ul>
&lt;/div>

&lt;ui-todo>&lt;/ui-todo>

        </app-editor>

        <br />

        <app-editor id="code-ui-todo" file="./demo/fez/todo.fez">
           &lt;script>
  clearCompleted() {
    this.state.tasks = this.state.tasks.filter((t) => !t.done)
  }

  removeTask(index) {
    this.state.tasks = this.state.tasks.filter((_, i) => i !== index);
  }

  addTask() {
    // no need to force update template, this is automatic because we are using reactiveStore()
    this.counter ||= 0
    this.state.tasks.push({
      name: `new task ${++this.counter}`,
      done: false,
      animate: true
    })
  }

  animate(node) {
    // same as in Svelte, uf you define fez-use="methodName", method will be called when node is added to dom.
    // in this case, we animate show new node

    $(node)
      .css('display', 'block')
      .animate({height: '33px', opacity: 1}, 200, () => {
        delete this.state.tasks[this.state.tasks.length-1].animate
        $(node).css('height', 'auto')
      })
  }

  connect() {
    this.state.tasks = [
      {name: 'First task', done: false},
      {name: 'Second task', done: false},
      {name: 'Third task', done: true },
    ]
  }
&lt;/script>

&lt;h3>Tasks&lt;/h3>
{{#if !@state.tasks[0] }}
  &lt;p>No tasks found&lt;/p>
{{/if}}

{{#for task, index in @state.tasks}}
  {{#if task.animate}} &lt;!-- this is fine because this is string templating -->
    &lt;p fez-use="animate" style="display: none; height: 0px; opacity: 0;">
  {{:else}}
    &lt;p>
  {{/if}}
    &lt;input
      type="text"
      fez-bind="state.tasks[{{index}}].name"
      style="{{ task.done ? 'background-color: #ccc;' : '' }}"
    />
    &sdot;
    &lt;input
      type="checkbox"
      fez-bind="state.tasks[{{index}}].done"
    />
    &sdot;
    &lt;button onclick="$$.removeTask({{ index }})">&times;&lt;/button>
  &lt;/p>
{{/for}}
&lt;p>
  &lt;button onclick="$$.addTask()">add task&lt;/button>
  &sdot;
  &lt;button onclick="$$.clearCompleted()">clear completed&lt;/button>
&lt;/p>
&lt;pre class="code">{{ JSON.stringify(this.state.tasks, null, 2) }}&lt;/pre>
&lt;p>If you want to preserve state in templates, wrap content in "fez-slot"&lt;/p>
&lt;p>Refresh: {{Math.random()}}&lt;/p>
&lt;p class="fez-slot">
  Do not refresh: {{Math.random()}}.
&lt;/p>

        </app-editor>
      </div>
    </div>
  
  <template fez="ui-form"><script>
  NAME = 'form'

  // if you define onSubmit, you will get submited form data object
  // and event.preventDefault will allready be applied
  onSubmit(data) {
    this.props.ping(data)
  }
</script>

<style>
  border: 2px solid green;
  border-radius: 5px;
  padding: 15px;
  margin: 15px 0;

  label {
    display: block;
    cursor: pointer;
    margin-bottom: 5px;
  }

  select option {
    font-size: 16px;
  }
</style>
</template>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-form" style="">
        <h2>ui-form</h2>
        <div class="info">
  <ul>
    <li>form helper - <code>this.formData()</code>. Get form data as object.</li>
    <li>form helper - <code>this.onSubmit()</code>. If present, auto bind form and get form data as object</li>
    <li>prefix params with <code>:</code> if you want to calculate attribute value. Same as in Vue, current example <code>:ping="..."</code></li>
    <li>Custom DOM tag name - <code>FORM</code> instead of default <code>DIV</code></li>
  </ul>
</div>

<div class="flex">
  <ui-form target="/api" :ping="updateFormData">
    <p>
      <input type="text" name="info" value="a dude" />
    </p>
    <p>
      <select name="num">
        <option>one</option>
        <option>two</option>
        <option>three</option>
      </select>
    </p>
    <p>
      <label><input type="radio" name="name" value="Jakov" /> Jakov</label>
      <label><input type="radio" name="name" value="Vid" /> Vid</label>
      <label><input type="radio" name="name" value="Dino" /> Dino</label>
    </p>
    <p>
      <button>Submit</button>
    </p>
  </ui-form>

  <ui-form target="/api" :ping="updateFormData">
    <p>
      <select name="num">
        <option>uno</option>
        <option>due</option>
        <option>tres</option>
      </select>
    </p>
    <p>
      <button>Submit</button>
    </p>
  </ui-form>
</div>

<pre id="form-data"></pre>

<script>
  function updateFormData(obj) {
    $('#form-data').append(JSON.stringify(obj) + "\n")
  }
</script>

      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('form')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-form" file="./demo/fez/form.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>form helper - &lt;code>this.formData()&lt;/code>. Get form data as object.&lt;/li>
    &lt;li>form helper - &lt;code>this.onSubmit()&lt;/code>. If present, auto bind form and get form data as object&lt;/li>
    &lt;li>prefix params with &lt;code>:&lt;/code> if you want to calculate attribute value. Same as in Vue, current example &lt;code>:ping="..."&lt;/code>&lt;/li>
    &lt;li>Custom DOM tag name - &lt;code>FORM&lt;/code> instead of default &lt;code>DIV&lt;/code>&lt;/li>
  &lt;/ul>
&lt;/div>

&lt;div class="flex">
  &lt;ui-form target="/api" :ping="updateFormData">
    &lt;p>
      &lt;input type="text" name="info" value="a dude" />
    &lt;/p>
    &lt;p>
      &lt;select name="num">
        &lt;option>one&lt;/option>
        &lt;option>two&lt;/option>
        &lt;option>three&lt;/option>
      &lt;/select>
    &lt;/p>
    &lt;p>
      &lt;label>&lt;input type="radio" name="name" value="Jakov" /> Jakov&lt;/label>
      &lt;label>&lt;input type="radio" name="name" value="Vid" /> Vid&lt;/label>
      &lt;label>&lt;input type="radio" name="name" value="Dino" /> Dino&lt;/label>
    &lt;/p>
    &lt;p>
      &lt;button>Submit&lt;/button>
    &lt;/p>
  &lt;/ui-form>

  &lt;ui-form target="/api" :ping="updateFormData">
    &lt;p>
      &lt;select name="num">
        &lt;option>uno&lt;/option>
        &lt;option>due&lt;/option>
        &lt;option>tres&lt;/option>
      &lt;/select>
    &lt;/p>
    &lt;p>
      &lt;button>Submit&lt;/button>
    &lt;/p>
  &lt;/ui-form>
&lt;/div>

&lt;pre id="form-data">&lt;/pre>

&lt;script>
  function updateFormData(obj) {
    $('#form-data').append(JSON.stringify(obj) + "\n")
  }
&lt;/script>

        </app-editor>

        <br />

        <app-editor id="code-ui-form" file="./demo/fez/form.fez">
           &lt;script>
  NAME = 'form'

  // if you define onSubmit, you will get submited form data object
  // and event.preventDefault will allready be applied
  onSubmit(data) {
    this.props.ping(data)
  }
&lt;/script>

&lt;style>
  border: 2px solid green;
  border-radius: 5px;
  padding: 15px;
  margin: 15px 0;

  label {
    display: block;
    cursor: pointer;
    margin-bottom: 5px;
  }

  select option {
    font-size: 16px;
  }
&lt;/style>

        </app-editor>
      </div>
    </div>
  
  <template fez="ui-time"><script>
  NAME = 'div'

  getRandomColor() {
    const colors = ['red', 'blue', 'green', 'teal', 'black', 'magenta', 'orange', 'lightblue']
    return colors[Math.floor(Math.random() * colors.length)]
  }

  setRandomColor() {
    const color = this.getRandomColor()
    // this.find('.color-name').innerHTML = color
    this.root.querySelector('.color-name').innerHTML = color
    this.root.style.borderColor = color
  }

  getTime() {
    return (new Date()).getTime()
  }

  setTime() {
    this.val('.time', this.getTime())
  }

  afterRender() {
    this.setTime()
  }

  connect() {
    this.setInterval(this.setTime, 1000)
    this.setRandomColor()
  }
</script>

<style>
  /* styles are applied to body, so this becomes body background color */
  background-color: #f7f7f7;

  /* local component style applied to mounted component root */
  :fez {
    border: 10px solid green;
    border-radius: 10px;
    padding: 10px;
    background-color: #fff;

    button {
      font-size: 16px;
    }
  }
</style>

<p>Param city: {{ @props.city }}</p>
<p>Time now: <span class="time"></span></p>
<p>Random num: <span>{{ Math.random() }}</span></p>
<button onclick="$$.setRandomColor()">random color</button>
&sdot;
<button onclick="$$.render()">refresh & preserve slot</button>
<hr />

<slot></slot>
</template>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-time" style="">
        <h2>ui-time</h2>
        <div class="info">
  <ul>
    <li>slots</li>
    <li>slot preservation on re-render</li>
    <li>
      global and local css. If <code>:fez { ... }</code> is present, anything inside is local, anythig outside is global.
      If no class <code>:fez</code> is present, style is considered local.
      </li>
  </ul>
</div>

<ui-time city="Zagreb">
  <ul>
    <li>
      Slot state preservation demo:xxxx
      <b class="color-name"></b>
    </li>
  </ul>
</ui-time>

      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('time')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-time" file="./demo/fez/time.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>slots&lt;/li>
    &lt;li>slot preservation on re-render&lt;/li>
    &lt;li>
      global and local css. If &lt;code>:fez { ... }&lt;/code> is present, anything inside is local, anythig outside is global.
      If no class &lt;code>:fez&lt;/code> is present, style is considered local.
      &lt;/li>
  &lt;/ul>
&lt;/div>

&lt;ui-time city="Zagreb">
  &lt;ul>
    &lt;li>
      Slot state preservation demo:xxxx
      &lt;b class="color-name">&lt;/b>
    &lt;/li>
  &lt;/ul>
&lt;/ui-time>

        </app-editor>

        <br />

        <app-editor id="code-ui-time" file="./demo/fez/time.fez">
           &lt;script>
  NAME = 'div'

  getRandomColor() {
    const colors = ['red', 'blue', 'green', 'teal', 'black', 'magenta', 'orange', 'lightblue']
    return colors[Math.floor(Math.random() * colors.length)]
  }

  setRandomColor() {
    const color = this.getRandomColor()
    // this.find('.color-name').innerHTML = color
    this.root.querySelector('.color-name').innerHTML = color
    this.root.style.borderColor = color
  }

  getTime() {
    return (new Date()).getTime()
  }

  setTime() {
    this.val('.time', this.getTime())
  }

  afterRender() {
    this.setTime()
  }

  connect() {
    this.setInterval(this.setTime, 1000)
    this.setRandomColor()
  }
&lt;/script>

&lt;style>
  /* styles are applied to body, so this becomes body background color */
  background-color: #f7f7f7;

  /* local component style applied to mounted component root */
  :fez {
    border: 10px solid green;
    border-radius: 10px;
    padding: 10px;
    background-color: #fff;

    button {
      font-size: 16px;
    }
  }
&lt;/style>

&lt;p>Param city: {{ @props.city }}&lt;/p>
&lt;p>Time now: &lt;span class="time">&lt;/span>&lt;/p>
&lt;p>Random num: &lt;span>{{ Math.random() }}&lt;/span>&lt;/p>
&lt;button onclick="$$.setRandomColor()">random color&lt;/button>
&sdot;
&lt;button onclick="$$.render()">refresh & preserve slot&lt;/button>
&lt;hr />

&lt;slot>&lt;/slot>

        </app-editor>
      </div>
    </div>
  
  <template fez="ui-icon"><script>
  // everything before class gets executed in component registration
  $(document.head).append(`
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  `)

  class {
    NAME = 'span'

    setSize(size) {
      this.$root.css('font-size', `${parseInt(size)}px`)
    }

    onPropsChange(name, value) {
      if (name == 'color') {
        this.$root.css('color', value)
      }

      if (name == 'size') {
        this.setSize(value)
      }
    }

    connect(props) {
      this.copy('onclick')

      const icon = props.name || this.root.innerHTML.trim()
      this.color = props.color || '#00'
      this.root.classList.add('material-symbols-outlined')
      this.root.innerHTML = icon
    }
  }
</script>

<style>
  &.material-symbols-outlined {
    font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 24
  }
</style>
</template>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-icon" style="">
        <h2>ui-icon</h2>
        <div class="info">
  <ul>
    <li>Features component to component communication</li>
    <li>evalule value of a attribute if prefixed with column <code>:</code> (in this example <code>:size=</code></li>
  </ul>
</div>

<input
  type="range" min="24" max="100" class="slider" id="icon-range"
  oninput="Fez('#icon-blue').setSize(this.value)"
/>

&sdot;

<span onclick="Fez('#icon-blue').attr('color', $(event.target).text())">
  <button>red</button>
  <button>blue</button>
  <button>green</button>
</span>

<br /><br />

<ui-icon name="home"></ui-icon>
<ui-icon
  id="icon-blue"
  name="settings"
  color="blue"
  onclick="alert(this.fez.props.color)"
  :size="document.getElementById('icon-range').value"
></ui-icon>
<ui-icon color="red">delete</ui-icon>

      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('icon')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-icon" file="./demo/fez/icon.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>Features component to component communication&lt;/li>
    &lt;li>evalule value of a attribute if prefixed with column &lt;code>:&lt;/code> (in this example &lt;code>:size=&lt;/code>&lt;/li>
  &lt;/ul>
&lt;/div>

&lt;input
  type="range" min="24" max="100" class="slider" id="icon-range"
  oninput="Fez('#icon-blue').setSize(this.value)"
/>

&sdot;

&lt;span onclick="Fez('#icon-blue').attr('color', $(event.target).text())">
  &lt;button>red&lt;/button>
  &lt;button>blue&lt;/button>
  &lt;button>green&lt;/button>
&lt;/span>

&lt;br />&lt;br />

&lt;ui-icon name="home">&lt;/ui-icon>
&lt;ui-icon
  id="icon-blue"
  name="settings"
  color="blue"
  onclick="alert(this.fez.props.color)"
  :size="document.getElementById('icon-range').value"
>&lt;/ui-icon>
&lt;ui-icon color="red">delete&lt;/ui-icon>

        </app-editor>

        <br />

        <app-editor id="code-ui-icon" file="./demo/fez/icon.fez">
           &lt;script>
  // everything before class gets executed in component registration
  $(document.head).append(`
    &lt;link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  `)

  class {
    NAME = 'span'

    setSize(size) {
      this.$root.css('font-size', `${parseInt(size)}px`)
    }

    onPropsChange(name, value) {
      if (name == 'color') {
        this.$root.css('color', value)
      }

      if (name == 'size') {
        this.setSize(value)
      }
    }

    connect(props) {
      this.copy('onclick')

      const icon = props.name || this.root.innerHTML.trim()
      this.color = props.color || '#00'
      this.root.classList.add('material-symbols-outlined')
      this.root.innerHTML = icon
    }
  }
&lt;/script>

&lt;style>
  &.material-symbols-outlined {
    font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 24
  }
&lt;/style>

        </app-editor>
      </div>
    </div>
  
  <script src="./demo/fez/pubsub.js"></script>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-pubsub" style="">
        <h2>ui-pubsub</h2>
        <div class="info">
  <ul>
    <li>Features publish &lt;> subscribe mechanism</li>
  </ul>
</div>

<style>
  .fez-ui-pubsub { margin-top: 10px; }
</style>

<button onclick="Fez.publish('ping', Math.random())">ping from anywhere</button>
&sdot;
Fast ping:
<button onclick="
  clearInterval(window.fastPing);
  window.fastPing = setInterval(()=>Fez.publish('ping', Math.random()), 10);"
>START</button>
&sdot;
<button onclick="clearInterval(window.fastPing)">END</button>

<ui-pubsub>
  <h4>lisener 1</h4>
  <p class="target"></p>
</ui-pubsub>

<ui-pubsub>
  <h4>lisener 2</h4>
  <b class="target"></b>
</ui-pubsub>

<ui-pubsub>
  <h4>lisener 3</h4>
  Foo: <span class="target"></span>
</ui-pubsub>

<template id="pubsub-t">
  <ui-pubsub>
    Dynamic lisener:
    <button onclick="Fez(this).$root.remove()">&times;</button>
    &sdot;
    <span class="target"></span>
  </ui-pubsub>
</template>

<br />
<button onclick="$(this).after($('#pubsub-t').html())">add listener</button>

<script>
  setInterval(()=>Fez.publish('ping', Math.random()), 5000)
</script>

      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('pubsub')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-pubsub" file="./demo/fez/pubsub.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>Features publish &lt;> subscribe mechanism&lt;/li>
  &lt;/ul>
&lt;/div>

&lt;style>
  .fez-ui-pubsub { margin-top: 10px; }
&lt;/style>

&lt;button onclick="Fez.publish('ping', Math.random())">ping from anywhere&lt;/button>
&sdot;
Fast ping:
&lt;button onclick="
  clearInterval(window.fastPing);
  window.fastPing = setInterval(()=>Fez.publish('ping', Math.random()), 10);"
>START&lt;/button>
&sdot;
&lt;button onclick="clearInterval(window.fastPing)">END&lt;/button>

&lt;ui-pubsub>
  &lt;h4>lisener 1&lt;/h4>
  &lt;p class="target">&lt;/p>
&lt;/ui-pubsub>

&lt;ui-pubsub>
  &lt;h4>lisener 2&lt;/h4>
  &lt;b class="target">&lt;/b>
&lt;/ui-pubsub>

&lt;ui-pubsub>
  &lt;h4>lisener 3&lt;/h4>
  Foo: &lt;span class="target">&lt;/span>
&lt;/ui-pubsub>

&lt;template id="pubsub-t">
  &lt;ui-pubsub>
    Dynamic lisener:
    &lt;button onclick="Fez(this).$root.remove()">&times;&lt;/button>
    &sdot;
    &lt;span class="target">&lt;/span>
  &lt;/ui-pubsub>
&lt;/template>

&lt;br />
&lt;button onclick="$(this).after($('#pubsub-t').html())">add listener&lt;/button>

&lt;script>
  setInterval(()=>Fez.publish('ping', Math.random()), 5000)
&lt;/script>

        </app-editor>

        <br />

        <app-editor id="code-ui-pubsub" file="./demo/fez/pubsub.js">
           Fez('ui-pubsub', class {
  update (info) {
    this.target.innerHTML = info
  }

  connect() {
    this.target = this.find('.target')
    this.subscribe('ping', this.update)
    this.update('waiting for a ping...')
  }
})

        </app-editor>
      </div>
    </div>
  
  <script src="./demo/fez/list.js"></script>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-list" style="">
        <h2>ui-list</h2>
        <div class="info">
  <ul>
    <li>Features list and object rendering</li>
    <li>JS fez tag creation (does not use template)</li>
  </ul>
</div>

<h3>Case 1</h3>
<ui-list>red,green,blue</ui-list>

<hr />

<h3>Case 2</h3>
<ui-list></ui-list>

      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('list')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-list" file="./demo/fez/list.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>Features list and object rendering&lt;/li>
    &lt;li>JS fez tag creation (does not use template)&lt;/li>
  &lt;/ul>
&lt;/div>

&lt;h3>Case 1&lt;/h3>
&lt;ui-list>red,green,blue&lt;/ui-list>

&lt;hr />

&lt;h3>Case 2&lt;/h3>
&lt;ui-list>&lt;/ui-list>

        </app-editor>

        <br />

        <app-editor id="code-ui-list" file="./demo/fez/list.js">
           // component to render google fonts icons
Fez('ui-list', class {
  css = `
    li {
      font-weight: bold;
    }
  `

  HTML = `
    {{#if @colors[0]}}
      &lt;p>
        Inside code blocks &lt;code>{ { ... } }&lt;/code>, &lt;code>@&lt;/code> will be replaced with &lt;code>this.&lt;/code>
      &lt;/p>
      &lt;h4>for loop, with index&lt;/h4>
      &lt;ul>
        {{#for color, index in @colors}}
          &lt;li style="color: {{ color }};">
            {{ index + 1}}. {{ color }}
          &lt;/li>
        {{/for}}
      &lt;/ul>
    {{else}}
      &lt;p>no colors&lt;/p>

      &lt;h3>Insert HTML example - bold italic&lt;/h3>

      &lt;p>Escaped: {{ @example }}&lt;/p>
      &lt;p>Raw: {{@html @example }} (prefix with &lt;code>@html&lt;/code>)&lt;/p>
    {{/if}}
  `

  connect() {
    this.colors = this.root.innerHTML.trim().split(',')

    this.example = `&lt;strong>&lt;i>bold & italic&lt;/i>&lt;/strong>`
  }
})

        </app-editor>
      </div>
    </div>
  
  <template fez="ui-tabs"><script>
  activateNode(node) {
    node.parent().find('> *').removeClass('active')
    node.addClass('active')
  }

  activate(num) {
    this.active = parseInt(num)
    const target = this.$root.find(`> div > div.header > span:nth-child(${num + 1})`)
    this.activateNode(target)
    this.activateNode(this.tabs[num])
  }

  connect(props) {
    this.tabs = this.childNodes(n => $(n))

    this.render([
      this.n('div.header', this.tabs.map((tab, index) =>
        this.n(`span`, tab.attr('title'), { onclick: ()=> this.activate(index) })
      )),
      this.n('.body', '<slot />')
    ]);

    this.activate(0)
  }
</script>

<style>
  --tabs-border: 1px solid #ccc;

  .header {
    margin-bottom: -2px;
    position: relative;
    z-index: 1;

    & > span {
      border: var(--tabs-border);
      padding: 8px 15px;
      display: inline-block;
      border-radius: 8px 8px 0 0;
      margin-right: -1px;
      background: #eee;
      cursor: pointer;

      &.active {
        background-color: #fff;
        border-bottom: none;
      }
    }
  }

  .body {
    border: var(--tabs-border);
    padding: 8px 15px;
    background: #fff;

    & > div {
      display: none;

      &.active {
        display: block;
      }
    }
  }
</style>
</template>

    <div class="flex" style="border-top: 1px solid #ccc; margin-top: 40px;">
      <div class="body" id="body-tabs" style="">
        <h2>ui-tabs</h2>
        <div class="info">
  <ul>
    <li>alternative node builder</li>
    <li>nested and recursive components (tabs in tabs in tabs)</li>
    <li><code>this.childNodes()</code> FEZ instance helper function, get all first level child nodes, excluding #text nodes.</li>
  </ul>
</div>

<ui-tabs>
  <div title="Bar">
    <p>First tab</p>

    <br />

    <ui-tabs>
      <div title="Foo nested 2">First tab</div>
      <div title="Bar">
        <p>second tab</p>

        <ui-tabs>
          <div title="Foo nested 3">first tab</div>
          <div title="Bar nested 3">
            <p>second tab</p>
            <hr />
            <ui-clock></ui-clock>
          </div>
        </ui-tabs>
      </div>
    </ui-tabs>
  </div>
  <div title="Baz">
    <h4>image tab</h4>
    <img src="./demo/fez.png" />
  </div>
  <div title="Foo">
    Third tab
    <hr />
    <ui-clock></ui-clock>
  </div>
</ui-tabs>


      </div>
      <div>
        <div style="text-align: right; position: relative; top: 20px;">
          <button onclick="applyChanges('tabs')" style="padding: 5px 10px;">Apply changes</button>
        </div>
        <app-editor id="html-tabs" file="./demo/fez/tabs.html" language="html">
           &lt;div class="info">
  &lt;ul>
    &lt;li>alternative node builder&lt;/li>
    &lt;li>nested and recursive components (tabs in tabs in tabs)&lt;/li>
    &lt;li>&lt;code>this.childNodes()&lt;/code> FEZ instance helper function, get all first level child nodes, excluding #text nodes.&lt;/li>
  &lt;/ul>
&lt;/div>

&lt;ui-tabs>
  &lt;div title="Bar">
    &lt;p>First tab&lt;/p>

    &lt;br />

    &lt;ui-tabs>
      &lt;div title="Foo nested 2">First tab&lt;/div>
      &lt;div title="Bar">
        &lt;p>second tab&lt;/p>

        &lt;ui-tabs>
          &lt;div title="Foo nested 3">first tab&lt;/div>
          &lt;div title="Bar nested 3">
            &lt;p>second tab&lt;/p>
            &lt;hr />
            &lt;ui-clock>&lt;/ui-clock>
          &lt;/div>
        &lt;/ui-tabs>
      &lt;/div>
    &lt;/ui-tabs>
  &lt;/div>
  &lt;div title="Baz">
    &lt;h4>image tab&lt;/h4>
    &lt;img src="./demo/fez.png" />
  &lt;/div>
  &lt;div title="Foo">
    Third tab
    &lt;hr />
    &lt;ui-clock>&lt;/ui-clock>
  &lt;/div>
&lt;/ui-tabs>


        </app-editor>

        <br />

        <app-editor id="code-ui-tabs" file="./demo/fez/tabs.fez">
           &lt;script>
  activateNode(node) {
    node.parent().find('> *').removeClass('active')
    node.addClass('active')
  }

  activate(num) {
    this.active = parseInt(num)
    const target = this.$root.find(`> div > div.header > span:nth-child(${num + 1})`)
    this.activateNode(target)
    this.activateNode(this.tabs[num])
  }

  connect(props) {
    this.tabs = this.childNodes(n => $(n))

    this.render([
      this.n('div.header', this.tabs.map((tab, index) =>
        this.n(`span`, tab.attr('title'), { onclick: ()=> this.activate(index) })
      )),
      this.n('.body', '&lt;slot />')
    ]);

    this.activate(0)
  }
&lt;/script>

&lt;style>
  --tabs-border: 1px solid #ccc;

  .header {
    margin-bottom: -2px;
    position: relative;
    z-index: 1;

    & > span {
      border: var(--tabs-border);
      padding: 8px 15px;
      display: inline-block;
      border-radius: 8px 8px 0 0;
      margin-right: -1px;
      background: #eee;
      cursor: pointer;

      &.active {
        background-color: #fff;
        border-bottom: none;
      }
    }
  }

  .body {
    border: var(--tabs-border);
    padding: 8px 15px;
    background: #fff;

    & > div {
      display: none;

      &.active {
        display: block;
      }
    }
  }
&lt;/style>

        </app-editor>
      </div>
    </div>
  

  <template fez="app-editor">
    <script>
      getSource() {
        return this.codeNode.textContent
      }

      connect(props) {
        props.language ||= 'html'
        this.source = this.root.innerHTML
      }

      onMount() {
        this.codeNode = this.find('code')
        this.codeNode.innerHTML = this.source.trim()
        hljs.highlightElement(this.codeNode);
      }
    </script>

    <style>
      code {
        padding: 10px;
      }

      .hljs-copy-button {
        overflow: visible;
        left: -5px;
        top: 20px;
      }
    </style>

    <div class="relative">
      <pre>
        {{#if @props.file}}
          <div style="padding: 5px 0;">{{ @props.file }}</div>
        {{/if}}
        <code class="language-js" contenteditable="true"></code>
      </pre>
    </div>
  </template>

  <script>
    window.applyChanges = function(name) {
      Fez.loadTemplate(`ui-${name}`, Fez(`#code-ui-${name}`).getSource())

      $(`#body-${name}`).html( Fez(`#html-${name}`).getSource() )
    }
  </script>
</body>
</html>

